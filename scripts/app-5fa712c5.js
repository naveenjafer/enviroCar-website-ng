!function(){"use strict";angular.module("app",["ngMaterial"])}(),function(){"use strict";function e(e,t){var a,o,n;t(["DASHBOARD","TRACKS","TABLE"]).then(function(e){a=e.DASHBAORD,o=e.TRACKS,n=e.TABLE,console.log("came here to nav service")});var r=[{name:"Dashboard",icon:"dashboard",sref:"#/dashboard/home"},{name:"Tracks",icon:"directions_car",sref:"#/dashboard/tracks/"},{name:"Profile",icon:"person",sref:"#/dashboard/table"},{name:"Segment",icon:"pie_chart",sref:"#/dashboard/segment"}];return console.log(r),{loadAllItems:function(){return e.when(r)}}}angular.module("app").service("navService",["$q","$translate",e])}(),angular.module("app").directive("panelWidget",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{title:"@",template:"@",options:"@"},template:'<section layout-margin class="md-whiteframe-z1 panel-widget">  <md-toolbar md-theme="custom" class="md-hue-1 panel-widget-toolbar">    <div class="md-toolbar-tools">      <h3 class="panel-widget-tittle">{{title}}</h3>      <span flex></span>      <md-button ng-show="options" ng-click="$showOptions = !$showOptions" class="md-icon-button" aria-label="Show options">        <i class="material-icons">more_vert</i>      </md-button>    </div>  </md-toolbar>  <div ng-include="template"/></section>',compile:function(e,t,a){return function(e,t){a(e,function(e){t.append(e)})}}}}),function(){"use strict";function e(){return{restrict:"E",scope:{title:"@",theme:"@",messages:"="},template:'<section>  <md-subheader ng-class="theme">{{title}}</md-subheader>  <md-list>    <md-list-item class="md-3-line" ng-repeat="message in messages">    <img class="md-avatar" ng-src="assets/images/einstein.jpg">    <div class="md-list-item-text">      <h3>{{message.subject}}</h3>      <h4>{{message.userName}}</h4>      <p>{{message.text}}</p>    </div>    </md-list-item>  </md-list></section>',link:function(){}}}angular.module("app").directive("messagesSection",e)}(),angular.module("app").config(["$translateProvider",function(e){e.translations("en",{TITLE_TRACKS:"Latest Tracks",TRACK_ID:"Track ID",MODIFIED:"Modified",User_VS_PUBLIC:"User vs Public",FRIENDS_ACTIVITY:"Friend's Activity",LOADING_DATA:"Loading Data...",SPEED_STATS:"Speed Zones",LOAD_MORE:"Load More",HEAT_MAP:"Heat Map",MY_ACTIVITY:"My Activity",TRACK_MAP:"Track Map",GRAPH:"Graph",PIE_CHART:"Pie Chart",TRACK_SUMMARY:"Track Summary",DISTANCE:"Distance",VEHICLE_TYPE:"VEHICLE_TYPE",TOTAL_TIME:"TOTAL_TIME",START_FINISH:"Start Finish Time",CONSUMPTION:" Consumption",CONSUMPTION_HOUR:"Consumption/Hr",CO2_EMISSION:"CO2 Emission",CO2_EMISSION_HOUR:"CO2 Emission/Hr",FRIENDS:"Friends",TRACKS:"Tracks",GROUPS:"Groups",TIMELINE_TAB:"Timeline",ACTIVITY_TAB:"Activity",FRIENDS_AND_GROUPS_TAB:"Friends and Groups",NO_FRIENDS:"You do not have any Friends",NO_ACTIVITY:"You do not have any Activity to show",NO_FRIENDS_ACTIVITY:"You do not have any friend activity to show",CALENDAR_OF_TRACKS_TAB:"Calendar of Tracks",ALL_TRACKS_TAB:"All Tracks",TRACKS_LIST:"Tracks List",NAME:"Name",CREATED:"Created",TIME_SERIES:"Time Series",DURATION:"Duration","CAR:":"Car:","START:":"Start:","END:":"End:","CONSUMPTION:":"Consumption:","CO2_EMISSION:":"CO2 Emission:",TRACK_VS_PUBLIC:"Track Vs Public",LOGIN:"Login",LOGOUT:"Logout",PROFILE:"Profile",DASHBOARD:"Dashboard",TABLE:"Profile",SEGMENT:"Segment",SPEED_PIE:"Speed",CONSUMPTION_PIE:"Consumption",CO2_PIE:"CO2",STATISTICS:"Statistics",DATE_FILTERS_HEADING:"Set Date Filters",DATE_OVERLAP_ERROR:"Start date cannot be after End Date",CONTINUE:"Continue",DISTANCE_FILTERS_HEADING:"Set Distance Filters",ERROR_NEGATIVE:"Please give only positive integers",DISTANCE_OVERLAP_ERROR:"Minimum Distance should be lesser than maximum distance",DISTANCE_ERROR_LIMIT:"Maximum distance should be lesser than 5000km",DURATION_FILTERS_HEADING:"Set Duration Filters",DURATION_OVERLAP_ERROR:"Minimum time should be lesser than maximum time",DURATION_ERROR_LIMIT:"Maximum duration should be lesser than 6000 Minutes",USERNAME:"Username",PASSWORD:"Password",REGISTER:"Register",BIO:"Bio",EMAIL_ID:"Email ID",COUNTRY:"Country",LANGUAGE:"Language",GENDER:"Gender",TERMS_OF_USE_VERSION:"Terms of User version",BADGES:"Badges",NO_BADGES:"You do not have any badges",EDIT_INFO:"Edit personal Information",FIRST_NAME:"First Name",LAST_NAME:"Last Name",DOB:"Date of Birth",ENTER_DATE:"Enter Date",PASSWORD_TIP:"If you do not want to change your password leave these fields blank",OLD_PASSWORD:"Old Password",NEW_PASSWORD:"New Password",NEW_PASSWORD_R:"New Password(Repeat)",SUBMISSION_SUCCESS:"Your details have been updated",UPDATE_PROFILE:"Update Profile",CONTROL_PANEL:"Control Panel",SEGMENT_INFO:"Click on map to place a marker at that point, click on it again to delete it.",RESET_POINTS:"Reset Points",SEARCH_TRACKS:"Search for tracks",COUNT_POINTS:"Count of Points",MONTHLY_OVERVIEW:"Monthly Overview",NO_MONTHLY_STATISTICS:"No statistics to show for this month",ORDER_BY:"Order By",REVERSE:"Reverse",VEHICLE_FILTERS_HEADING:"Set Distance Filters",SELECT_VEHICLES:"Select Vehicles",NO_SEGMENT_TRACKS:"We could not find any track statistics in the selected region, You could try increasing the search region by using the slider in the panel",TOURTIP1:"Draw a polyline to create segments",TOURTIP2:"Click here to search for segments, after drawing a polyline",TOURTIP3:"Edit a polyline here",TOURTIP4:"Clicking on a point removes it from the polyline",TOURTIP5:"Use the slider to change the region you are searching for, the blue circle around each point shows the region where the tracks are being searched for"}),e.preferredLanguage("en")}]),angular.module("app").controller("TrackListCtrl",["$scope","$mdDialog","$mdMedia","trackService","$http","$rootScope","visibilityService","$state","tracks_calendar",function(e,t,a,o,n,r,i,s,l){function d(e,t,a,o){console.log(o),e.onload=!1,e.currenttrack=o;var n,i,s,d="https://envirocar.org/api/stable/users/"+r.globals.currentUser.username+"/tracks/"+o.id;l.get(d).then(function(t){console.log(t.data),s=t.data.properties.length,e.currenttrack.manufacturer=t.data.properties.sensor.properties.manufacturer,e.currenttrack.model=t.data.properties.sensor.properties.model,e.currenttrack.start=new Date(t.data.features[0].properties.time).toLocaleString(),e.currenttrack.end=new Date(t.data.features[t.data.features.length-1].properties.time).toLocaleString(),n=t.data.features[0].properties.time,i=t.data.features[t.data.features.length-1].properties.time,console.log(n+"is starttime"),console.log(i+"is endtime"),console.log(s+"is legnth"),l.get(d+"/statistics/Consumption").then(function(t){if(console.log(t.data.avg),void 0!=t.data.avg){e.currenttrack.consumption_avg=t.data.avg.toFixed(2);var a=new Date(i).getTime()-new Date(n).getTime();console.log(a),e.currenttrack.consumption100Km=(100*e.currenttrack.consumption_avg*(a/36e5)/s).toFixed(2),e.currenttrack.consumption100Km=e.currenttrack.consumption100Km.toString()+" L/100 Km"}else e.currenttrack.consumption100Km="NA";e.onload=!0}),l.get(d+"/statistics/CO2").then(function(t){if(console.log(t.data.avg),void 0!=t.data.avg){e.currenttrack.co2_avg=t.data.avg.toFixed(2);var a=new Date(i).getTime()-new Date(n).getTime();console.log(a),e.currenttrack.co2gKm=(1e3*e.currenttrack.co2_avg*(a/36e5)/s).toFixed(2),e.currenttrack.co2gKm=e.currenttrack.co2gKm.toString()+"  g/Km"}else e.currenttrack.co2gKm="NA";e.onload=!0,console.log(t.data.avg),e.currenttrack.co2_avg=void 0!=t.data.avg?t.data.avg.toFixed(2):"NA",e.onload=!0})}),l.get(d+"/statistics/Speed").then(function(t){console.log(t.data),e.currenttrack.speed_avg=t.data.avg.toFixed(2)}),e.currenttrack.url="https://envirocar.org/api/stable/tracks/"+o.id+"/preview",e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(e){t.hide(e)},e.redirect=function(e){t.hide(),a.go("home.chart",{trackid:e})}}d.$inject=["$scope","$mdDialog","$state","currenttrack"],e.results=o.results,r.showPopOver=function(e){r.popoverIsVisible=!0,r.previewurl=e,console.log(e),console.log("show pop")},e.hidePopOver=function(){r.previewurl="",r.popoverIsVisible=!1,console.log("hide pop")},e.goToActivity=function(e){console.log("came here"),s.go("home.chart",{trackid:e}),console.log("fired")},e.showAdvanced=function(o,n){e.currenttrack={},e.currenttrack.id=n,e.track=n,console.log(n);var r=(a("sm")||a("xs"))&&e.customFullscreen;t.show({controller:d,templateUrl:"app/views/dialog1.tmpl.html",parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,locals:{currenttrack:e.currenttrack},fullscreen:r}).then(function(t){e.status='You said the information was "'+t+'".'},function(){e.status="You cancelled the dialog."}),e.$watch(function(){return a("xs")||a("sm")},function(t){e.customFullscreen=t===!0})}}]).controller("ImagePreviewController",["$scope","$http","$rootScope","visibilityService",function(e,t,a,o){e.popoverIsVisible2=!1,e.value2=e.popoverIsVisible2,e.url="",e.$watch("$root.popoverIsVisible",function(){console.log("fired"),e.popoverIsVisible2=a.popoverIsVisible,e.url=1==e.popoverIsVisible2?"https://envirocar.org/api/stable/tracks/"+a.previewurl+"/preview":"/assets/images/715.gif",e.value2=e.popoverIsVisible2,console.log(e.popoverIsVisible2)}),console.log(o.result+"is service result"),console.log(e.popoverIsVisible+"is the value")}]).factory("visibilityService",["$rootScope",function(e){return{result:e.popoverIsVisible}}]).factory("trackService",["$http","$rootScope","$stateParams",function(e,t,a){function o(e,t){r.pageSize=e,r.from=t,n()}function n(){var o;o=""==a.user?t.globals.currentUser.username:a.user;var n={method:"GET",url:"https://envirocar.org/api/stable/users/"+o+"/tracks",headers:{"X-User":t.globals.currentUser.username,"X-Token":t.globals.currentUser.authdata,Range:"items="+r.from+"-"+(r.from+r.pageSize-1)}},s={size:r.pageSize,from:r.from};e(n).then(function(e){var t=e.headers("Content-Range");t&&(i.total=parseInt(t.substring(t.indexOf("/")+1,t.length)),i.hits=e.data.tracks.length,console.info(i)),i.tracks=e.data.tracks,console.log(i.tracks);for(var a=0;a<i.tracks.length;a++)i.tracks[a].length=i.tracks[a].length.toFixed(2);i.range={start:s.from,end:s.from+s.size}},function(e){console.warn(e)})}var r={},i={};return{setPagingAndStartRequest:o,results:i,queryParams:r}}]).controller("PagingCtrl",["$scope","trackService",function(e,t){e.results=t.results,e.pages=[],e.size=5,e.shownPages=5,e.selectedPage=1,e.$watch("results",function(){if(e.results.hits){e.pages=[];var t=e.results.total,a=e.results.range.start;e.selectedPage=Math.ceil(a/e.size)+1;var o=e.selectedPage-Math.floor(e.shownPages/2);1>o&&(o=1);var n=o+e.shownPages-1;n>=e.selectedPage+Math.ceil((t-a)/e.size)-1&&(n=e.selectedPage+Math.ceil((t-a)/e.size)-1,o=n-e.shownPages+1,1>o&&(o=1));for(var r=o;n>=r;r++)e.pages.push(r)}},!0),e.showPaging=function(){return e.results.total?e.results.total>e.size:!1},e.jumpToPage=function(a){e.selectedPage=a,t.setPagingAndStartRequest(e.size,(a-1)*e.size)},e.hasNoNextPage=function(){if(e.results.total){var t=e.results.range.start;return t+e.size>e.results.total}return!1},e.hasNoPreviousPage=function(){if(e.results.total){var t=e.results.range.start;return 0>=t}return!1},e.nextPage=function(){var a=e.results.range.start+e.size;t.setPagingAndStartRequest(e.size,a)},e.previousPage=function(){var a=e.results.range.start-e.size;0>a&&(a=0),t.setPagingAndStartRequest(e.size,a)},t.setPagingAndStartRequest(e.size,0)}]),angular.module("app").controller("filterTracksController",["$scope","$q","$rootScope","$http","$stateParams","$state","$mdDialog","$mdMedia","tracks_calendar",function(e,t,a,o,n,r,i,s,l){function d(){var e=[{name:"Distance",type:"Brassica"},{name:"Date",type:"Brassica"},{name:"Duration of Travel",type:"Umbelliferous"},{name:"Vehicle",type:"Composite"}];return e.map(function(e){return e._lowername=e.name.toLowerCase(),e._lowertype=e.type.toLowerCase(),e})}function c(t){var a={};"Distance"==t?a={controller:m,templateUrl:"app/views/DistanceDialogPage.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:o}:"Date"==t?a={controller:p,templateUrl:"app/views/DateDialogPage.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:o}:"Duration of Travel"==t?a={controller:g,templateUrl:"app/views/DurationDialogPage.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:o}:"Vehicle"==t&&(a={controller:u,templateUrl:"app/views/VehicleDialogPage.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:o});var o=(s("sm")||s("xs"))&&e.customFullscreen;i.show(a).then(function(t){e.status='You said the information was "'+t+'".'},function(){e.status="You cancelled the dialog."}),e.$watch(function(){return s("xs")||s("sm")},function(t){e.customFullscreen=t===!0})}function m(e,t){e.valid=function(){return!0},e.errorNegative=!1,e.errorOverlap=!1,1==P&&(e.minDistanceFilter=v.min,e.maxDistanceFilter=v.max),e.minDistanceFilter,e.hide=function(){e.errorNegative=!1,e.errorOverlap=!1,a.distanceShow=!1,console.log("looking for"),console.log(e.minDistanceFilter+e.maxDistanceFilter),e.minDistanceFilter<0||e.maxDistanceFilter<0?e.errorNegative=!0:e.minDistanceFilter>e.maxDistanceFilter?e.errorOverlap=!0:e.maxDistanceFilter>5e3?e.errorLimit=!0:(console.log(e.filters),console.log(e.maxDistanceFilter),console.log("is max distance"),a.filters[0][2]=!0,v={min:null!=e.minDistanceFilter?e.minDistanceFilter:0,max:null!=e.maxDistanceFilter?e.maxDistanceFilter:5e3},P=!0,t.hide(),console.log(v))},e.cancel=function(){console.log("cancelled");for(var e=0;e<a.selectedVegetables.length;e++)"Distance"!=a.selectedVegetables[e].name||P||a.selectedVegetables.splice(e,1);console.log(a.selectedVegetables),t.cancel()}}function p(e,t){e.errorOverlap=!1,e.dateStartCustom=new Date,e.dateEndCustom=new Date,1==w&&(e.dateStartCustom=f.start,e.dateEndCustom=f.end),e.hide=function(){e.dateStartCustom.getTime()>e.dateEndCustom.getTime()?e.errorOverlap=!0:(a.dateShow=!1,a.filters[1][2]=!0,f={start:e.dateStartCustom,end:e.dateEndCustom},w=!0,t.hide(),console.log(f))},e.cancel=function(){for(var e=0;e<a.selectedVegetables.length;e++)"Date"!=a.selectedVegetables[e].name||w||a.selectedVegetables.splice(e,1);t.cancel()}}function g(e,t){e.errorNegative=!1,e.errorOverlap=!1,1==_&&(console.log("True if reached"),e.minDurationFilter=y.min,e.maxDurationFilter=y.max,console.log(e.minDurationFilter),console.log(e.maxDurationFilter)),e.hide=function(){e.minDurationFilter<0||e.maxDurationFilter<0?e.errorNegative=!0:e.minDurationFilter>e.maxDurationFilter?e.errorOverlap=!0:e.maxDurationFilter>6e3?e.errorLimit=!0:(a.durationShow=!1,a.filters[2][2]=!0,y={min:null!=e.minDurationFilter?e.minDurationFilter:0,max:null!=e.maxDurationFilter?e.maxDurationFilter:6e3},console.log("duration range is"),console.log(y),_=!0,t.hide(),console.log(f))},e.cancel=function(){for(var e=0;e<a.selectedVegetables.length;e++)"Duration of Travel"!=a.selectedVegetables[e].name||_||a.selectedVegetables.splice(e,1);t.cancel()}}function u(e,t){e.vehicleList=Object.keys(k),console.log(e.vehicleList),1==S&&(console.log("True if reached"),e.vehicles=JSON.parse(JSON.stringify(b))),e.hide=function(){a.filters[3][2]=!0,a.vehicleShow=!1,console.log(e.vehicles),b=JSON.parse(JSON.stringify(e.vehicles)),S=!0,t.hide(),console.log(f)},e.cancel=function(){for(var e=0;e<a.selectedVegetables.length;e++)"Vehicle"!=a.selectedVegetables[e].name||S||a.selectedVegetables.splice(e,1);t.cancel()}}function h(e,t,o,n){console.log(n),e.onload=!1,e.currenttrack=n;var r,i,s,d="https://envirocar.org/api/stable/users/"+a.globals.currentUser.username+"/tracks/"+n.id;l.get(d).then(function(t){console.log(t.data),s=t.data.properties.length,e.currenttrack.manufacturer=t.data.properties.sensor.properties.manufacturer,e.currenttrack.model=t.data.properties.sensor.properties.model,e.currenttrack.start=new Date(t.data.features[0].properties.time).toLocaleString(),e.currenttrack.end=new Date(t.data.features[t.data.features.length-1].properties.time).toLocaleString(),r=t.data.features[0].properties.time,i=t.data.features[t.data.features.length-1].properties.time,console.log(r+"is starttime"),console.log(i+"is endtime"),console.log(s+"is legnth"),l.get(d+"/statistics/Consumption").then(function(t){if(console.log(t.data.avg),void 0!=t.data.avg){e.currenttrack.consumption_avg=t.data.avg.toFixed(2);var a=new Date(i).getTime()-new Date(r).getTime();console.log(a),e.currenttrack.consumption100Km=(100*e.currenttrack.consumption_avg*(a/36e5)/s).toFixed(2),e.currenttrack.consumption100Km=e.currenttrack.consumption100Km.toString()+" L/100 Km"}else e.currenttrack.consumption100Km="NA";e.onload=!0}),l.get(d+"/statistics/CO2").then(function(t){if(console.log(t.data.avg),void 0!=t.data.avg){e.currenttrack.co2_avg=t.data.avg.toFixed(2);var a=new Date(i).getTime()-new Date(r).getTime();console.log(a),e.currenttrack.co2gKm=(1e3*e.currenttrack.co2_avg*(a/36e5)/s).toFixed(2),e.currenttrack.co2gKm=e.currenttrack.co2gKm.toString()+"  g/Km"}else e.currenttrack.co2gKm="NA";e.onload=!0,console.log(t.data.avg),e.currenttrack.co2_avg=void 0!=t.data.avg?t.data.avg.toFixed(2):"NA",e.onload=!0})}),l.get(d+"/statistics/Speed").then(function(t){console.log(t.data),e.currenttrack.speed_avg=t.data.avg.toFixed(2)}),e.currenttrack.url="https://envirocar.org/api/stable/tracks/"+n.id+"/preview",e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(e){t.hide(e)},e.redirect=function(e){t.hide(),o.go("home.chart",{trackid:e})}}h.$inject=["$scope","$mdDialog","$state","currenttrack"],e.showSearch=!1,e.showSearch2=!1,e.reverseEnabled=!1,e.reverse=!0,e.onload=!0,e.reverseClicked=function(){e.reverse=0==e.reverse?!0:!1,console.log(e.reverseEnabled)},e.toggleShow=function(){1==e.showSearch?(e.search="",e.showSearch=!1):e.showSearch=!0},e.dateCustomShow=!1,e.distanceCustomShow=!1,e.submitButtonShow=!1,e.dateCustom="All days",e.distanceCustom="All lengths",e.dateStartCustom=new Date,e.dateEndCustom=new Date,o.defaults.headers.common={"X-User":a.globals.currentUser.username,"X-Token":a.globals.currentUser.authdata},e.$on("$viewContentLoaded",e.init),e.init=function(){e.filterSelected="Duration"},a.showPopOver=function(e){a.popoverIsVisible=!0,a.previewurl=e,console.log(e),console.log("show pop")},e.hidePopOver=function(){a.previewurl="",a.popoverIsVisible=!1,console.log("hide pop")},e.goToActivity=function(e){console.log("came here"),r.go("home.chart",{trackid:e}),console.log("fired")},e.defaultDatesAll=function(){e.dateCustom="All days",e.dateCustomShow=!1},e.startDateChange=function(){console.log("came here 1"),console.log(e.dateStartCustom),e.dateStartObject=new Date(e.dateStartCustom),console.log(e.dateStartObject)},e.endDateChange=function(){console.log("came here 2"),console.log(e.dateEndCustom),e.dateEndObject=new Date(e.dateEndCustom),console.log(e.dateEndObject)},e.defaultDatesCustom=function(){e.dateCustom="Custom",e.dateCustomShow=!0,e.submitButtonShow=!0},e.defaultDistanceAll=function(){e.distanceCustom="All lengths",e.distanceCustomShow=!1},e.defaultDistanceCustom=function(){e.distanceCustom="Custom",e.distanceCustomShow=!0,e.submitButtonShow=!0},e.itemtest=5,e.submitButtonAction=function(){e.submitbuttonclicked=!0,"Custom"==e.distanceCustom&&(e.modifiedMinDistance=e.minDistanceFilter,e.modifiedMaxDistance=e.maxDistanceFilter),"Custom"==e.dateCustom&&(console.log("start and end value"),console.log(e.dateStartCustom),console.log(e.dateEndCustom),console.log(e.dateStartObject),console.log(e.dateEndObject),e.modifiedStartDate=e.dateStartCustom.getTime(),e.modifiedEndDate=e.dateEndCustom.getTime())},e.showAdvanced=function(t,a){e.currenttrack={},e.currenttrack.id=a,e.track=a,console.log(a);var o=(s("sm")||s("xs"))&&e.customFullscreen;i.show({controller:h,templateUrl:"app/views/dialog1.tmpl.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,locals:{currenttrack:e.currenttrack},fullscreen:o}).then(function(t){e.status='You said the information was "'+t+'".'},function(){e.status="You cancelled the dialog."}),e.$watch(function(){return s("xs")||s("sm")},function(t){e.customFullscreen=t===!0})},e.vegetables=d(),a.selectedVegetables=[],e.autocompleteDemoRequireMatch=!0,e.searchText=null,e.selectedItem=null,e.sItems=[{name:"Mini Cooper",id:0},{name:"Lexus IS250",id:1},{name:"Ford F150",id:2},{name:"Toyota Prius",id:3},{name:"Porsche 911",id:4},{name:"Ferreri 488",id:5}],e.myItems=[e.sItems[4],e.sItems[5]],e.transformChip=function(e){return angular.isObject(e)?e:e},e.querySearch=function(t){var a=t?e.vegetables.filter(e.createFilterFor(t)):[];return a},e.createFilterFor=function(e){var t=angular.lowercase(e);return function(e){return 0===e._lowername.indexOf(t)||0===e._lowertype.indexOf(t)}},e.getChipInfo=function(e){c(e.name)},e.fruitNames=["Apple","Banana","Orange"],e.roFruitNames=angular.copy(self.fruitNames);var v={},f={},y={},b={},k={};e.add=function(e){console.log(e),c(e.name)};var w=!1,P=!1,_=!1,S=!1;a.filters=[["Distance",0,P],["Date",1,w],["Duration of Travel",2,_],["Vehicle",3,S]],e.filtersS=[];var x;e.openMenu=function(e,t){x=t,e(t)},a.distanceShow=!0,a.dateShow=!0,a.vehicleShow=!0,a.durationShow=!0,e.addFilter=function(t){var o={0:["Distance",P],1:["Date",w],2:["Duration of Travel",_],3:["Vehicle",S]};o[t][1]||(a.selectedVegetables.push({name:o[t][0],type:"new"}),e.add({name:o[t][0]})),console.log(t),console.log(a.selectedVegetables),console.log("cotnetn")},e.filterAddedRemoved=function(){for(var t={Distance:P,Date:w,"Duration of Travel":_,Vehicle:S},a=0;a<e.filtersS.length;a++)t[e.filtersS[a]]||(e.selectedVegetables.push({name:e.filtersS[a],type:"new"}),e.add({name:e.filtersS[a]}))},e.dateFilter=function(e){return w?(console.log(f.start.getTime()+"start time in s"),console.log(f.end.getTime()+864e5+"end time in s"+f.end),console.log(e.StartDateObject+"the actual date"+e.Start),e.StartDateObject>=f.start.getTime()&&e.StartDateObject<=f.end.getTime()+864e5):e.Start},e.distanceFilter=function(e){return P?(console.log(v.min+"is min distance"),console.log(v.max+"is maximum distance"),e.Distance>v.min&&e.Distance<v.max):e.Distance},e.durationFilter=function(e){return _?e.DurationInMinutes>y.min&&e.DurationInMinutes<y.max:e.DurationInMinutes},e.vehicleFilter=function(e){return S?b.indexOf(e.Vehicle)>-1?(console.log("filtered"),e.Vehicle):void 0:e.Vehicle},e.remove=function(t){alert(t),e.selected=t},e.removeChip=function(e){"Distance"==e.name?(a.filters[0][2]=!1,a.distanceShow=!0,P=!1):"Date"==e.name?(a.filters[1][2]=!1,a.dateShow=!0,w=!1):"Duration of Travel"==e.name?(a.filters[2][2]=!1,a.durationShow=!0,_=!1):"Vehicle"==e.name&&(a.filters[3][2]=!1,a.vehicleShow=!0,S=!1),console.log("removed")},e.Modified="Modified",e.filterOptions=["Start","Distance","Duration","Name","Vehicle","TrackId","Modified"],username=""==n.user?a.globals.currentUser.username:n.user,e.tracks=[];var T="https://envirocar.org/api/stable/users/"+username+"/tracks?limit=1000";o.get(T).then(function(t){console.log("filterhttp"),console.log(t.data);for(var a=[],o=0;o<t.data.tracks.length;o++){var n={};n.TrackId=t.data.tracks[o].id,n.Name=t.data.tracks[o].name,n.Start=t.data.tracks[o].begin,n.StartDateObject=new Date(t.data.tracks[o].begin).getTime(),n.Vehicle=t.data.tracks[o].sensor.properties.model,void 0==k[t.data.tracks[o].sensor.properties.model]&&(k[t.data.tracks[o].sensor.properties.model]=1),n.manufacturer=t.data.tracks[o].sensor.properties.manufacturer,n.Distance=Number(t.data.tracks[o].length.toFixed(2)),n.url="https://envirocar.org/api/stable/tracks/"+t.data.tracks[o].id+"/preview",n.Modified=t.data.tracks[o].modified;var r=new Date(t.data.tracks[o].end).getTime()-new Date(t.data.tracks[o].begin).getTime();n.Duration=r;var i=r/1e3,s=i/60;n.DurationInMinutes=s,date_for_seconds=new Date(null),date_for_seconds.setSeconds(i),date_hh_mm_ss=date_for_seconds.toISOString().substr(11,8),n.DurationString=date_hh_mm_ss,a.push(n)}e.tracks=a,e.onload=!1}),e.$watch("filterSelected",function(){console.log("chnages")}),e.changeFilter=function(t){e.filterSelected=t,e.filterOrig="Start"==t||"Modified"==t?"Start"==t?"-Start":"-Modified":t,console.log(e.filterOrig)}}]),angular.module("app").controller("TracksController",["$scope","$http","$rootScope","factorytrackslist",function(e,t,a){t.defaults.headers.common={"X-User":a.globals.currentUser.username,"X-Token":a.globals.currentUser.authdata},e.urlredirect="#/dashboard/chart/",e.total_count=0,e.pageno=1,e.itemsPerPage=5,e.trackslist=[],e.show=!0,url="https://envirocar.org/api/stable/users/naveen-gsoc/tracks?",e.getData=function(a){e.show=!1,e.trackslist=[],t.get(url+"limit="+e.itemsPerPage+"&page="+a).success(function(t,a,o){e.trackslist=t.tracks;for(var n=0;n<e.trackslist.length;n++)e.trackslist[n].urlredirect=e.urlredirect+e.trackslist[n].id,console.log();console.log(e.trackslist);var r=o("Content-Range").split("/");e.total_count=Number(r[1]),console.log(e.total_count)}),e.show=!0},e.getData(e.pageno)}]).factory("factorytrackslist",["$http",function(e){var t=function(t){return e.get(t).success(function(e,t,a,o){console.log(e),console.log(a("Content-Range")),console.log(a("Link"));var n=a("Content-Range");return n=String(n),console.log(n),o}).error(function(e){return console.log(e),e})};return{get:t}}]),angular.module("app").controller("SegmentIndependentController",["$scope","leafletDrawEvents","$mdDialog","$mdMedia","GeolocationService","$geolocation","$mdToast","$rootScope","$http",function(e,t,a,o,n,r,i,s,l){function d(){var e=0;for(key in s.markers)s.markers.hasOwnProperty(key)&&(s.paths["c"+e.toString()]={type:"circle",radius:s.slider.value,latlngs:{lat:s.markers[key].lat,lng:s.markers[key].lng},color:"#0065A0",opacity:.5,smoothFactor:1,message:"**.**Km"},e++);if(console.log(s.paths),e>=2){var t=[];for(key in s.markers)s.markers.hasOwnProperty(key)&&t.push({lat:s.markers[key].lat,lng:s.markers[key].lng}),console.log("came here");s.paths.p1={color:"green",weight:5,latlngs:t}}else s.paths.p1=JSON.parse(JSON.stringify({}))}function c(t){if(t.data.properties.length>0){if(e.statisticsPresent=!0,e.segments=[{ind:0,value:"All Segments"}],t.data.features.length>1)for(var n=0;n<t.data.features.length;n++)e.segments.push({ind:n+1,value:"Segment "+(n+1).toString()});for(var r=["Speed","Consumption","CO2","MAF","Calculated MAF"],n=0;n<t.data.properties.length;n++)console.log("recorded here"),r.indexOf(t.data.properties[n].name)>-1&&(h[t.data.properties[n].name]=t.data.properties[n]);console.log(t),e.keys=Object.keys(h),console.log(e.keys),e.data=[{key:e.selectedPhenom,values:[{label:"Max",value:h[e.selectedPhenom].max},{label:"Avg",value:h[e.selectedPhenom].avg}]}],e.pointsCount=h[e.selectedPhenom].count,console.log(e.data),console.log(h)}else{showObject={controller:m,templateUrl:"app/views/TracksNotReturned.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:i};var i=(o("sm")||o("xs"))&&e.customFullscreen;a.show(showObject).then(function(t){e.status='You said the information was "'+t+'".'},function(){e.status="You cancelled the dialog."}),e.$watch(function(){return o("xs")||o("sm")},function(t){e.customFullscreen=t===!0})}}function m(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()}}console.log("SegmentIndependentController fired fwnfjenfef");var p=[],g=0;e.showleaflet=!1,e.notSearching=!0,e.statisticsPresent=!1,s.paths={};var u={};e.selectModel="All Segments";var h={},v=new L.FeatureGroup;e.currentStep=0,angular.extend(e,{map:{center:{lat:51.96,lng:7.6261,zoom:15},drawOptions:{position:"topleft",draw:{polyline:{metric:!1,shapeOptions:{color:"#F80505",weight:10}},polygon:!1,rectangle:!1,circle:!1,marker:!1},edit:{featureGroup:v,remove:!0}}},paths:{}});var f={created:function(e,t){v.addLayer(t.layer)},edited:function(){},deleted:function(e){var t;t=e.layers,v.removeLayer(layer)},drawstart:function(){},drawstop:function(){},editstart:function(){},editstop:function(){},deletestart:function(){},deletestop:function(){}},y=t.getAvailableEvents();y.forEach(function(t){e.$on("leafletDirectiveDraw."+t,function(a,o){var n,r,i,l;if(n=o.leafletEvent,r=o.leafletObject,i=o.model,l=o.modelName,Object.keys(v._layers).length<1||"draw:edited"==t||"draw:deleted"==t){f[t.replace("draw:","")](a,n,r,i,l),e.paths={};for(key in v._layers)if(v._layers.hasOwnProperty(key))for(var d=v._layers[key]._latlngs,c=0;c<d.length;c++)console.log("number of points in the drawnItems"),e.paths["p"+c.toString()]={type:"circle",radius:s.slider.value,color:"#0065A0",latlngs:{lat:d[c].lat,lng:d[c].lng}}}})});var b={Speed:"Km/h",Consumption:"l/h",MAF:"g/h","Calculated MAF":"g/h",CO2:"Kg/h"};e.options={chart:{type:"discreteBarChart",height:200,margin:{top:10,right:0,bottom:70,left:50},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:500,xAxis:{axisLabel:"Max vs Avg"},yAxis:{axisLabel:"Speed(Km/Hr)",axisLabelDistance:-15},tooltip:{contentGenerator:function(e){console.log(e);var t="<h3><b>"+e.data.label+"</b> = "+e.data.value.toFixed(2)+"</h3>";return t}}}},e.data=[],e.items=[{id:1,name:"Test"},{id:2,name:"Asdf"}],s.markers={},s.slider={value:200,options:{floor:200,ceil:5e3,id:"tolerance",translate:function(e){return e+"m"},showTicksValues:1600,onChange:function(){console.log(s.paths);for(key in e.paths)console.log(key+"is key"),e.paths.hasOwnProperty(key)&&(console.log("came here"),console.log(e.paths[key]),e.paths[key].radius=s.slider.value);console.log(s.paths)}}},console.log("workibg "),n().then(function(t){e.position=t,console.log("position "),console.log(t),e.center={lat:t.coords.latitude,lng:t.coords.longitude,zoom:12},e.showleaflet=!0},function(t){console.log(t),e.message="Could not be determined.",console.log("could not be"),e.showleaflet=!0}),e.$on("leafletDirectiveMap.segmentMap.click",function(e,t){if(console.log(),Object.keys(s.markers).length>=10)console.log("cannot add"),i.show(i.simple().textContent("Cannot add more than 10 points!").hideDelay(4e3));else{var a=t.leafletEvent;p.push({lat:a.latlng.lat,lng:a.latlng.lng}),s.markers[g]={lat:a.latlng.lat,lng:a.latlng.lng,focus:!1,message:'<div ng-controller="SampleController"><md-button class="white-bg" ng-click=removeMarker('+g+")>Delete Marker</md-button>",draggable:!0,id:g},d(),console.log(s.paths),g++,console.log(p),console.log(s.markers[0])}}),e.$on("leafletDirectiveMarker.segmentMap.dragend",function(e,t){var a=t.model.id;for(key in s.markers)s.markers.hasOwnProperty(key)&&key==a&&(s.markers[key]=JSON.parse(JSON.stringify(t.model)));console.log(t),d(),console.log("fired drag"),console.log(s.markers)}),e.resetPoints=function(){g=0,e.paths={},s.markers={},console.log(v)},e.searchForPoints=function(){e.notSearching=!1;var t=[];console.log("came here");for(key in v._layers)if(v._layers.hasOwnProperty(key)){var a=v._layers[key]._latlngs;console.log(a);for(var o=0;o<a.length;o++)t.push([a[o].lng,a[o].lat])}console.log(t),console.log(t);var n={type:"Feature",geometry:{type:"LineString",coordinates:t},timeInterval:{dateStart:"2010-06-08T11:29:10Z",dateEnd:"2026-09-08T11:29:10Z",daytimeStart:"1:30",daytimeEnd:"15:30"},tolerance:e.slider.value},r={method:"POST",url:"https://envirocar.org/envirocar-rest-analyzer/dev/rest/route/statistics",data:n};delete l.defaults.headers.common["X-User"],delete l.defaults.headers.common["X-Token"],l.defaults.headers.common={Accept:"application/json"},l(r).then(function(t){u=t,console.log(t),c(t),e.notSearching=!0})},e.selectedPhenom="Speed",e.pointsCount=0,e.phenomChanged=function(t){e.selectedPhenom=t,e.data=[{key:t,values:[{label:"Max",value:h[t].max},{label:"Avg",value:h[t].avg}]}],e.options.chart.yAxis.axisLabel=t+"("+b[t]+")",e.pointsCount=h[t].count,console.log(e.selectedPhenom)},e.segmentDefault=0,e.segmentChanged=function(t){console.log(t);var a=t-1;if(0==t)c(u);else{for(var o=["Speed","Consumption","CO2","MAF","Calculated MAF"],n=0;n<u.data.properties.length;n++)console.log("recorded here"),o.indexOf(u.data.features[a].properties[n].name)>-1&&(h[u.data.features[a].properties[n].name]=u.data.features[a].properties[n]);
console.log(u),e.keys=Object.keys(h),console.log(e.keys),e.data=[{key:e.selectedPhenom,values:[{label:"Max",value:h[e.selectedPhenom].max},{label:"Avg",value:h[e.selectedPhenom].avg}]}],e.pointsCount=h[e.selectedPhenom].count}}}]).factory("GeolocationService",["$q","$window","$rootScope",function(e,t,a){return function(){var o=e.defer();return t.navigator?t.navigator.geolocation.getCurrentPosition(function(e){a.$apply(function(){o.resolve(e)})},function(e){a.$apply(function(){o.reject(e)})}):a.$apply(function(){o.reject(new Error("Geolocation is not supported"))}),o.promise}}]),angular.module("app").controller("SegmentDrawController",["$scope","leafletDrawEvents","$mdMedia","Geo",function(e,t){var a=new L.FeatureGroup;angular.extend(e,{map:{center:{lat:51.92,lng:7.626,zoom:13},drawOptions:{position:"topleft",draw:{polyline:{metric:!1,shapeOptions:{color:"#F80505",weight:10}},polygon:!1,rectangle:!1,circle:!1,marker:!1},edit:{featureGroup:a,remove:!0}}},paths:{}});var o={created:function(e,t){a.addLayer(t.layer)},edited:function(){},deleted:function(e){var t;t=e.layers,a.removeLayer(layer)},drawstart:function(){},drawstop:function(){},editstart:function(){},editstop:function(){},deletestart:function(){},deletestop:function(){}},n=t.getAvailableEvents();n.forEach(function(t){e.$on("leafletDirectiveDraw."+t,function(n,r){var i,s,l,d;if(i=r.leafletEvent,s=r.leafletObject,l=r.model,d=r.modelName,Object.keys(a._layers).length<1||"draw:edited"==t||"draw:deleted"==t){o[t.replace("draw:","")](n,i,s,l,d),e.paths={};for(key in a._layers)if(a._layers.hasOwnProperty(key))for(var c=a._layers[key]._latlngs,m=0;m<c.length;m++)console.log("number of points in the drawnItems"),e.paths["p"+m.toString()]={type:"circle",radius:50,color:"#0065A0",latlngs:{lat:c[m].lat,lng:c[m].lng}}}console.log(e.paths),console.log(a)})})}]),angular.module("app").controller("SegmentController",["$state","$scope","$http","$rootScope","$timeout","$stateParams","factorysingletrack","chart","$location","requestgraphstats","leafletBoundsHelpers","dashboard","leafletMarkerEvents",function(e,t,a,o,n,r,i,s,l,d,c,m,p){function g(e,a){console.log("######################"),console.log(e+"is start"+a+"is end"),t.markers={},console.log(t.markers);var o={};o.lat=y.data.features[e].geometry.coordinates[1],o.lng=y.data.features[e].geometry.coordinates[0],o.focus=!1,o.draggable=!0,o.message="Start",t.markers.m1=o;var n={};console.log(a),console.log(y.data),console.log(y.data.features[a]),n.lat=y.data.features[a].geometry.coordinates[1],n.lng=y.data.features[a].geometry.coordinates[0],n.focus=!1,n.draggable=!0,n.message="End",t.markers.m2=n,console.log(t.markers)}function u(e,t,a,o){return Math.abs((e-a)*(e-a))+Math.abs((t-o)*(t-o))}function h(e,t,a,o){var n=.017453292519943295,r=Math.cos,i=.5-r((a-e)*n)/2+r(e*n)*r(a*n)*(1-r((o-t)*n))/2;return 12742*Math.asin(Math.sqrt(i))}function v(e,a,o,n){function r(e,t){if(0==e){console.log(E.length+"length of keys");for(var a=0;a<E.length;a++)K[E[a]]=t.features[e].properties.phenomenons[E[a]].unit;return $=t.properties.length,x=t.properties.sensor.properties.model,T=t.properties.sensor.type,C=t.properties.sensor.properties.manufacturer,console.log($+" "+x+" "+T),void console.log(K)}}B=JSON.parse(JSON.stringify(s.piechartsdata)),console.log("******************"),console.log(B),console.log(s.piechartsdata),t.piechartselected=t.widgetType2,N=Object.keys(e.data.features[0].properties.phenomenons),console.log(N);var l=s.phenoms,d=s.colors,c=Object.keys(H);console.log(c),console.log(N),N.indexOf("MAF")>=0&&(H=s.rangeobjectsreplace,l=s.phenomsreplace,B=JSON.parse(JSON.stringify(s.piechartsdatareplace)));for(var m=0;5>m;m++)N.indexOf(c[m])<0&&(delete d[c[m]],delete H[c[m]],delete B[c[m]],console.log("SHOUDL NOT HAVE COME HERE"),console.log(c[m]));l=Object.keys(H),console.log(l),console.log(H),console.log(d),t.trackid=e.data.properties.id,t.name=e.data.properties.name,t.created=e.data.properties.created,console.log("coming here too but"),console.log(e),y=e;var p=e.data.properties.length;A=e.data.features.length,t.piechartoptions=l,Y=[];for(var g=0;g<l.length;g++){0==g&&(E=Object.keys(e.data.features[0].properties.phenomenons),E.includes("Calculated MAF")&&console.log("Swapped with replace"));var u=[];console.log(u),0==tt&&(t.slider.maxValue=A-1,tt++);var v,b;0==a?(v=0,b=A):(v=o,b=n+1,0==v&&b==A&&(console.log("Working"),t.changePhenomenonbar(t.widgetType3,2)));for(var k=0,w=0,P=0,m=0;A>m;m++){var _;!function(o){if(0==g){if(0==o){t.travel_distance=e.data.properties.length.toFixed(2);var n=e.data.properties.length,c=e.data.features[v].properties.time,m=e.data.features[b-1].properties.time;t.tracksummary.starttime=new Date(c).toLocaleString(),t.tracksummary.endtime=new Date(m).toLocaleString();var p=new Date(m).getTime()-new Date(c).getTime(),f=p/1e3;V=f/60,z=new Date(null),z.setSeconds(f),I=z.toISOString().substr(11,8),t.tracksummary.timeoftravel=I,D=c,O=m,(0==a||1==a&&0==v&&b==A)&&(i.get(j+"/statistics/Consumption").then(function(e){if(console.log(e),void 0!=e.data.avg){console.log("came here to defined"),J=!0;var a=e.data.avg.toFixed(2),o=new Date(O).getTime()-new Date(D).getTime();console.log(o);var r=(100*a*(o/36e5)/n).toFixed(2);r=r.toString()+" L/100 Km",t.consumption100Km=r,console.log(t.tracksummary_c_e)}else J=!1,t.consumption100Km="NA"}),i.get(j+"/statistics/CO2").then(function(e){if(console.log(e),console.log(e.data.avg),void 0!=e.data.avg){X=!0;var a=e.data.avg.toFixed(2),o=new Date(O).getTime()-new Date(D).getTime();console.log(o);var r=(1e3*a*(o/36e5)/n).toFixed(2);r=r.toString()+" g/Km",t.co2gKm=r,console.log(t.tracksummary_c_e),console.log(r)}else console.log("co2 not present"),X=!1,t.co2gKm="NA"}))}if(1==a&&(0!=v||b!=A)&&o>=v&&b>o&&(b-1>o&&(P+=h(e.data.features[o+1].geometry.coordinates[1],e.data.features[o+1].geometry.coordinates[0],e.data.features[o].geometry.coordinates[1],e.data.features[o].geometry.coordinates[0])),console.log("came in"),console.log(J),console.log(X),J&&(k+=e.data.features[o].properties.phenomenons.Consumption.value,console.log(e.data.features[o].properties.phenomenons.Consumption.value),console.log(k)),X&&(w+=e.data.features[o].properties.phenomenons.CO2.value),o==b-1)){t.travel_distance=P.toFixed(2),t.avgspeed=t.travel_distance/((new Date(O).getTime()-new Date(D).getTime())/36e5),console.log(t.widgetType3);var y=JSON.parse(JSON.stringify(t.dataSpeed));if(console.log(y[0]),y[0].values[0].value=t.avgspeed,"Speed"==t.widgetType3&&(t.dataoverall=y),console.log(t.dataoverall),F=y,console.log("came here for last"),J){var p=new Date(O).getTime()-new Date(D).getTime(),S=(100*(k/(b-v+1))*(p/36e5)/P).toFixed(2);console.log(P+"the denom"),console.log(k/(b-v+1)+"the value"),S=S.toString()+" L/100 Km",t.consumption100Km=S,console.log(t.consumption100Km);var x=JSON.parse(JSON.stringify(t.dataConsumption));console.log(x[0]),x[0].values[0].value=k/(b-v+1),"Consumption"==t.widgetType3&&(t.dataoverall=x),console.log(t.dataoverall),L=JSON.parse(JSON.stringify(x)),console.log("Cons_Success")}else{var x=JSON.parse(JSON.stringify(t.dataSpeed));console.log(x[0]),x[0].values[0].value=Number.Nan,"Consumption"==t.widgetType3&&(t.dataoverall=x),console.log(t.dataoverall),L=JSON.parse(JSON.stringify(x))}if(X){var p=new Date(O).getTime()-new Date(D).getTime();console.log(p);var T=(1e3*(w/(b-v+1))*(p/36e5)/P).toFixed(2);t.co2gKm=T.toString()+" g/Km";var C=JSON.parse(JSON.stringify(t.dataCO2));console.log(C[0]),C[0].values[0].value=w/(b-v+1),"CO2"==t.widgetType3&&(t.dataoverall=C),console.log("co2_success"),U=JSON.parse(JSON.stringify(C))}else{var C=JSON.parse(JSON.stringify(t.dataCO2));console.log(C[0]),C[0].values[0].value=Number.Nan,"CO2"==t.widgetType3&&(t.dataoverall=C),U=JSON.parse(JSON.stringify(C))}}r(o,e.data)}if(0==o&&(console.log(e.data.features[o].properties.phenomenons),console.log(l[g]),H[l[g]][1]=e.data.features[o].properties.phenomenons[l[g]].unit),0==a||1==a&&o>=v&&b>o){var E=new Date(e.data.features[o].properties.time),N=E.getTime();if(e.data.features[o].properties.phenomenons[l[g]]){for(var R=e.data.features[o].properties.phenomenons[l[g]].value,M=s.numberofranges;M>=0;M--)if(R>=H[l[g]][0][M]){B[l[g]][M]++;break}}else var R=0}o>=v&&b>o&&u.push([N,R]),_={key:l[g],values:u,color:d[g]}}(m)}if(t.onload_summary=!0,l[g]==t.piechartselected)for(var S={},m=0;m<=s.numberofranges;m++){S.y=100*B[t.piechartselected][m]/(b-v);var G;G=m!=s.numberofranges?H[t.piechartselected][0][m]+"-"+H[t.piechartselected][0][m+1]+" "+H[t.piechartselected][1]:"> "+H[t.piechartselected][0][m]+" "+H[t.piechartselected][1],S.key=G,t.data_pie[m]=S,S={}}Y.push(_)}t.onload_nvd3line=!0,t.onload_nvd3pie=!0;for(var W=[],q=0;q<Y.length;q++)t.selected.indexOf(Y[q].key)>-1&&(W.push(Y[q]),t.data=W,console.log("phenomset"));console.log(Y),1!=a&&f(e,"Speed",1),t.markers.m1.lng>t.markers.m2.lng?(t.bounds.northEast.lng=t.markers.m1.lng+.01,t.bounds.southWest.lng=t.markers.m2.lng-.01,t.markers.m1.lat>t.markers.m2.lat?(t.bounds.northEast.lat=t.markers.m1.lat+.01,t.bounds.southWest.lat=t.markers.m2.lat-.01):(t.bounds.northEast.lat=t.markers.m2.lat+.01,t.bounds.southWest.lat=t.markers.m1.lat-.01)):(t.bounds.northEast.lng=t.markers.m2.lng+.01,t.bounds.southWest.lng=t.markers.m1.lng-.01,t.markers.m1.lat>t.markers.m2.lat?(t.bounds.northEast.lat=t.markers.m1.lat+.01,t.bounds.southWest.lat=t.markers.m2.lat-.01):(t.bounds.northEast.lat=t.markers.m2.lat+.01,t.bounds.southWest.lat=t.markers.m1.lat-.01)),console.log(t.bounds),console.log(t.markers),t.center.zoom=Math.round(20/Math.pow(p,1.5)+9),t.onload_leaflet=!0,t.tracksummary={distance:$.toFixed(2),vehiclemodel:x,vehicletype:T,vehiclemanufacturer:C,unitsspeed:K.Speed,timeoftravel:I,unitsofdistance:"Km",unitsoftime:"Minutes",fuel:M.toFixed(2),co2emissionperhour:R,starttime:new Date(D).toLocaleString(),endtime:new Date(O).toLocaleString()},console.log(t.tracksummary),t.loading=!1,console.log(t.loading)}function f(e,a,o){for(var n=0;A>n;n++){if(0==n&&1==o){var r={};r.lat=e.data.features[0].geometry.coordinates[1],r.lng=e.data.features[0].geometry.coordinates[0],r.focus=!0,r.draggable=!0,r.message=s.m1message,t.markers.m1=r,_=e.data.features[0].geometry.coordinates[1],S=e.data.features[0].geometry.coordinates[0]}if(n>=1){var i="p",l=(String(i+(n+1)),{});if(e.data.features[n-1].properties.phenomenons[a])for(var d=s.numberofranges;d>=0;d--)if(e.data.features[n-1].properties.phenomenons[a].value>=H[a][0][d]){l.color=G[d];break}l.weight=8,l.latlngs=[{lat:e.data.features[n-1].geometry.coordinates[1],lng:e.data.features[n-1].geometry.coordinates[0]},{lat:e.data.features[n].geometry.coordinates[1],lng:e.data.features[n].geometry.coordinates[0]}],W.push([e.data.features[n-1].geometry.coordinates[1],e.data.features[n-1].geometry.coordinates[0]]),l.message='<div style="color:#0065A0;width:120px"><p style="font-size:10px;"><b>Speed: </b>'+e.data.features[n-1].properties.phenomenons.Speed.value.toFixed(2)+" "+e.data.features[n-1].properties.phenomenons.Speed.unit+'</p><p style="font-size:10px;"><b>Consumption: </b>'+(void 0!=e.data.features[n-1].properties.phenomenons.Consumption?e.data.features[n-1].properties.phenomenons.Consumption.value.toFixed(2):"NA")+" "+(void 0!=e.data.features[n-1].properties.phenomenons.Consumption?e.data.features[n-1].properties.phenomenons.Consumption.unit:"NA")+'</p><p style="font-size:10px;"><b>CO2: </b>'+(void 0!=e.data.features[n-1].properties.phenomenons.CO2?e.data.features[n-1].properties.phenomenons.CO2.value.toFixed(2):"NA")+" "+(void 0!=e.data.features[n-1].properties.phenomenons.CO2?e.data.features[n-1].properties.phenomenons.CO2.unit:"NA")+"</div>",t.paths["p"+n]=l}if(n==A-1&&1==o){var c={};c.lat=e.data.features[n].geometry.coordinates[1],c.lng=e.data.features[n].geometry.coordinates[0],c.focus=!1,c.draggable=!0,c.message=s.m2message,t.markers.m2=c,W.push([e.data.features[n-1].geometry.coordinates[1],e.data.features[n-1].geometry.coordinates[0]])}}}var y={};t.SegmentAPI=!0,t.slider={minValue:0,options:{floor:0,step:1,noSwitching:!0,draggableRange:!0,id:"slider-id",onStart:function(){console.log("on start "+t.slider.maxValue)},onChange:function(){console.log("On change event fired"),g(t.slider.minValue,t.slider.maxValue),console.log("on change "+t.slider.maxValue)},onEnd:function(){console.log("on end "+t.slider.maxValue);var e=JSON.parse(JSON.stringify(y)),a=e.data.features.slice(t.slider.minValue,t.slider.maxValue);e.data.features=a,console.log(e),console.log(y),v(y,1,t.slider.minValue,t.slider.maxValue)},translate:function(e,t,a){switch(a){case"model":return"<b>Start Point:</b>"+e;case"high":return"<b>End Point:</b>"+e;default:return e}}}},t.widget=[{id:"line",title:"Line"},{id:"spline",title:"Smooth line"},{id:"area",title:"Area"},{id:"areaspline",title:"Smooth area"}],t.widgetType1="Speed",t.widgetType2="Speed",t.widgetType3="Speed",t.onload_leaflet=!1,t.onload_nvd3line=!1,t.onload_nvd3pie=!1,t.onload_nvd3_user_vs_public=!1,t.onload_summary=!1,t.loading=!0,t.barchartoptions=["Speed","Consumption","CO2"],"undefined"==typeof o.globals.currentUser?(o.url_redirect_on_login=l.path(),console.log("in if"),o.showlogout=!1):(console.log("in else"),o.showlogout=!0),console.log("came to chart controller"),t.options_pie={chart:{type:s.chart1type,height:s.chart1height+50,x:function(e){return e.key},y:function(e){return e.y},showLabels:!0,duration:s.chart1duration,labelThreshold:0,donut:!0,donutLabelsOutside:!0,cornerRadius:0,donutRatio:.45,legend:s.chart1legend,tooltip:{contentGenerator:function(e){var t="<h3><b>"+e.data.key+"</b> - "+e.data.y.toFixed(2)+"%</h3>";return console.log(e),t}}}},t.optionsSpeed={chart:{type:"discreteBarChart",height:260,margin:{top:40,right:0,bottom:40,left:50},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:500,xAxis:{axisLabel:"User vs Public "},yAxis:{axisLabel:"Speed(Km/Hr)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){console.log(e);var t="<h3><b>"+e.data.label+"</b> = "+e.data.value.toFixed(2)+"</h3>";return t}}}},t.data_pie=[],t.options={chart:{type:s.chart2type,height:s.chart2height,margin:s.chart2margin,x:function(e){return e[0]},y:function(e){return e[1]},showLegend:!1,useInteractiveGuideline:!1,interactive:!0,tooltip:{contentGenerator:function(e){var t=new Date(e.value),a="<h4>"+t.toLocaleString()+"</h4> <ul>";return e.series.forEach(function(e){a+="<li><h3 style='color:"+e.color+"'>"+e.key+": <b>"+e.value.toFixed(1)+"</b></h3> </li>"}),a+="</ul>"}},xAxis:{axisLabel:s.chart2xlabel,showMaxMin:!1,tickFormat:function(e){var t=d3.time.format("%H:%M:%S");return t(new Date(e))}},x2Axis:{showMaxMin:!1,tickFormat:function(e){var t=d3.time.format("%H:%M:%S");return t(new Date(e))}},yAxis:{axisLabel:s.chart2ylabel,tickFormat:function(e){return d3.format(",.1f")(e)}},y2Axis:{tickFormat:function(e){return d3.format(",.1f")(e)}}}};var b=c.createBoundsFromArray([[51.508742458803326,-.087890625],[51.508742458803326,-.087890625]]);angular.extend(t,{center:{},bounds:b,paths:{},markers:{},controls:{custom:[]},legend:{}}),t.events={markers:{enable:p.getAvailableEvents()}};var k=p.getAvailableEvents();for(var w in k){var P="leafletDirectiveMarker.myMap."+k[w];t.$on(P,function(e,a){if(t.eventDetected=e.name,console.log(e.name),"leafletDirectiveMarker.myMap.dragend"==e.name){console.log(e),console.log(a),console.log("Happened"+t.slider.minValue),console.log(W);for(var o=u(a.model.lat,a.model.lng,W[0][0],W[0][1]),n=0,r=0;r<W.length;r++){var i=u(a.model.lat,a.model.lng,W[r][0],W[r][1]);o>i&&(o=i,n=r)}"m1"==a.modelName?n>t.slider.maxValue&&(n=t.slider.maxValue):"m2"==a.modelName&&n<t.slider.minValue&&(n=t.slider.minValue),t.markers[a.modelName]={lat:W[n][0],lng:W[n][1],draggable:!0,message:"m1"==a.modelName?"Start":"End"},console.log(t.markers),"m1"==a.modelName?t.slider.minValue=n:"m2"==a.modelName&&(t.slider.maxValue=n),v(y,1,t.slider.minValue,t.slider.maxValue),console.log("value of i is"+n)}})}t.trailchange=function(){},t.trackid,t.name,t.created;var _,S;t.tracksummary={},t.tracksummary_c_e={fuelperhour:0,co2emission:0},t.legend={position:"bottomleft",colors:s.colorsl,labels:s.legendtable_all.Speed},t.legendtable=s.legendtable_all.Speed;var x,T,C,E,D,O,A,N,I,R,F,L,U,M=0,$=0,V=0,K={},G=s.colorsl;t.piechartselected=s.piechartselected,t.phenomenonleaflet=s.phenomenonleaflet;var z,B=JSON.parse(JSON.stringify(s.piechartsdata)),H=s.rangeobjects;t.changePhenomenon=function(e){console.log(e),console.log("changed"),console.log(t.paths),f(y,e,0),t.legendtable=[],t.legendtable=s.legendtable_all[e],console.log(t.legend),t.legend.labels=s.legendtable_all[e],console.log(t.legend),t.legend={},console.log(t.legend),console.log(t.phenomenonleaflet),console.log("end of changePhenomenon"),t.legend={position:"bottomleft",colors:s.colorsl,labels:s.legendtable_all[e]}};var Y=[];t.phenomenonnvd3="Speed",t.selected=["Speed"],t.exists=function(e,t){return t.indexOf(e)>-1},t.toggle=function(e,a){console.log("came here"),console.log(t.selected);var o=a.indexOf(e);o>-1?a.splice(o,1):a.push(e),console.log(t.selected),t.data=[];for(var n=[],r=0;r<t.selected.length;r++)for(var i=0;i<Y.length;i++)Y[i].key==t.selected[r]&&n.push(Y[i]);t.data=n,t.selected},t.changePhenomenonnvd3=function(){console.log(t.phenomenonnvd3)},t.performancePeriod="week",t.selecteditemchanged=function(e){console.log("fired");for(var a={},o=0;o<=s.numberofranges;o++){a.y=B[e][o]/(t.slider.maxValue-t.slider.minValue+1)*100;var n;n=o!=s.numberofranges?H[e][0][o]+"-"+H[e][0][o+1]+" "+H[e][1]:"> "+H[e][0][o]+" "+H[e][1],a.key=n,t.data_pie[o]=a,a={}}console.log(t.data_pie)};var j=s.urlusers;"undefined"==typeof o.globals.currentUser?(console.log("came to if"),j=s.urlbase+r.trackid,t.trackid=r.trackid,console.log("here")):(console.log("came to else"),j=j+o.globals.currentUser.username+"/tracks/",a.defaults.headers.common={"X-User":o.globals.currentUser.username,"X-Token":o.globals.currentUser.authdata},j+=r.trackid);var J,X,W=[];t.travel_distance,t.dataoverall,t.dataConsumption,t.dataCO2,t.dataSpeed,t.dataEngineload,t.consumption100Km,t.co2gKm;var q,Z=m.urltracks+r.trackid+m.urlco2stats;d.get(Z).then(function(e){console.log(e.data),q=e.data.avg,Z=m.urlcommonco2,console.log(Z),d.get(Z).then(function(e){console.log(e.data),console.log("COME IN"),t.dataCO2=[{key:"Cumulative Return",values:[{label:"User",value:q},{label:"Public",value:e.data.avg}]}]})}),Z=m.urltracks+r.trackid+m.urlspeedstats;var Q;d.get(Z).then(function(e){console.log(e.data);var a=e.data;Q=a.avg,Z=m.urlcommonspeed,console.log(Z),console.log("came here"),d.get(Z).then(function(e){console.log(e.data);var a=e.data;speed_public=a.avg,console.log("came here in 442"),t.dataSpeed=[{key:"Cumulative Return",values:[{label:"User",value:Q},{label:"Public",value:speed_public}]}],t.dataoverall=t.dataSpeed})}),Z=m.urltracks+r.trackid+m.urlconsstats;var et;d.get(Z).then(function(e){console.log(e.data),et=e.data.avg,Z=m.urlcommoncons,console.log(Z),d.get(Z).then(function(e){console.log(e.data),t.loading=!1,t.dataConsumption=[{key:"Cumulative Return",values:[{label:"User",value:et},{label:"Public",value:e.data.avg}]}],t.onload_nvd3_user_vs_public=!0})}),t.changePhenomenonbar=function(e,a){2==a||0==t.slider.minValue&&t.slider.maxValue==A-1?(t.widgetType3=e,console.log("came here"),t.dataoverall=[],"Speed"==e?(console.log(t.optionsSpeed.chart.yAxis.axisLabel),t.optionsSpeed.chart.yAxis.axisLabel="Speed (Km/h)",t.dataoverall=t.dataSpeed):"Consumption"==e?(t.optionsSpeed.chart.yAxis.axisLabel="Consumption (l/h)",t.dataoverall=t.dataConsumption):"CO2"==e&&(t.optionsSpeed.chart.yAxis.axisLabel="CO2 (Kg/h)",t.dataoverall=t.dataCO2)):(t.widgetType3=e,console.log("came here"),t.dataoverall=[],console.log(L),console.log(F),console.log(U),"Speed"==e?(console.log(t.optionsSpeed.chart.yAxis.axisLabel),t.optionsSpeed.chart.yAxis.axisLabel="Speed (Km/h)",t.dataoverall=F):"Consumption"==e?(t.optionsSpeed.chart.yAxis.axisLabel="Consumption (l/h)",t.dataoverall=L):"CO2"==e&&(t.optionsSpeed.chart.yAxis.axisLabel="CO2 (Kg/h)",t.dataoverall=U),console.log(t.dataoverall))};var tt=0;i.get(j).then(function(a){a.status>300?(console.log("getting a bad request"),t.error=a.data,e.go("home.error",{path:a.data,status:a.status})):v(a,0,0,0)}),t.showSegmentAPI=function(){console.log("User has requested for more data"),t.SegmentAPI=!1;for(var e=[],o=t.slider.minValue;o<t.slider.maxValue;o++)e.push([y.data.features[o].geometry.coordinates[1],y.data.features[o].geometry.coordinates[0]]);var n={type:"Feature",geometry:{type:"LineString",coordinates:e},timeInterval:{dateStart:"2010-06-08T11:29:10Z",dateEnd:"2026-09-08T11:29:10Z",daytimeStart:"1:30",daytimeEnd:"15:30"},tolerance:10},r={method:"POST",url:"https://envirocar.org/envirocar-rest-analyzer/dev/rest/route/statistics",data:n};delete a.defaults.headers.common["X-User"],delete a.defaults.headers.common["X-Token"],a(r).then(function(e){console.log(e)})}}]),angular.module("app").factory("factorysingletrack",["$http",function(e){console.log("called so many times");var t=function(t){return e.get(t).then(function(e){return e},function(e){return e})};return{get:t}}]),function(){function e(e,t,a){function o(a){var o,i=a?r.countries.filter(n(a)):[];return o=t.defer(),e(function(){o.resolve(i)},1e3*Math.random(),!1),o.promise}function n(e){var t=angular.lowercase(e);return function(e){return 0===e.value.indexOf(t)}}var r=this;r.countries=a.loadAll(),r.selectedCountry=null,r.searchText=null,r.querySearch=o,r.disableCaching=!0}angular.module("app").controller("SearchController",["$timeout","$q","countriesService",e])}(),angular.module("app").controller("SampleController",["$scope","$rootScope",function(e,t){e.removeMarker=function(e){console.log(t.markers),delete t.markers[e],console.log(e+"index is"),t.paths=JSON.parse(JSON.stringify({}));var a=0;for(var o in t.markers)t.markers.hasOwnProperty(o)&&(t.paths["c"+a.toString()]={type:"circle",radius:5*t.slider.value,latlngs:{lat:t.markers[o].lat,lng:t.markers[o].lng},color:"#0065A0",opacity:.5,smoothFactor:1,message:"**.**Km"},a++);if(a>=2){var n=[];for(o in t.markers)t.markers.hasOwnProperty(o)&&n.push({lat:t.markers[o].lat,lng:t.markers[o].lng}),console.log("came here");t.paths.p1={color:"green",weight:5,latlngs:n}}else console.log("came to else"),delete t.paths.p1}}]),angular.module("app").constant("profileview",{url_base:"https://envirocar.org/api/stable/users/",tracks:"/tracks",friends:"/friends",groups:"/groups"}).controller("ProfileViewController",["$scope","$rootScope","$http","$stateParams","ProfileViewFactory","profileview",function(e,t,a,o,n,r){e.originalUser=!1,e.trackurl,a.defaults.headers.common={"X-User":t.globals.currentUser.username,"X-Token":t.globals.currentUser.authdata};var i;""==o.user?i=t.globals.currentUser.username:(i=o.user,e.originalUser=!0,e.trackurl="#/dashboard/tracks/"+i),e.name_of_user=i,e.track_number=0,e.friends_number=0,e.distance_driven=0,e.groups_number=0,e.emailId;var s=r.url_base+i+r.tracks+"?limit=1";a.get(s).success(function(t,a,o){var n=o("Content-Range").split("/");e.track_number=Number(n[1])});var l=r.url_base+i+r.friends;n.get(l).then(function(t){console.log(t.data.users.length),e.friends_number=t.data.users.length});var d=r.url_base+i+r.groups;n.get(d).then(function(t){console.log(t.data.groups.length),e.groups_number=t.data.groups.length});var c=r.url_base+i;n.get(c).then(function(t){console.log(t.data),e.emailId=t.data.mail})}]),angular.module("app").factory("ProfileViewFactory",["$http",function(e){var t=function(t){return e.get(t).success(function(e){return console.log(e),e})};return{get:t}}]),angular.module("app").controller("ProfileController",["$rootScope","$timeout","$scope","$http","factorysingletrack",function(e,t,a,o,n){function r(){url="https://envirocar.org/api/stable/users/"+e.globals.currentUser.username,n.get(url).then(function(e){if(a.created=new Date(e.data.created).toLocaleString().split(",")[0],a.modified=new Date(e.data.modified).toLocaleString().split(",")[0],a.termsOfUseVersion=new Date(e.data.acceptedTermsOfUseVersion).toLocaleString().split(",")[0],console.log(e.data),void 0!=e.data.firstName&&(a.firstName=e.data.firstName),void 0!=e.data.lastName&&(a.lastName=e.data.lastName),void 0!=e.data.gender?(a.gender=e.data.gender,a.gendertext="m"==a.gender?"Male":"Female"):a.gendertext="NA",void 0!=e.data.country?(a.country=e.data.country,a.countrytext=e.data.country):a.countrytext="NA",void 0!=e.data.language?(a.langfull=e.data.language,a.lang=e.data.language.split("-")[0],"en"==a.lang?a.langtext="English":"de"==a.lang&&(a.langtext="German")):a.langtext="NA",void 0!=e.data.mail&&(a.emailId=e.data.mail),void 0!=e.data.dayOfBirth){a.birthday=e.data.dayOfBirth;var t=e.data.dayOfBirth.split("-");console.log(t[0]+" "+t[1]+" "+t[2]),a.dateBirthdayPicker=new Date(t[0],t[1]-1,t[2])}if(a.profilepic=url+"/avatar",void 0!=e.data.badges){a.badgesTrue=!0;for(var o=0;o<e.data.badges.length;o++){var n={};n.title=e.data.badges[o],"developer"==e.data.badges[o]?n.url="assets\\images\\ic_code_black_48dp.png":"contributor"==e.data.badges[o]&&(n.url="assets\\images\\ic_person_add_black_48dp.png"),a.badges.push(n)}}})}var i;a.submissionSuccess=!1,a.submissionErrorMessage="",a.submissionFailure=!1,a.updateUserDetails=function(){a.submissionSuccess=!1,a.submissionErrorMessage="",a.submissionFailure=!1;var n=!0,s=0;void 0!=a.oldpassword&&""!=a.oldpassword&&(void 0==a.newpassword||""==a.newpassword)&&(n=!1,s=0),void 0!=a.newpassword&&""!=a.newpassword&&(console.log(a.oldpassword),(void 0==a.oldpassword||""==a.oldpassword)&&(console.log("shouldnt have come"),n=!1,s=1),a.newpassword!=a.newpasswordrepeat&&(n=!1,s=2)),console.log("came here");var l={};if(void 0!=a.firstName&&(l.firstName=a.firstName),void 0!=a.emailId&&(l.mail=a.emailId),void 0!=a.lastName&&(l.lastName=a.lastName),void 0!=a.country&&(l.country=a.country),void 0!=a.dateBirthdayPicker){var d=a.dateBirthdayPicker.getFullYear().toString()+"-"+(a.dateBirthdayPicker.getMonth()+1).toString()+"-"+a.dateBirthdayPicker.getDate().toString();console.log(d),l.dayOfBirth=d}void 0!=a.gender&&(l.gender=a.gender),void 0!=a.newpassword&&""!=a.newpassword&&(l.token=a.newpassword),void 0!=a.oldpassword&&(i=a.oldpassword),void 0!=a.langfull&&(l.language=a.langfull);var c={method:"PUT",url:"https://envirocar.org/api/stable/users/"+e.globals.currentUser.username,data:l};void 0!=i&&(o.defaults.headers.common={"X-User":e.globals.currentUser.username,"X-Token":i}),console.log(l),1==n?(console.log(c),o(c).then(function(o){a.submissionSuccess=!0,t(function(){a.submissionSuccess=!1},2e3),void 0!=a.newpassword&&""!=a.newpassword&&(e.globals.currentUser.authdata=a.newpassword),console.log(o),r()},function(e){a.submissionErrorMessage="Could not update profile",403==e.status&&(a.submissionErrorMessage="Please enter the correct existing password"),a.submissionFailure=!0,console.log(e)})):(1==s?(console.log("type in old password please"),a.submissionErrorMessage="Please enter your current password"):2==s?a.submissionErrorMessage="Please re-enter your new password correctly.":0==s&&(a.submissionErrorMessage="New password cannot be empty"),a.submissionFailure=!0)},a.ifpassword=!1,a.passwordentered=function(){},a.name=e.globals.currentUser.username,a.firstName,a.lastName,a.emailId,a.country,a.countrytext,a.birthday,a.gendertext,a.gender=void 0,a.lang=void 0,a.langfull,a.langtext,a.oldpassword,a.newpassword,a.newpasswordrepeat,a.created,a.modified,a.termsOfUseVersion,a.badges=[],a.badgesTrue=!1,a.dateBirthdayPicker=void 0,r(),a.myDate=new Date}]),angular.module("app").controller("MyActivityControllerFixed",["$scope","$http","$rootScope","$state","$stateParams","myactivity",function(e,t,a,o,n,r){e.show_no_my_activity=!1,e.loading=!1,e.fetchingResults=!1,console.log("fired my activity"),e.events=[];var i=[];if(e.busy=!1,e.page=0,e.page_size=r.page_size,"undefined"==typeof a.globals.currentUser)console.log("came here to if");else{console.log("fired else"),t.defaults.headers.common={"X-User":a.globals.currentUser.username,"X-Token":a.globals.currentUser.authdata},e.username;var s;""==n.user?(s=a.globals.currentUser.username,e.username="Your"):(s=n.user,e.username=s);var l=0;e.nextpage=function(){1==l&&(e.fetchingResults=!0),e.page++;var o=r.url_base+a.globals.currentUser.username+r.yourself;t.get(o+"limit="+e.page_size+"&page="+e.page).success(function(t){0==t.activities.length&&(e.show_no_my_activity=!0);for(var a=0;a<t.activities.length;a++){var o={};if(o.time=t.activities[a].time,o.name=t.activities[a].user.name,o.date=new Date(t.activities[a].time).toLocaleString(),o.color="#8CBF3F","FRIENDED_USER"==t.activities[a].type)o.type=0,o.color="#0065A0",o.topic="New Friend Activity",o.name="You are friends with"+t.activities[a].other.name,o.trackidlink="",o.icon="people";else if("CREATED_TRACK"==t.activities[a].type)o.type=1,o.color="#0065A0",o.topic="New Track Upload",o.trackidlink=t.activities[a].track.id,o.icon="add_circle";else if("CHANGED_PROFILE"==t.activities[a].type)o.type=0,o.topic="Profile Update",o.icon="update";else{if("UNFRIENDED_USER"==t.activities[a].type)continue;"CREATED_GROUP"==t.activities[a].type?(o.type=0,o.topic="You created a Group",o.icon="speaker_groups"):"CHANGED_GROUP"==t.activities[a].type?(o.type=0,o.topic="You changed the group",o.icon="speaker_groups"):"JOINED_GROUP"==t.activities[a].type?(o.type=0,o.topic="You joined the Group",o.icon="group_add"):"LEFT_GROUP"==t.activities[a].type?(o.type=0,o.topic="You left the Group"):"DELETED_GROUP"==t.activities[a].type&&(o.type=0,o.topic="You deleted the group")}i.push(o)}l=1,e.fetchingResults=!1,e.events=i})},e.nextpage(e.page),e.goToActivity=function(e,t){1==e&&o.go("home.chart",{trackid:t}),console.log("fired")}}}]),angular.module("app").constant("myactivity",{page_size:5,url_base:"https://envirocar.org/api/stable/users/",yourself:"/activities?",avatar:"/avatar"}).controller("MyActivityController",["$scope","$http","$rootScope","$state","$stateParams","myactivity",function(e,t,a,o,n,r){e.fetchingResults=!1,e.totalLoading=!0,e.show_no_my_activity=!1,console.log("fired my activity"),e.events=[];var i=[];if(e.busy=!1,e.page=0,e.page_size=r.page_size,"undefined"==typeof a.globals.currentUser)console.log("came here to if");else{console.log("fired else"),t.defaults.headers.common={"X-User":a.globals.currentUser.username,"X-Token":a.globals.currentUser.authdata},e.username;var s;""==n.user?(s=a.globals.currentUser.username,e.username="Your"):(s=n.user,e.username=s);var l=0;e.nextpage=function(){1==l&&(e.fetchingResults=!0),e.page++;var a=r.url_base+s+r.yourself;t.get(a+"limit="+e.page_size+"&page="+e.page).success(function(t){0==t.activities.length&&(e.show_no_my_activity=!0);for(var a=0;a<t.activities.length;a++){var o={};if(o.time=t.activities[a].time,o.name=t.activities[a].user.name,o.date=new Date(t.activities[a].time).toLocaleString(),o.color="#8CBF3F","FRIENDED_USER"==t.activities[a].type)o.type=0,o.topic="New Friend Activity",o.name=s+" is now friends with "+t.activities[a].other.name,o.trackidlink="",o.color="#0065A0",o.icon="people";else if("CREATED_TRACK"==t.activities[a].type)o.type=1,o.color="#0065A0",o.topic="New Track Upload",o.trackidlink=t.activities[a].track.id,o.icon="add_circle";else if("CHANGED_PROFILE"==t.activities[a].type)o.type=0,o.topic="Profile Update",o.icon="update";else{if("UNFRIENDED_USER"==t.activities[a].type)continue;"CREATED_GROUP"==t.activities[a].type?(o.type=0,o.topic="You created a Group",o.icon="speaker_groups"):"CHANGED_GROUP"==t.activities[a].type?(o.type=0,o.topic="You changed the group",o.icon="speaker_groups"):"JOINED_GROUP"==t.activities[a].type?(o.type=0,o.topic="You joined the Group",o.icon="group_add"):"LEFT_GROUP"==t.activities[a].type?(o.type=0,o.topic="You left the Group"):"DELETED_GROUP"==t.activities[a].type&&(o.type=0,o.topic="You deleted the group")}i.push(o)}e.events=i,l=1,e.fetchingResults=!1,e.totalLoading=!1})},e.nextpage(e.page),e.goToActivity=function(e,t){1==e&&o.go("home.chart",{trackid:t}),console.log("fired")}}}])(function(){function e(e){var t=this;
t.messages=[],e.loadAllItems().then(function(e){t.messages=[].concat(e)})}angular.module("app").controller("MessagesController",["messagesService",e])})(),function(){function e(e,t,a,o,n,r,i,s,l,d,c){function m(){t("right").toggle()}function p(){console.log("fired here");var e=a.hide()||n.when(!0);e.then(function(){t("left").toggle()})}function g(e){h.title=e.name,h.showSimpleToast(h.title)}function u(e){console.log(e+"got shown"),i.show(i.simple().content(e).hideDelay(2e3).position("bottom right"))}console.log("In main Controller");var h=this;h.lockLeft=!1,c.showMobileMainHeader=!0,c.openSideNavPanel=function(){t("left").open()},c.closeSideNavPanel=function(){console.log("event fired for closing"),t("left").toggle()},"undefined"==typeof l.globals.currentUser?l.showlogout=!1:(l.showlogout=!0,s.defaults.headers.common={"X-User":l.globals.currentUser.username,"X-Token":l.globals.currentUser.authdata},h.profilename=l.globals.currentUser.username,h.url="https://envirocar.org/api/stable/users/"+l.globals.currentUser.username+"/avatar",h.about="https://envirocar.org/api/stable/users/"+l.globals.currentUser.username,s.get(h.about).then(function(e){h.email=e.data.mail}),s.get(h.url,{responseType:"arraybuffer"}).then(function(e){console.log("came here too");var t=new Blob([e.data],{type:e.headers("Content-Type")});h.profilepic=URL.createObjectURL(t),console.log(h.profilepic)})),h.menuItems=[],h.selectItem=g,h.toggleItemsList=p,h.title=r.current.data.title,h.showSimpleToast=u,h.toggleRightSidebar=m,e.loadAllItems().then(function(e){h.menuItems=[].concat(e);var t,a,o,n;d(["DASHBOARD","TRACKS","TABLE","SPEEDARRAY","SEGMENT"]).then(function(e){t=e.DASHBOARD,a=e.TRACKS,o=e.TABLE,n=e.SEGMENT,h.menuItems[0].name=t,h.menuItems[1].name=a,h.menuItems[2].name=o,h.menuItems[3].name=n})})}angular.module("app").controller("MainController",["navService","$mdSidenav","$mdBottomSheet","$log","$q","$state","$mdToast","$http","$rootScope","$translate","$scope",e])}(),angular.module("app").factory("Auth",["$http","$cookieStore","$rootScope",function(e,t,a){var o={};return o.login=function(t,a,o){var n="https://envirocar.org/api/stable/users/";n=n+t+"/statistics";var r={success:!0},i={success:!1};e.defaults.headers.common={"X-User":t,"X-Token":a},e({url:n}).then(function(){console.log("something postiive"),o(r)},function(){o(i)})},o.SetCredentials=function(o,n){a.globals={currentUser:{username:o,authdata:n}},delete e.defaults.headers.common["X-User"],delete e.defaults.headers.common["X-Token"],t.put("globals",a.globals)},o.ClearCredentials=function(){a.globals={},t.remove("globals"),e.defaults.headers.common={"X-User":void 0,"X-Token":void 0},console.log("current user"+a.globals.currentUser)},o}]),angular.module("app").controller("LoginController",["$scope","$rootScope","$location","Auth",function(e,t,a,o){console.log("Controller fired"),console.log("refresh page is called"),o.ClearCredentials(),e.login=function(){e.dataLoading=!0,o.login(e.username,e.password,function(n){1==n.success?(console.log("response is true"),o.SetCredentials(e.username,e.password),a.path("undefined"!=typeof t.url_redirect_on_login?t.url_redirect_on_login:"/dashboard/home")):(e.error="Invalid Login Credentials",e.dataLoading=!1)})}}]),angular.module("app").controller("LeafletHeatMap",["$scope","$rootScope","$http","factorysingletrack",function(e,t,a,o){e.onload_heat_map=!1,console.log(" came here");var n=[0,0],r=[],i=[],s=[];o.get("https://envirocar.org/ng-user-stats.json").then(function(t){console.log("hello"),console.log(t);for(var a=[{id:"5743fd9ee4b09078f971f0d7",startPosition:{geometry:{type:"Point",coordinates:[6.935220557150537,51.38094428409963]}},endPosition:{geometry:{type:"Point",coordinates:[7.022849717547225,51.43455885936926]}}},{id:"4743fd9ee4b09078f971f0d8",startPosition:{geometry:{type:"Point",coordinates:[13.154406,53.437805]}},endPosition:{geometry:{type:"Point",coordinates:[13.3228,53.4959299]}}},{id:"3743fd9ee4b09078f971f0d8",startPosition:{geometry:{type:"Point",coordinates:[23.154406,43.437805]}},endPosition:{geometry:{type:"Point",coordinates:[23.3228,43.4959299]}}},{id:"5776646ae4b0ea2464218442",startPosition:{geometry:{type:"Point",coordinates:[6.404467358656342,51.18402870429451]}},endPosition:{geometry:{type:"Point",coordinates:[6.404994199946344,51.18590591284348]}}},{id:"57765114e4b0ea2464214e96",startPosition:{geometry:{type:"Point",coordinates:[7.641653513517912,51.956889236456284]}},endPosition:{geometry:{type:"Point",coordinates:[7.6477345356974045,51.95404470543948]}}},{id:"5776513de4b0ea2464214f1a",startPosition:{geometry:{type:"Point",coordinates:[7.644580375786573,51.95460329091727]}},endPosition:{geometry:{type:"Point",coordinates:[7.6412895835009795,51.956036665113196]}}},{id:"57764b65e4b0ea246421494a",startPosition:{geometry:{type:"Point",coordinates:[6.427190755898763,51.20035713936406]}},endPosition:{geometry:{type:"Point",coordinates:[6.4369039520241715,51.19951241601204]}}},{id:"57764b62e4b0ea2464214848",startPosition:{geometry:{type:"Point",coordinates:[6.443737426641247,51.199998838200884]}},endPosition:{geometry:{type:"Point",coordinates:[6.44773457388116,51.201610174761306]}}},{id:"57764b63e4b0ea246421487c",startPosition:{geometry:{type:"Point",coordinates:[6.44563430943914,51.20260973045408]}},endPosition:{geometry:{type:"Point",coordinates:[6.4410457990889425,51.20414591608706]}}},{id:"57764b64e4b0ea24642148ad",startPosition:{geometry:{type:"Point",coordinates:[6.43929006194608,51.19582188129439]}},endPosition:{geometry:{type:"Point",coordinates:[6.427064527094577,51.20084237852869]}}},{id:"5776518fe4b0ea2464214f3e",startPosition:{geometry:{type:"Point",coordinates:[7.632133599848622,51.95599261825207]}},endPosition:{geometry:{type:"Point",coordinates:[7.6485514011562215,51.955012116904655]}}},{id:"57764b61e4b0ea24642147db",startPosition:{geometry:{type:"Point",coordinates:[6.45486727934904,51.20998686022393]}},endPosition:{geometry:{type:"Point",coordinates:[6.440926882288661,51.203321502694486]}}},{id:"577647e0e4b0ea2464214047",startPosition:{geometry:{type:"Point",coordinates:[6.443865342879771,51.185014762188246]}},endPosition:{geometry:{type:"Point",coordinates:[6.446904646006544,51.16931538549046]}}},{id:"57764b60e4b0ea2464214717",startPosition:{geometry:{type:"Point",coordinates:[6.439810550833277,51.20136557982892]}},endPosition:{geometry:{type:"Point",coordinates:[6.456300587013309,51.21496764387763]}}},{id:"57763e39e4b0ea2464211a05",startPosition:{geometry:{type:"Point",coordinates:[6.412197571715114,51.195367234564465]}},endPosition:{geometry:{type:"Point",coordinates:[6.409762833517873,51.19807611831955]}}},{id:"577647e2e4b0ea24642140ea",startPosition:{geometry:{type:"Point",coordinates:[6.440396944379694,51.18504038143365]}},endPosition:{geometry:{type:"Point",coordinates:[6.390027480169449,51.19254517652837]}}},{id:"57762a36e4b0ea24642030ac",startPosition:{geometry:{type:"Point",coordinates:[6.409511547281797,51.19786618976425]}},endPosition:{geometry:{type:"Point",coordinates:[6.4120479639500525,51.19795008046114]}}},{id:"57765472e4b0ea24642152db",startPosition:{geometry:{type:"Point",coordinates:[6.456092810259012,51.18468218811857]}},endPosition:{geometry:{type:"Point",coordinates:[6.402350481603779,51.2014438862616]}}},{id:"5776546ce4b0ea2464215109",startPosition:{geometry:{type:"Point",coordinates:[6.404186492878825,51.20309410689679]}},endPosition:{geometry:{type:"Point",coordinates:[6.456351780733914,51.18484844129571]}}},{id:"57764b66e4b0ea24642149a8",startPosition:{geometry:{type:"Point",coordinates:[6.43255700112168,51.19886228955912]}},endPosition:{geometry:{type:"Point",coordinates:[6.428119723185099,51.17757398705777]}}},{id:"57764b5ae4b0ea2464214319",startPosition:{geometry:{type:"Point",coordinates:[6.419246778980549,51.215740652264934]}},endPosition:{geometry:{type:"Point",coordinates:[6.3689590096596,51.158544927457314]}}},{id:"57766521e4b0ea24642187b5",startPosition:{geometry:{type:"Point",coordinates:[6.441005582085575,51.12363649923138]}},endPosition:{geometry:{type:"Point",coordinates:[6.442626609241849,51.16672815355285]}}},{id:"5775854ce4b0ea24641da5a9",startPosition:{geometry:{type:"Point",coordinates:[6.417558941003384,51.14382199808161]}},endPosition:{geometry:{type:"Point",coordinates:[6.413271353042924,51.094747919870606]}}},{id:"57764b5ee4b0ea246421453c",startPosition:{geometry:{type:"Point",coordinates:[6.373425555120594,51.16118965462855]}},endPosition:{geometry:{type:"Point",coordinates:[6.443653232613194,51.20001341819564]}}},{id:"57762a36e4b0ea24642030d4",startPosition:{geometry:{type:"Point",coordinates:[6.4202348470532895,51.194697475032775]}},endPosition:{geometry:{type:"Point",coordinates:[6.45868993021597,51.1951390723582]}}},{id:"57764b57e4b0ea2464214210",startPosition:{geometry:{type:"Point",coordinates:[6.438703968759348,51.1991327032544]}},endPosition:{geometry:{type:"Point",coordinates:[6.413686140623232,51.213617243032076]}}},{id:"57763e37e4b0ea2464211923",startPosition:{geometry:{type:"Point",coordinates:[6.458745607337564,51.19533627597726]}},endPosition:{geometry:{type:"Point",coordinates:[6.419121175084944,51.19475690825986]}}},{id:"57764760e4b0ea2464213ccb",startPosition:{geometry:{type:"Point",coordinates:[6.39120494682648,51.17504964428816]}},endPosition:{geometry:{type:"Point",coordinates:[6.4089448179814115,51.18163933489207]}}},{id:"57766523e4b0ea24642189b4",startPosition:{geometry:{type:"Point",coordinates:[6.44165383902738,51.16656083105762]}},endPosition:{geometry:{type:"Point",coordinates:[6.439141153299213,51.12297296132521]}}},{id:"57764754e4b0ea24642139b8",startPosition:{geometry:{type:"Point",coordinates:[6.420027498621065,51.176500651076985]}},endPosition:{geometry:{type:"Point",coordinates:[6.3897588826268095,51.175738106186515]}}},{id:"577580f2e4b0ea24641da3d9",startPosition:{geometry:{type:"Point",coordinates:[6.446925288890427,51.16754034146805]}},endPosition:{geometry:{type:"Point",coordinates:[6.398557335065439,51.12570940504561]}}},{id:"577645b6e4b0ea246421369e",startPosition:{geometry:{type:"Point",coordinates:[6.420027498621065,51.176500651076985]}},endPosition:{geometry:{type:"Point",coordinates:[6.3897588826268095,51.175738106186515]}}},{id:"5775854fe4b0ea24641da64f",startPosition:{geometry:{type:"Point",coordinates:[6.41588704348048,51.100945256103174]}},endPosition:{geometry:{type:"Point",coordinates:[6.422399327477971,51.15753544594532]}}},{id:"577650e3e4b0ea2464214d16",startPosition:{geometry:{type:"Point",coordinates:[7.602228816418063,51.96903492848623]}},endPosition:{geometry:{type:"Point",coordinates:[7.647665370140864,51.9551397791675]}}},{id:"577647dde4b0ea2464213e96",startPosition:{geometry:{type:"Point",coordinates:[6.390124305341978,51.19257605575694]}},endPosition:{geometry:{type:"Point",coordinates:[6.44409581391083,51.1853207866315]}}},{id:"5775f11be4b0ea24641fda23",startPosition:{geometry:{type:"Point",coordinates:[6.211513451950248,51.14426000463695]}},endPosition:{geometry:{type:"Point",coordinates:[6.348597743272769,51.201264572251986]}}},{id:"57756156e4b0ea246419b3ad",startPosition:{geometry:{type:"Point",coordinates:[6.425876369741509,51.19850915604567]}},endPosition:{geometry:{type:"Point",coordinates:[6.4463635317110075,51.22405820860787]}}},{id:"5775806fe4b0ea24641da1d2",startPosition:{geometry:{type:"Point",coordinates:[6.443179119938943,51.1685594601409]}},endPosition:{geometry:{type:"Point",coordinates:[6.3754798036878935,51.16290675034104]}}},{id:"57756157e4b0ea246419b52f",startPosition:{geometry:{type:"Point",coordinates:[6.425869158670476,51.198572576756746]}},endPosition:{geometry:{type:"Point",coordinates:[6.445384582653745,51.221667626462576]}}},{id:"57760f1be4b0ea24641fe96f",startPosition:{geometry:{type:"Point",coordinates:[6.386826574433698,51.19814143265563]}},endPosition:{geometry:{type:"Point",coordinates:[6.612717523792998,51.28093183464423]}}},{id:"57756159e4b0ea246419b7cb",startPosition:{geometry:{type:"Point",coordinates:[6.415099626209443,51.20055772702341]}},endPosition:{geometry:{type:"Point",coordinates:[6.444839689876966,51.22169285547183]}}},{id:"57756156e4b0ea246419b49b",startPosition:{geometry:{type:"Point",coordinates:[6.4341380683832,51.211107281602864]}},endPosition:{geometry:{type:"Point",coordinates:[6.424736693755456,51.198114303993705]}}},{id:"577666f3e4b0ea246422750d",startPosition:{geometry:{type:"Point",coordinates:[6.4278825070300964,51.19804019929087]}},endPosition:{geometry:{type:"Point",coordinates:[6.54211730029207,51.10968042719116]}}},{id:"57761583e4b0ea24641febc4",startPosition:{geometry:{type:"Point",coordinates:[6.23123161778507,50.85634716009756]}},endPosition:{geometry:{type:"Point",coordinates:[6.241040271528663,50.802995703819875]}}},{id:"577615b0e4b0ea24641ff3ad",startPosition:{geometry:{type:"Point",coordinates:[6.228170065051653,50.79420747661774]}},endPosition:{geometry:{type:"Point",coordinates:[6.424548509978474,51.01630565939218]}}},{id:"57756158e4b0ea246419b5ff",startPosition:{geometry:{type:"Point",coordinates:[6.4430293404384695,51.22102344053987]}},endPosition:{geometry:{type:"Point",coordinates:[6.388987051660804,51.1766357146839]}}},{id:"5775694de4b0ea246419bd39",startPosition:{geometry:{type:"Point",coordinates:[6.424345891656163,51.140910332043504]}},endPosition:{geometry:{type:"Point",coordinates:[6.43334504212789,51.19559824185155]}}},{id:"577558b7e4b0ea246419a4b9",startPosition:{geometry:{type:"Point",coordinates:[6.402815635450066,51.18395288527392]}},endPosition:{geometry:{type:"Point",coordinates:[6.403611136772709,51.18443495859965]}}},{id:"57762610e4b0ea24642016f3",startPosition:{geometry:{type:"Point",coordinates:[6.447442248181672,51.172312210909865]}},endPosition:{geometry:{type:"Point",coordinates:[6.450634671651676,51.19478171258259]}}},{id:"577558bae4b0ea246419a4d2",startPosition:{geometry:{type:"Point",coordinates:[6.403548603400469,51.18446386255167]}},endPosition:{geometry:{type:"Point",coordinates:[6.402986197947947,51.184603619786174]}}},{id:"5775f116e4b0ea24641fd5a8",startPosition:{geometry:{type:"Point",coordinates:[6.480720372216372,51.20158347700896]}},endPosition:{geometry:{type:"Point",coordinates:[6.211409357532932,51.14287870210212]}}},{id:"57756949e4b0ea246419b87b",startPosition:{geometry:{type:"Point",coordinates:[6.430783627901177,51.1959699626695]}},endPosition:{geometry:{type:"Point",coordinates:[6.3887301567834385,51.1494178508743]}}},{id:"5775694fe4b0ea246419bede",startPosition:{geometry:{type:"Point",coordinates:[6.439650147104313,51.19591265247778]}},endPosition:{geometry:{type:"Point",coordinates:[6.536297320899561,51.26801688948248]}}},{id:"577558c1e4b0ea246419a77d",startPosition:{geometry:{type:"Point",coordinates:[6.454055987279665,51.159728080568605]}},endPosition:{geometry:{type:"Point",coordinates:[6.453654311053313,51.16038358948236]}}},{id:"5775f11de4b0ea24641fdc7c",startPosition:{geometry:{type:"Point",coordinates:[6.348287742363263,51.20128373310953]}},endPosition:{geometry:{type:"Point",coordinates:[6.479093516522896,51.20080743949056]}}},{id:"577615a9e4b0ea24641ff0d7",startPosition:{geometry:{type:"Point",coordinates:[6.457157173286543,51.03890419162651]}},endPosition:{geometry:{type:"Point",coordinates:[6.429525394100404,51.193132790874465]}}},{id:"577558ade4b0ea246419a20e",startPosition:{geometry:{type:"Point",coordinates:[6.45092104807674,51.1677034140092]}},endPosition:{geometry:{type:"Point",coordinates:[6.447683956429245,51.14742122498984]}}},{id:"5775f06de4b0ea24641fd2e6",startPosition:{geometry:{type:"Point",coordinates:[6.480911848880332,51.27318961891811]}},endPosition:{geometry:{type:"Point",coordinates:[6.36553807926018,51.153772723446295]}}},{id:"577666f0e4b0ea2464227191",startPosition:{geometry:{type:"Point",coordinates:[6.542169407017739,51.10975037196807]}},endPosition:{geometry:{type:"Point",coordinates:[6.427843598341901,51.198046449795534]}}},{id:"577558eae4b0ea246419ac56",startPosition:{geometry:{type:"Point",coordinates:[6.465314378084453,51.212383720046276]}},endPosition:{geometry:{type:"Point",coordinates:[6.463332848366965,51.213847130531185]}}},{id:"57754019e4b0ea24641928a6",startPosition:{geometry:{type:"Point",coordinates:[6.38303135144122,51.20078389931177]}},endPosition:{geometry:{type:"Point",coordinates:[6.397179261472343,51.19793439148825]}}},{id:"577558a3e4b0ea246419a180",startPosition:{geometry:{type:"Point",coordinates:[6.441144609910536,51.16833202217391]}},endPosition:{geometry:{type:"Point",coordinates:[6.439740485453308,51.17484606761607]}}},{id:"577605bfe4b0ea24641fe6f7",startPosition:{geometry:{type:"Point",coordinates:[6.418390786873346,51.153515684771904]}},endPosition:{geometry:{type:"Point",coordinates:[6.447801282779045,51.19497312747178]}}},{id:"577558b4e4b0ea246419a2f3",startPosition:{geometry:{type:"Point",coordinates:[6.447962026577092,51.14733729682779]}},endPosition:{geometry:{type:"Point",coordinates:[6.4039665702115105,51.18408904726774]}}},{id:"5775524fe4b0ea24641992c1",startPosition:{geometry:{type:"Point",coordinates:[6.451022772674847,51.15859102708801]}},endPosition:{geometry:{type:"Point",coordinates:[6.441588399328962,51.143108211959465]}}},{id:"57756154e4b0ea246419b006",startPosition:{geometry:{type:"Point",coordinates:[6.448384837039912,51.224134999550955]}},endPosition:{geometry:{type:"Point",coordinates:[6.389599432865177,51.17656366190115]}}},{id:"57754c5ae4b0ea24641938cd",startPosition:{geometry:{type:"Point",coordinates:[6.42149733,51.18750078]}},endPosition:{geometry:{type:"Point",coordinates:[6.436325599881156,51.199319557684305]}}},{id:"577558e8e4b0ea246419aa84",startPosition:{geometry:{type:"Point",coordinates:[6.4359819098197075,51.1950955118657]}},endPosition:{geometry:{type:"Point",coordinates:[6.464927634705559,51.212097445617935]}}},{id:"577558eee4b0ea246419aca5",startPosition:{geometry:{type:"Point",coordinates:[6.464175277924784,51.213494675426446]}},endPosition:{geometry:{type:"Point",coordinates:[6.442484572218469,51.22487129762233]}}},{id:"57753ffde4b0ea2464191c42",startPosition:{geometry:{type:"Point",coordinates:[6.42510251486487,51.191731708153014]}},endPosition:{geometry:{type:"Point",coordinates:[6.402513363011447,51.201583637600464]}}},{id:"57766468e4b0ea2464217f8b",startPosition:{geometry:{type:"Point",coordinates:[6.3633384775742305,51.15125428529916]}},endPosition:{geometry:{type:"Point",coordinates:[6.4044957049191,51.1840085266158]}}},{id:"57756952e4b0ea246419c11f",startPosition:{geometry:{type:"Point",coordinates:[6.386012875417266,51.14446169469532]}},endPosition:{geometry:{type:"Point",coordinates:[6.442021265189815,51.19103553280199]}}},{id:"577603c4e4b0ea24641fdec8",startPosition:{geometry:{type:"Point",coordinates:[6.441762592592097,51.14308015160661]}},endPosition:{geometry:{type:"Point",coordinates:[6.509039142449997,51.27173713095]}}},{id:"57756155e4b0ea246419b298",startPosition:{geometry:{type:"Point",coordinates:[6.390550890415572,51.176085183341414]}},endPosition:{geometry:{type:"Point",coordinates:[6.420206923286264,51.19458501857206]}}},{id:"57754017e4b0ea246419250e",startPosition:{geometry:{type:"Point",coordinates:[6.448140260343947,51.18473239531964]}},endPosition:{geometry:{type:"Point",coordinates:[6.386759135726731,51.20212836168953]}}},{id:"57755556e4b0ea246419998f",startPosition:{geometry:{type:"Point",coordinates:[6.429611104814467,51.19806301976002]}},endPosition:{geometry:{type:"Point",coordinates:[6.384140513070005,51.17566881140999]}}},{id:"57762d08e4b0ea246420e19f",startPosition:{geometry:{type:"Point",coordinates:[6.3412654717962695,51.20868552910721]}},endPosition:{geometry:{type:"Point",coordinates:[6.43537518,51.20820034]}}},{id:"57754019e4b0ea2464192698",startPosition:{geometry:{type:"Point",coordinates:[6.473873813654386,51.20036373756599]}},endPosition:{geometry:{type:"Point",coordinates:[6.431838310238083,51.176731875955596]}}},{id:"57754122e4b0ea2464192933",startPosition:{geometry:{type:"Point",coordinates:[6.390358370638606,51.194409751587955]}},endPosition:{geometry:{type:"Point",coordinates:[6.414737201466832,51.1835896322786]}}},{id:"5775694be4b0ea246419ba41",startPosition:{geometry:{type:"Point",coordinates:[6.386991693487049,51.14241409484467]}},endPosition:{geometry:{type:"Point",coordinates:[6.419177038072087,51.13664153268]}}},{id:"5775589fe4b0ea2464199eeb",startPosition:{geometry:{type:"Point",coordinates:[6.442503246300685,51.22525056371982]}},endPosition:{geometry:{type:"Point",coordinates:[6.450206812505572,51.168349733727766]}}},{id:"577558cae4b0ea246419a7c9",startPosition:{geometry:{type:"Point",coordinates:[6.453868235205829,51.160117537121735]}},endPosition:{geometry:{type:"Point",coordinates:[6.438275011961704,51.19580787243987]}}},{id:"577558bee4b0ea246419a51e",startPosition:{geometry:{type:"Point",coordinates:[6.398688969493568,51.18487700171065]}},endPosition:{geometry:{type:"Point",coordinates:[6.450300648676292,51.16834437922643]}}},{id:"57755554e4b0ea2464199622",startPosition:{geometry:{type:"Point",coordinates:[6.54240284,51.10970271]}},endPosition:{geometry:{type:"Point",coordinates:[6.429466164143436,51.198072887579734]}}},{id:"57754c60e4b0ea24641939c1",startPosition:{geometry:{type:"Point",coordinates:[6.4375773348916026,51.20253001715635]}},endPosition:{geometry:{type:"Point",coordinates:[6.786972407284545,51.241541176748505]}}},{id:"5776158be4b0ea24641fece1",startPosition:{geometry:{type:"Point",coordinates:[6.421548815542783,51.19711366277678]}},endPosition:{geometry:{type:"Point",coordinates:[6.241994461052773,50.879065299480594]}}},{id:"57754cb8e4b0ea246419435f",startPosition:{geometry:{type:"Point",coordinates:[6.452885559922661,51.16614113396189]}},endPosition:{geometry:{type:"Point",coordinates:[6.443758182767971,51.20004629103491]}}},{id:"5775524be4b0ea2464198f7e",startPosition:{geometry:{type:"Point",coordinates:[6.507101711098747,51.2730986957346]}},endPosition:{geometry:{type:"Point",coordinates:[6.451800802863536,51.16233315927008]}}},{id:"57754c73e4b0ea2464193d2e",startPosition:{geometry:{type:"Point",coordinates:[6.786901918269779,51.24040952118132]}},endPosition:{geometry:{type:"Point",coordinates:[6.452768293346492,51.1656662463841]}}},{id:"57762c16e4b0ea2464206d8b",startPosition:{geometry:{type:"Point",coordinates:[6.341161336995731,51.208415988228296]}},endPosition:{geometry:{type:"Point",coordinates:[6.441853323681045,51.16888390040913]}}},{id:"57762cd3e4b0ea246420dd7b",startPosition:{geometry:{type:"Point",coordinates:[6.438977654222656,51.16867544961613]}},endPosition:{geometry:{type:"Point",coordinates:[6.34207791,51.20551356]}}},{id:"57754014e4b0ea2464191d2d",startPosition:{geometry:{type:"Point",coordinates:[7.107602489267209,51.5026794472295]}},endPosition:{geometry:{type:"Point",coordinates:[6.45557201270198,51.18452750196255]}}},{id:"577625a3e4b0ea2464200ae7",startPosition:{geometry:{type:"Point",coordinates:[6.341079055648873,51.2066879919256]}},endPosition:{geometry:{type:"Point",coordinates:[6.44190291834726,51.168908501437144]}}},{id:"57762bbee4b0ea2464205e55",startPosition:{geometry:{type:"Point",coordinates:[6.341186284132805,51.2085027435569]}},endPosition:{geometry:{type:"Point",coordinates:[6.44138736,51.16827359999999]}}},{id:"57762c58e4b0ea24642079a2",startPosition:{geometry:{type:"Point",coordinates:[6.42331434,51.20978667]}},endPosition:{geometry:{type:"Point",coordinates:[6.399148392872492,51.19507302056138]}}},{id:"57762a41e4b0ea24642031e0",startPosition:{geometry:{type:"Point",coordinates:[6.441856331651936,51.16890650564406]}},endPosition:{geometry:{type:"Point",coordinates:[6.341219753487611,51.207880731394]}}},{id:"57762b1ce4b0ea246420423e",startPosition:{geometry:{type:"Point",coordinates:[6.341273290637881,51.20899849531894]}},endPosition:{geometry:{type:"Point",coordinates:[6.4359888,51.16962793]}}},{id:"57762c9de4b0ea24642088de",startPosition:{geometry:{type:"Point",coordinates:[6.423861360891669,51.20808345388015]}},endPosition:{geometry:{type:"Point",coordinates:[6.399175784540195,51.194994314991675]}}},{id:"57762b6de4b0ea2464204ff1",startPosition:{geometry:{type:"Point",coordinates:[6.441921792645587,51.168882615788775]}},endPosition:{geometry:{type:"Point",coordinates:[6.341322724171256,51.20897257836511]}}},{id:"57762893e4b0ea2464201aea",startPosition:{geometry:{type:"Point",coordinates:[6.399198250558042,51.19498226190518]}},endPosition:{geometry:{type:"Point",coordinates:[6.423321264860075,51.20976217535752]}}},{id:"57765c72e4b0ea246421551f",startPosition:{geometry:{type:"Point",coordinates:[6.493878360000454,51.2218940729999]}},endPosition:{geometry:{type:"Point",coordinates:[6.49122276,51.22202375]}}},{id:"57762ca1e4b0ea2464208edd",startPosition:{geometry:{type:"Point",coordinates:[6.3412258318562955,51.208212960839745]}},endPosition:{geometry:{type:"Point",coordinates:[6.408892027427136,51.15593728]}}},{id:"57754f30e4b0ea2464194633",startPosition:{geometry:{type:"Point",coordinates:[6.4940111370612925,51.22162397734701]}},endPosition:{geometry:{type:"Point",coordinates:[6.487146508153163,51.23435469663926]}}}],o=0;o<a.length;o++){var l=[],d=[];l[1]=a[o].startPosition.geometry.coordinates[0],l[0]=a[o].startPosition.geometry.coordinates[1],l[2]=1,n[0]+=l[1],n[1]+=l[0],d[1]=a[o].endPosition.geometry.coordinates[0],d[0]=a[o].endPosition.geometry.coordinates[1],d[2]=1,n[0]+=d[1],n[1]+=d[0],i.push(l),s.push(d),r.push(l),r.push(d)}console.log(r),n[0]=n[0]/(2*a.length),n[1]=n[1]/(2*a.length),console.log(n[0]),console.log(n[1]),e.center={lat:n[1],lng:n[0],zoom:6},e.layers.overlays={heat:{name:"Heat Map",type:"heat",data:r,layerOptions:{radius:20,blur:30,minopacity:0,maxZoom:8},visible:!0}},e.onload_heat_map=!0,console.log(e.layers.overlays),console.log(e.layers)}),angular.extend(e,{center:{},layers:{baselayers:{mapbox_light:{name:"Mapbox Light",url:"http://api.tiles.mapbox.com/v4/{mapid}/{z}/{x}/{y}.png?access_token={apikey}",type:"xyz",layerOptions:{apikey:"pk.eyJ1IjoibmF2ZWVuamFmZXIiLCJhIjoiY2lsYnVmamE0MDA1MXdnbHpvNGZianRuOCJ9.5KqDlJGBKr7ZF9Rdg6j_yQ",mapid:"naveenjafer.0n3ooo76"}},osm:{name:"OpenStreetMap",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz"}}}})}]),angular.module("app").controller("FriendListController",["$scope","$http","$rootScope","$stateParams","$state","requesthomestats",function(e,t,a,o,n,r){e.totalLoading=!0,e.showMoreFriends=!1,e.selectedIndex=2,t.defaults.headers.common={"X-User":a.globals.currentUser.username,"X-Token":a.globals.currentUser.authdata};var i;i=""==o.user?a.globals.currentUser.username:o.user,e.show_no_friends=!1,e.data_friends=[],e.data_friends_4=[];var s=[];url="https://envirocar.org/api/stable/users/"+i+"/friends",r.get(url).then(function(t){0==t.data.users.length&&(e.show_no_friends=!0);for(var a=t.data.users,o=0;o<a.length;o++){var n={};n.username=a[o].name,n.profile_url="https://envirocar.org/api/stable/users/"+n.username+"/avatar",s.push(n)}e.data_friends=s,e.data_friends_4=JSON.parse(JSON.stringify(s)).slice(0,3),e.remainingFriends=s.length-3,e.remainingFriends>0&&(e.showMoreFriends=!0,e.remainingFriends=e.remainingFriends.toString()+"+");for(var o=0;o<e.data_friends_4.length;o++)e.data_friends_4[o].profile_url="assets/images/profiledummy"+(o+1).toString()+".png";console.log(e.data_friends_4),e.totalLoading=!1}),e.goToFriend=function(e){console.log(e+"came to find friend"),n.go("home.dashboard",{user:e})},e.tabChangeToFriends=function(){a.tabNumber=2}}]),angular.module("app").controller("FriendGroupController",["$scope","$http","$rootScope","requesthomestats",function(){}]),angular.module("app").constant("friendactivity",{page_size:5,url_base:"https://envirocar.org/api/stable/users/",friend:"/friendActivities?",avatar:"/avatar"}).controller("FriendActivityController",["$scope","$http","$rootScope","$stateParams","$state","friendactivity",function(e,t,a,o,n,r){e.totalLoading=!0,e.fetchingResults=!1,e.show_no_my_activity=!1,e.originaluser=!1,e.events=[];var i=[];e.busy=!1,e.page=0,e.page_size=r.page_size,t.defaults.headers.common={"X-User":a.globals.currentUser.username,"X-Token":a.globals.currentUser.authdata};var s;if(""!=o.user)return e.originaluser=!1,void(s=o.user);e.originaluser=!0,s=a.globals.currentUser.username;var l=0;e.nextpage=function(){1==l&&(e.fetchingResults=!0),e.page++;var o=r.url_base+s+r.friend;t.get(o+"limit="+e.page_size+"&page="+e.page).success(function(t){0==t.activities.length&&(e.show_no_my_activity=!0,console.log("fired hide"));for(var o=0;o<t.activities.length;o++){var n={};if(n.time=t.activities[o].time,n.name=t.activities[o].user.name,n.profileurl=r.url_base+n.name+r.avatar,n.date=new Date(t.activities[o].time).toLocaleString(),console.log(t.activities[o]),n.color="#8CBF3F","FRIENDED_USER"==t.activities[o].type)n.type=0,n.topic="New Friend Activity",n.color="#0065A0",n.name=a.globals.currentUser.username!=t.activities[o].other.name?t.activities[o].user.name+" is now friends with "+t.activities[o].other.name:t.activities[o].user.name+" is now friends with you",n.trackidlink="",n.icon="people";else if("CREATED_TRACK"==t.activities[o].type)n.type=1,n.color="#0065A0",n.topic="New Track Upload",n.icon="add_circle",n.trackidlink=void 0!=t.activities[o].track?t.activities[o].track.id:"Invalid ID";else if("CHANGED_PROFILE"==t.activities[o].type)n.type=0,n.icon="update",n.topic=t.activities[o].user.name+"Updated profile";else{if("UNFRIENDED_USER"==t.activities[o].type)continue;"CREATED_GROUP"==t.activities[o].type?(n.type=0,n.icon="speaker_groups",n.topic=t.activities[o].user.name+" created a Group"):"CHANGED_GROUP"==t.activities[o].type?(n.type=0,n.icon="speaker_groups",n.topic=t.activities[o].user.name+" changed the group"):"JOINED_GROUP"==t.activities[o].type?(n.type=0,n.icon="group_add",n.topic=t.activities[o].user.name+" joined the Group"):"LEFT_GROUP"==t.activities[o].type?(n.type=0,n.topic=t.activities[o].user.name+" left the Group"):"DELETED_GROUP"==t.activities[o].type&&(n.type=0,n.topic=t.activities[o].user.name+" deleted the group")}i.push(n)}e.events=i,l=1,e.fetchingResults=!1,e.totalLoading=!1})},e.nextpage(e.page),e.goToActivity=function(e,t){1==e&&(console.log(t),n.go("home.chart",{trackid:t})),console.log("fired")}}]),angular.module("app").controller("ErrorController",["$scope","$stateParams",function(e,t){e.params=t.path,console.log(t.status+" IN ERROR CONTROLLER"),e.errorcodeparams="The server returned a "+t.status+" error.",console.log(t.path)}]),angular.module("app").constant("dashboard",{type:"user",comments:"Number of Tracks",color:"primary",url1:"https://envirocar.org/api/stable/users/",numberoftracks:5,urltracks:"https://envirocar.org/api/stable/tracks/",urlredirect:"#/dashboard/chart/",charttype:"multiBarHorizontalChart",chartheight:450,duration:300,yaxislabel:"Values",format:",.2f",urlusers:"https://envirocar.org/api/stable/users/",urlco2stats:"/statistics/CO2",textco2:"CO2(",urlspeedstats:"/statistics/Speed",textspeed:"Speed(",urlconsstats:"/statistics/Consumption",textcons:"Consumption(",urlengineloadstats:"/statistics/Engine Load",key1:"User Statistics",color1:"#d62728",urlcommonco2:"https://envirocar.org/api/stable/statistics/CO2",urlcommonspeed:"https://envirocar.org/api/stable/statistics/Speed",urlcommoncons:"https://envirocar.org/api/stable/statistics/Consumption",urlcommonengineload:"https://envirocar.org/api/stable/statistics/Consumption",key2:"Other User's Statistics",color2:"#1f77b4",loading_count:5}),angular.module("app").controller("DashboardController",["$scope","$http","$rootScope","$stateParams","requesthomestats","requestgraphstats","dashboard","$state","$translate",function(e,t,a,o,n,r,i,s){a.tabNumber=0,e.onloadSpeedPie=!1;var l={user:"naveen-gsoc",distance:3344.22,duration:50.2,statistics:{0:{distance:1610.2,duration:32.1},60:{distance:502.34,duration:7.1},130:{distance:400.56,duration:4}}};e.options_pie={chart:{type:"pieChart",height:250,x:function(e){return e.key},y:function(e){return e.y},showLabels:!0,duration:300,labelThreshold:.01,donut:!0,labelsOutside:!0,cornerRadius:0,donutRatio:.45,showLegend:!0,legendPosition:"top",tooltip:{contentGenerator:function(e){var t="<h3><b>"+e.data.key+"</b> - "+e.data.y.toFixed(2)+"%</h3>";
return console.log(e),t}}}},e.speedPieOptions=["Distance","Time"],e.pieSpeedRanges="Distance";var d={Distance:[{key:"0-60 Km/h",y:100*l.statistics[0].distance/(l.statistics[0].distance+l.statistics[60].distance+l.statistics[130].distance)},{key:"61-130 Km/h",y:100*l.statistics[60].distance/(l.statistics[0].distance+l.statistics[60].distance+l.statistics[130].distance)},{key:">130Km/Hr",y:100*l.statistics[130].distance/(l.statistics[0].distance+l.statistics[60].distance+l.statistics[130].distance)}],Time:[{key:"0-60 Km/h",y:l.statistics[0].duration},{key:"61-130 Km/h",y:l.statistics[60].duration},{key:">130Km/Hr",y:l.statistics[130].duration}]};e.dataSpeedPie=d[e.pieSpeedRanges],e.onloadSpeedPie=!0,e.changePhenomenonPieSpeed=function(t){console.log(t),e.pieSpeedRange=t,e.dataSpeedPie=d[t],console.log(e.dataSpeedPie)};var c=0;e.onload_user_vs_public=!1,e.onload_speed_ranges=!1,e.onload_tracks_timeline=!1,e.loading=!0,e.goToActivity=function(e){console.log("came here"),s.go("home.chart",{trackid:e}),console.log("fired")},e.visible=!1,e.events=[];var m=[];e.trial="Further comparision insights on the way :)",e.type=i.type,e.comments=i.comments,e.colour=i.color;var p,g=i.url1;p=""==o.user?a.globals.currentUser.username:o.user,e.username=p,g=g+p+"/tracks",t.defaults.headers.common={"X-User":a.globals.currentUser.username,"X-Token":a.globals.currentUser.authdata};var u={};console.log(g),n.get(g).then(function(t){e.number=t.data.tracks.length;var a=0;a=e.number>=i.numberoftracks?i.numberoftracks:e.number;for(var o=0;a>o;o++)!function(e){var a={};a.car=t.data.tracks[e].sensor.properties.model,a.manufacturer=t.data.tracks[e].sensor.properties.manufacturer,a.id=t.data.tracks[e].id,a.title=t.data.tracks[e].name,a.urlredirect=i.urlredirect+t.data.tracks[e].id,a.url=i.urltracks+t.data.tracks[e].id+"/preview";var o=new Date(t.data.tracks[e].end).getTime()-new Date(t.data.tracks[e].begin).getTime(),n=o/1e3;date_for_seconds=new Date(null),date_for_seconds.setSeconds(n),date_hh_mm_ss=date_for_seconds.toISOString().substr(11,8),a.travelTime=date_hh_mm_ss,a.begin=new Date(t.data.tracks[e].begin),a.distance=void 0!=t.data.tracks[e].length?t.data.tracks[e].length.toFixed(2):"NA",a.side=e%2==0?"left":"left",m.push(a)}(o);e.timelinevalues=u,e.onload_tracks_timeline=!0,window.dispatchEvent(new Event("resize"))}),e.events=m,e.options={chart:{type:i.charttype,height:i.chartheight,x:function(e){return e.label},y:function(e){return e.value},showControls:!1,showValues:!0,duration:i.duration,xAxis:{showMaxMin:!0,rotatelabels:-90},yAxis:{axisLabel:i.yaxislabel,tickFormat:function(e){return d3.format(i.format)(e)}}}};var h,v;e.optionsSpeed={chart:{type:"discreteBarChart",height:260,margin:{top:10,right:0,bottom:70,left:50},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:500,xAxis:{axisLabel:"User vs Public "},yAxis:{axisLabel:"Speed(Km/Hr)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){console.log(e);var t="<h3><b>"+e.data.label+"</b> = "+e.data.value.toFixed(2)+"</h3>";return t}}}};var f;e.optionsConsumption={chart:{type:"discreteBarChart",height:260,margin:{top:10,right:0,bottom:80,left:30},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:500,xAxis:{axisLabel:"User vs Public "},yAxis:{axisLabel:"Consumption(l/Hr)",axisLabelDistance:-30}}};var y;e.optionsCO2={chart:{type:"discreteBarChart",height:260,margin:{top:10,right:0,bottom:80,left:30},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:500,xAxis:{axisLabel:"User vs Public "},yAxis:{axisLabel:"CO2(Kg/Hr)",axisLabelDistance:-30}}};var b;e.optionsEngineload={chart:{type:"discreteBarChart",height:260,margin:{top:10,right:0,bottom:80,left:30},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:500,xAxis:{axisLabel:"User vs Public "},yAxis:{axisLabel:"EngineLoad(%)",axisLabelDistance:-30}}},e.barchartoptions=["Speed","Consumption","CO2"],e.barchartshowing="Speed",e.changePhenomenonbar=function(t){e.barchartshowing=t,e.dataoverall=[],"Speed"==t?(e.optionsSpeed.chart.yAxis.axisLabel="Speed (Km/h)",e.dataoverall=e.dataSpeed):"Consumption"==t?(e.optionsSpeed.chart.yAxis.axisLabel="Consumption (l/h)",e.dataoverall=e.dataConsumption):"CO2"==t&&(e.optionsSpeed.chart.yAxis.axisLabel="CO2 (Kg/h)",e.dataoverall=e.dataCO2)},e.dataoverall,e.dataConsumption,e.dataCO2,e.dataSpeed,e.dataEngineload;var k=[],w=i.urlusers+p+i.urlco2stats;r.get(w).then(function(t){y=t.data.avg,w=i.urlcommonco2,r.get(w).then(function(t){e.dataCO2=[{key:"Cumulative Return",values:[{label:"User",value:y},{label:"Public",value:t.data.avg}]}],c++})}),w=i.urlusers+p+i.urlspeedstats,r.get(w).then(function(t){var a=t.data;h=a.avg,w=i.urlcommonspeed,r.get(w).then(function(t){var a=t.data;v=a.avg,e.dataSpeed=[{key:"Cumulative Return",values:[{label:"User",value:h},{label:"Public",value:v}]}],e.dataoverall=e.dataSpeed,k.push(t),e.onload_user_vs_public=!0,window.dispatchEvent(new Event("resize"))})}),w=i.urlusers+p+i.urlconsstats,r.get(w).then(function(t){f=t.data.avg,w=i.urlcommoncons,r.get(w).then(function(t){e.loading=!1,e.dataConsumption=[{key:"Cumulative Return",values:[{label:"User",value:f},{label:"Public",value:t.data.avg}]}],c++,c==i.loading_count&&(e.onload=!0,window.dispatchEvent(new Event("resize")))})}),w=i.urlusers+p+i.urlengineloadstats,r.get(w).then(function(t){b=t.data.avg,w=i.urlcommonengineload,r.get(w).then(function(t){e.loading=!1,e.dataEngineload=[{key:"Cumulative Return",values:[{label:"User",value:b},{label:"Public",value:t.data.avg}]}],c++,c==i.loading_count&&(e.onload=!0,window.dispatchEvent(new Event("resize")))})}),e.visible=!0}]),angular.module("app").factory("requesthomestats",["$http",function(e){var t=function(t){return e.get(t).success(function(e){return e})};return{get:t}}]),angular.module("app").factory("requestgraphstats",["$http",function(e){var t=function(t){return e.get(t).success(function(e){return e})};return{get:t}}]),angular.module("app").constant("chart",{chart1type:"pieChart",chart1height:300,chart1duration:300,chart1legend:{margin:{top:5,right:35,bottom:5,left:0}},chart2type:"lineWithFocusChart",chart2height:420,chart2margin:{top:20,right:20,bottom:10,left:60},chart2xlabel:"Time",chart2ylabel:"Values",piechartselected:"Speed",piechartsdata:{Speed:[0,0,0,0,0,0],"Calculated MAF":[0,0,0,0,0,0],"Engine Load":[0,0,0,0,0,0],Consumption:[0,0,0,0,0,0],"Intake Temperature":[0,0,0,0,0,0]},piechartsdatareplace:{Speed:[0,0,0,0,0,0],MAF:[0,0,0,0,0,0],"Engine Load":[0,0,0,0,0,0],Consumption:[0,0,0,0,0,0],"Intake Temperature":[0,0,0,0,0,0]},legendtable_all:{Speed:["0-30 Km/h","30-60 Km/h","60-90 Km/h","90-120 Km/h","120-150 Km/h",">150 Km/h"],"Calculated MAF":["0-5 g/sec","5-10 g/sec","10-15 g/sec","15-20 g/sec","20-25 g/sec",">25 g/sec"],"Engine Load":["0-20 %","20-40 %","40-60 %","60-80 %","80-100 %",">100 %"],MAF:["0-5 g/sec","5-10 g/sec","10-15 g/sec",0/0,"20-25 g/sec",">25 g/sec"],Consumption:["0-4 l/h","4-8 l/h","8-12 l/h","12-16 l/h","16-20 l/h",">20 l/h"],"Intake Temperature":["0-10 °C","10-20 °C","20-30 °C","30-40 °C","40-50 °C","> 50 °C"]},rangeobjects:{Speed:[[0,30,60,90,120,150]],"Calculated MAF":[[0,5,10,15,20,25]],"Engine Load":[[0,20,40,50,70,90]],Consumption:[[0,4,8,12,16,20]],"Intake Temperature":[[0,10,20,30,40,50]]},rangeobjectsreplace:{Speed:[[0,30,60,90,120,150]],MAF:[[0,5,10,15,20,25]],"Engine Load":[[0,20,40,50,70,90]],Consumption:[[0,4,8,12,16,20]],"Intake Temperature":[[0,10,20,30,40,50]]},numberofranges:5,phenoms:["Speed","Calculated MAF","Engine Load","Consumption","Intake Temperature"],phenomsreplace:["Speed","MAF","Engine Load","Consumption","Intake Temperature"],urlusers:"https://envirocar.org/api/stable/users/",urlbase:"https://envirocar.org/api/stable/tracks/",colors:["#0065A0","#ffbf00","#00cc00","#440044","#ff3300"],m1message:"Start Point",m2message:"End Point",colorsl:["#1BE01B","#B5E01B","#E0C61B","#E08B1B","#E01B1B","#9c1313"],phenomenonleaflet:"Speed"}),angular.module("app").controller("ChartController",["$state","$scope","$http","$rootScope","$timeout","$stateParams","factorysingletrack","chart","$location","requestgraphstats","leafletBoundsHelpers","dashboard",function(e,t,a,o,n,r,i,s,l,d,c,m){function p(e,a,o){for(var n=0;P>n;n++){if(0==n&&1==o){var r={};r.lat=e.data.features[0].geometry.coordinates[1],r.lng=e.data.features[0].geometry.coordinates[0],r.focus=!0,r.draggable=!1,r.message=s.m1message,t.markers.m1=r,u=e.data.features[0].geometry.coordinates[1],h=e.data.features[0].geometry.coordinates[0]}if(n>=1){var i="p",l=(String(i+(n+1)),{});if(e.data.features[n-1].properties.phenomenons[a])for(var d=s.numberofranges;d>=0;d--)if(e.data.features[n-1].properties.phenomenons[a].value>=I[a][0][d]){l.color=O[d];break}l.weight=8,l.latlngs=[{lat:e.data.features[n-1].geometry.coordinates[1],lng:e.data.features[n-1].geometry.coordinates[0]},{lat:e.data.features[n].geometry.coordinates[1],lng:e.data.features[n].geometry.coordinates[0]}],l.message='<div style="color:#0065A0;width:120px"><p style="font-size:10px;"><b>Speed: </b>'+e.data.features[n-1].properties.phenomenons.Speed.value.toFixed(2)+" "+e.data.features[n-1].properties.phenomenons.Speed.unit+'</p><p style="font-size:10px;"><b>Consumption: </b>'+(void 0!=e.data.features[n-1].properties.phenomenons.Consumption?e.data.features[n-1].properties.phenomenons.Consumption.value.toFixed(2):"NA")+" "+(void 0!=e.data.features[n-1].properties.phenomenons.Consumption?e.data.features[n-1].properties.phenomenons.Consumption.unit:"NA")+'</p><p style="font-size:10px;"><b>CO2: </b>'+(void 0!=e.data.features[n-1].properties.phenomenons.CO2?e.data.features[n-1].properties.phenomenons.CO2.value.toFixed(2):"NA")+" "+(void 0!=e.data.features[n-1].properties.phenomenons.CO2?e.data.features[n-1].properties.phenomenons.CO2.unit:"NA")+"</div>",t.paths["p"+n]=l}if(n==P-1&&1==o){var c={};c.lat=e.data.features[n].geometry.coordinates[1],c.lng=e.data.features[n].geometry.coordinates[0],c.focus=!1,c.draggable=!1,c.message=s.m2message,t.markers.m2=c}}}t.widget=[{id:"line",title:"Line"},{id:"spline",title:"Smooth line"},{id:"area",title:"Area"},{id:"areaspline",title:"Smooth area"}],t.widgetType1="Speed",t.widgetType2="Speed",t.widgetType3="Speed",t.onload_leaflet=!1,t.onload_nvd3line=!1,t.onload_nvd3pie=!1,t.onload_nvd3_user_vs_public=!1,t.onload_summary=!1,t.loading=!0,t.barchartoptions=["Speed","Consumption","CO2"],"undefined"==typeof o.globals.currentUser?(o.url_redirect_on_login=l.path(),console.log("in if"),o.showlogout=!1):(console.log("in else"),o.showlogout=!0),console.log("came to chart controller"),t.options_pie={chart:{type:s.chart1type,height:s.chart1height+50,x:function(e){return e.key},y:function(e){return e.y},showLabels:!0,duration:s.chart1duration,labelThreshold:0,donut:!0,donutLabelsOutside:!0,cornerRadius:0,donutRatio:.45,legend:s.chart1legend,tooltip:{contentGenerator:function(e){var t="<h3><b>"+e.data.key+"</b> - "+e.data.y.toFixed(2)+"%</h3>";return console.log(e),t}}}},t.optionsSpeed={chart:{type:"discreteBarChart",height:260,margin:{top:40,right:0,bottom:40,left:50},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:500,xAxis:{axisLabel:"User vs Public "},yAxis:{axisLabel:"Speed(Km/Hr)",axisLabelDistance:-20},tooltip:{contentGenerator:function(e){console.log(e);var t="<h3><b>"+e.data.label+"</b> = "+e.data.value.toFixed(2)+"</h3>";return t}}}},t.data_pie=[],t.options={chart:{type:s.chart2type,height:s.chart2height,margin:s.chart2margin,x:function(e){return e[0]},y:function(e){return e[1]},showLegend:!1,useInteractiveGuideline:!1,interactive:!0,tooltip:{contentGenerator:function(e){var a=new Date(e.value),o="<h4>"+a.toLocaleString()+"</h4> <ul>";return t.trailchange(e.pointIndex),e.series.forEach(function(e){o+="<li><h3 style='color:"+e.color+"'>"+e.key+": <b>"+e.value.toFixed(1)+"</b></h3> </li>"}),o+="</ul>"}},xAxis:{axisLabel:s.chart2xlabel,showMaxMin:!1,tickFormat:function(e){var t=d3.time.format("%H:%M:%S");return t(new Date(e))}},x2Axis:{showMaxMin:!1,tickFormat:function(e){var t=d3.time.format("%H:%M:%S");return t(new Date(e))}},yAxis:{axisLabel:s.chart2ylabel,tickFormat:function(e){return d3.format(",.1f")(e)}},y2Axis:{tickFormat:function(e){return d3.format(",.1f")(e)}}}};var g=c.createBoundsFromArray([[51.508742458803326,-.087890625],[51.508742458803326,-.087890625]]);angular.extend(t,{center:{},bounds:g,paths:{},markers:{},controls:{custom:[]},legend:{}}),t.trailchange=function(e){console.log(R),console.log(t.paths),t.markers.nvd3pointer={},t.markers.nvd3pointer={lat:R.data.features[e].geometry.coordinates[1],lng:R.data.features[e].geometry.coordinates[0],focus:!1,message:"Current Location"},console.log(t.markers)},t.trackid,t.name,t.created;var u,h;t.tracksummary_c_e={fuelperhour:0,co2emission:0},t.legend={position:"bottomleft",colors:s.colorsl,labels:s.legendtable_all.Speed},t.legendtable=s.legendtable_all.Speed;var v,f,y,b,k,w,P,_,S,x,T=0,C=0,E=0,D={},O=s.colorsl;t.piechartselected=s.piechartselected,t.phenomenonleaflet=s.phenomenonleaflet;var A,N=JSON.parse(JSON.stringify(s.piechartsdata)),I=s.rangeobjects,R={};t.changePhenomenon=function(e){console.log(e),console.log("changed"),console.log(t.paths),p(R,e,0),t.legendtable=[],t.legendtable=s.legendtable_all[e],console.log(t.legend),t.legend.labels=s.legendtable_all[e],console.log(t.legend),t.legend={},console.log(t.legend),console.log(t.phenomenonleaflet),console.log("end of changePhenomenon"),t.legend={position:"bottomleft",colors:s.colorsl,labels:s.legendtable_all[e]}};var F=[];t.phenomenonnvd3="Speed",t.selected=["Speed"],t.exists=function(e,t){return t.indexOf(e)>-1},t.toggle=function(e,a){console.log("came here"),console.log(t.selected);var o=a.indexOf(e);o>-1?a.splice(o,1):a.push(e),console.log(t.selected),t.data=[];for(var n=[],r=0;r<t.selected.length;r++)for(var i=0;i<F.length;i++)F[i].key==t.selected[r]&&n.push(F[i]);t.data=n},t.changePhenomenonnvd3=function(){console.log(t.phenomenonnvd3)},t.performancePeriod="week",t.selecteditemchanged=function(e){console.log("fired");for(var a={},o=0;o<=s.numberofranges;o++){a.y=N[e][o]/P*100;var n;n=o!=s.numberofranges?I[e][0][o]+"-"+I[e][0][o+1]+" "+I[e][1]:"> "+I[e][0][o]+" "+I[e][1],a.key=n,t.data_pie[o]=a,a={}}};var L=s.urlusers;"undefined"==typeof o.globals.currentUser?(console.log("came to if"),L=s.urlbase+r.trackid,t.trackid=r.trackid,console.log("here")):(console.log("came to else"),L=L+o.globals.currentUser.username+"/tracks/",a.defaults.headers.common={"X-User":o.globals.currentUser.username,"X-Token":o.globals.currentUser.authdata},L+=r.trackid),t.dataoverall,t.dataConsumption,t.dataCO2,t.dataSpeed,t.dataEngineload,t.consumption100Km,t.co2gKm;var U,M=m.urltracks+r.trackid+m.urlco2stats;d.get(M).then(function(e){console.log(e.data),U=e.data.avg,M=m.urlcommonco2,console.log(M),d.get(M).then(function(e){console.log(e.data),console.log("COME IN"),t.dataCO2=[{key:"Cumulative Return",values:[{label:"User",value:U},{label:"Public",value:e.data.avg}]}]})}),M=m.urltracks+r.trackid+m.urlspeedstats;var $;d.get(M).then(function(e){console.log(e.data);var a=e.data;$=a.avg,M=m.urlcommonspeed,console.log(M),console.log("came here"),d.get(M).then(function(e){console.log(e.data);var a=e.data;speed_public=a.avg,console.log("came here in 442"),t.dataSpeed=[{key:"Cumulative Return",values:[{label:"User",value:$},{label:"Public",value:speed_public}]}],t.dataoverall=t.dataSpeed})}),M=m.urltracks+r.trackid+m.urlconsstats;var V;d.get(M).then(function(e){console.log(e.data),V=e.data.avg,M=m.urlcommoncons,console.log(M),d.get(M).then(function(e){console.log(e.data),t.loading=!1,t.dataConsumption=[{key:"Cumulative Return",values:[{label:"User",value:V},{label:"Public",value:e.data.avg}]}],t.onload_nvd3_user_vs_public=!0})}),t.changePhenomenonbar=function(e){console.log("came here"),t.dataoverall=[],"Speed"==e?(console.log(t.optionsSpeed.chart.yAxis.axisLabel),t.optionsSpeed.chart.yAxis.axisLabel="Speed (Km/h)",t.dataoverall=t.dataSpeed):"Consumption"==e?(t.optionsSpeed.chart.yAxis.axisLabel="Consumption (l/h)",t.dataoverall=t.dataConsumption):"CO2"==e&&(t.optionsSpeed.chart.yAxis.axisLabel="CO2 (Kg/h)",t.dataoverall=t.dataCO2)},i.get(L).then(function(a){function o(e,a){if(0==e){console.log(b.length+"length of keys");for(var o=0;o<b.length;o++)D[b[o]]=a.features[e].properties.phenomenons[b[o]].unit;return t.travel_distance=a.properties.length.toFixed(2),v=a.properties.sensor.properties.model,f=a.properties.sensor.type,y=a.properties.sensor.properties.manufacturer,console.log(C+" "+v+" "+f),void console.log(D)}}if(t.piechartselected=t.widgetType2,console.log("***********"+t.piechartselected),a.status>300)console.log("getting a bad request"),t.error=a.data,e.go("home.error",{path:a.data,status:a.status});else{_=Object.keys(a.data.features[0].properties.phenomenons),console.log(_);var n=s.phenoms,r=s.colors,l=Object.keys(I);console.log(l),console.log(_),_.indexOf("MAF")>=0&&(I=s.rangeobjectsreplace,n=s.phenomsreplace,N=JSON.parse(JSON.stringify(s.piechartsdatareplace)));for(var d=0;5>d;d++)_.indexOf(l[d])<0&&(delete r[l[d]],delete I[l[d]],delete N[l[d]],console.log("SHOUDL NOT HAVE COME HERE"),console.log(l[d]));n=Object.keys(I),console.log(n),console.log(I),console.log(r),t.trackid=a.data.properties.id,t.name=a.data.properties.name,t.created=new Date(a.data.properties.created),console.log("coming here too but"),console.log(a),R=a;var c=a.data.properties.length;P=a.data.features.length,t.piechartoptions=n;for(var m=0;m<n.length;m++){0==m&&(b=Object.keys(a.data.features[0].properties.phenomenons),b.includes("Calculated MAF")&&console.log("Swapped with replace"));for(var g=[],d=0;P>d;d++){var u;!function(e){if(0==m){if(0==e){var l=a.data.properties.length,d=a.data.features[0].properties.time,c=a.data.features[P-1].properties.time,p=new Date(c).getTime()-new Date(d).getTime(),h=p/1e3;E=h/60,A=new Date(null),A.setSeconds(h),S=A.toISOString().substr(11,8),k=d,w=c,i.get(L+"/statistics/Consumption").then(function(e){if(console.log(e),void 0!=e.data.avg){var a=e.data.avg.toFixed(2),o=new Date(w).getTime()-new Date(k).getTime();console.log(o);var n=(100*a*(o/36e5)/l).toFixed(2);n=n.toString()+" L/100 Km",t.consumption100Km=n,console.log(t.tracksummary_c_e)}else t.consumption100Km="NA"}),i.get(L+"/statistics/CO2").then(function(e){if(console.log(e),void 0!=e.data.avg){var a=e.data.avg.toFixed(2),o=new Date(w).getTime()-new Date(k).getTime();console.log(o);var n=(1e3*a*(o/36e5)/l).toFixed(2);n=n.toString()+" g/Km",t.co2gKm=n,console.log(t.tracksummary_c_e),console.log(n)}else t.co2gKm="NA"})}o(e,a.data)}0==e&&(console.log(a.data.features[e].properties.phenomenons),console.log(n[m]),I[n[m]][1]=a.data.features[e].properties.phenomenons[n[m]].unit);var v=new Date(a.data.features[e].properties.time),f=v.getTime();if(a.data.features[e].properties.phenomenons[n[m]]){for(var y=a.data.features[e].properties.phenomenons[n[m]].value,b=s.numberofranges;b>=0;b--)if(y>=I[n[m]][0][b]){N[n[m]][b]++;break}}else var y=0;g.push([f,y]),u={key:n[m],values:g,color:r[m]}}(d)}if(t.onload_summary=!0,n[m]==t.piechartselected)for(var h={},d=0;d<=s.numberofranges;d++){h.y=100*N[t.piechartselected][d]/P;var O;O=d!=s.numberofranges?I[t.piechartselected][0][d]+"-"+I[t.piechartselected][0][d+1]+" "+I[t.piechartselected][1]:"> "+I[t.piechartselected][0][d]+" "+I[t.piechartselected][1],h.key=O,t.data_pie[d]=h,h={}}F.push(u)}t.onload_nvd3line=!0,t.onload_nvd3pie=!0;for(var U=[],M=0;M<F.length;M++)F[M].key==t.widgetType2&&(U.push(F[M]),t.data=U,console.log("phenomset"));console.log(F),p(a,"Speed",1)}t.markers.m1.lng>t.markers.m2.lng?(t.bounds.northEast.lng=t.markers.m1.lng+.01,t.bounds.southWest.lng=t.markers.m2.lng-.01,t.markers.m1.lat>t.markers.m2.lat?(t.bounds.northEast.lat=t.markers.m1.lat+.01,t.bounds.southWest.lat=t.markers.m2.lat-.01):(t.bounds.northEast.lat=t.markers.m2.lat+.01,t.bounds.southWest.lat=t.markers.m1.lat-.01)):(t.bounds.northEast.lng=t.markers.m2.lng+.01,t.bounds.southWest.lng=t.markers.m1.lng-.01,t.markers.m1.lat>t.markers.m2.lat?(t.bounds.northEast.lat=t.markers.m1.lat+.01,t.bounds.southWest.lat=t.markers.m2.lat-.01):(t.bounds.northEast.lat=t.markers.m2.lat+.01,t.bounds.southWest.lat=t.markers.m1.lat-.01)),console.log(t.bounds),console.log(t.markers),t.center.zoom=Math.round(20/Math.pow(c,1.5)+9),t.onload_leaflet=!0,t.tracksummary={distance:C.toFixed(2),vehiclemodel:v,vehicletype:f,vehiclemanufacturer:y,unitsspeed:D.Speed,timeoftravel:S,unitsofdistance:"Km",unitsoftime:"Minutes",fuel:T.toFixed(2),co2emissionperhour:x,starttime:new Date(k).toLocaleString(),endtime:new Date(w).toLocaleString()},console.log(t.tracksummary),t.loading=!1,console.log(t.loading)})}]),angular.module("app").factory("factorysingletrack",["$http",function(e){console.log("called so many times");var t=function(t){return e.get(t).then(function(e){return e},function(e){return e})};return{get:t}}]),angular.module("app").constant("calendar",{monthNumberMapping:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},urlUsers:"https://envirocar.org/api/stable/users/",urlTracks:"https://envirocar.org/api/stable/tracks/"}).controller("CalendarController",["$scope","$mdDialog","$mdMedia","$stateParams","$filter","$http","$state","$rootScope","tracks_calendar","calendar","MaterialCalendarData",function(e,t,a,o,n,r,i,s,l,d,c){function m(e,t,a,o){e.onload=!1,e.currenttrack=o;var n,r,i,s=d.urlUsers+g+"/tracks/"+o.id;l.get(s).then(function(t){i=t.data.properties.length,e.currenttrack.manufacturer=t.data.properties.sensor.properties.manufacturer,e.currenttrack.model=t.data.properties.sensor.properties.model,e.currenttrack.start=new Date(t.data.features[0].properties.time).toLocaleString(),e.currenttrack.end=new Date(t.data.features[t.data.features.length-1].properties.time).toLocaleString(),n=t.data.features[0].properties.time,r=t.data.features[t.data.features.length-1].properties.time,l.get(s+"/statistics/Consumption").then(function(t){if(void 0!=t.data.avg){e.currenttrack.consumption_avg=t.data.avg.toFixed(2);var a=new Date(r).getTime()-new Date(n).getTime();e.currenttrack.consumption100Km=(100*e.currenttrack.consumption_avg*(a/36e5)/i).toFixed(2),e.currenttrack.consumption100Km=e.currenttrack.consumption100Km.toString()+" L/100 Km"}else e.currenttrack.consumption100Km="NA";e.onload=!0}),l.get(s+"/statistics/CO2").then(function(t){if(void 0!=t.data.avg){e.currenttrack.co2_avg=t.data.avg.toFixed(2);var a=new Date(r).getTime()-new Date(n).getTime();e.currenttrack.co2gKm=(1e3*e.currenttrack.co2_avg*(a/36e5)/i).toFixed(2),e.currenttrack.co2gKm=e.currenttrack.co2gKm.toString()+"  g/Km"}else e.currenttrack.co2gKm="NA";e.onload=!0,e.currenttrack.co2_avg=void 0!=t.data.avg?t.data.avg.toFixed(2):"NA",e.onload=!0})}),l.get(s+"/statistics/Speed").then(function(t){e.currenttrack.speed_avg=t.data.avg.toFixed(2)}),e.currenttrack.url=d.urlTracks+o.id+"/preview",e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(e){t.hide(e)},e.redirect=function(e){t.hide(),a.go("home.chart",{trackid:e})}}function p(e){for(var t=0;t<e.tracks.length;t++){var a=e.tracks[t].begin,o=new Date(a),n=o.toString(),r=n.split(" "),i=r[0]+r[1]+r[2];c.setDayContent(o,'<i class="material-icons">directions_car</i><span>'+y[i]+"</span>")}}m.$inject=["$scope","$mdDialog","$state","currenttrack"],e.buttonClickCurrentDate=function(){e.selectedDate=new Date,e.dayClick(new Date)};var g;g=""==o.user?s.globals.currentUser.username:o.user,e.no_data=!1,e.tracks=[];e.nostatistics=!0,e.onload=!0,e.total_tracks,e.total_time,e.total_distance,e.track;var u=d.monthNumberMapping;e.currenttrack={},e.showAdvanced=function(o,n){e.tt_isOpen=!1,e.currenttrack={},e.currenttrack.id=n,e.track=n;var r=(a("sm")||a("xs"))&&e.customFullscreen;t.show({controller:m,templateUrl:"app/views/dialog1.tmpl.html",parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,locals:{currenttrack:e.currenttrack},fullscreen:r}).then(function(t){e.status='You said the information was "'+t+'".'},function(){e.status="You cancelled the dialog."}),e.$watch(function(){return a("xs")||a("sm")},function(t){e.customFullscreen=t===!0})},r.defaults.headers.common={"X-User":s.globals.currentUser.username,"X-Token":s.globals.currentUser.authdata},e.selectedDate=null,e.firstDayOfWeek=0,e.setDirection=function(t){e.direction=t},e.dayClick=function(t){function a(e,t){for(var a=[],o=-1;-1!=(o=e.indexOf(t,o+1));)a.push(o);return a}e.no_data=!1,e.tracks=[];var o=[];e.msg="You clicked "+n("date")(t,"MMM d, y h:mm:ss a Z");var r=t.toString(),i=r.split(" "),s=i[0]+i[1]+i[2];if(f.indexOf(s)>=0){e.no_data=!0;for(var l=a(f,s),c=0;c<l.length;c++){var m={};m.car=h.tracks[l[c]].sensor.properties.model,m.id=h.tracks[l[c]].id,m.name=h.tracks[l[c]].name,m.manufacturer=h.tracks[l[c]].sensor.properties.manufacturer,m.begin=new Date(h.tracks[l[c]].begin).toLocaleString(),m.url=d.urlTracks+h.tracks[l[c]].id+"/preview",m.length=h.tracks[l[c]].length.toFixed(2);var p=new Date(h.tracks[l[c]].end).getTime()-new Date(h.tracks[l[c]].begin).getTime(),g=p/1e3;date_for_seconds=new Date(null),date_for_seconds.setSeconds(g),date_hh_mm_ss=date_for_seconds.toISOString().substr(11,8),m.travelTime=date_hh_mm_ss,o.push(m)}e.tracks=o}};var h;e.prevMonth=function(t){var a=u[t.month]+t.year.toString();p(h);for(var o=0,n=0,r=0,i=0;i<h.tracks.length;i++){var s=h.tracks[i].begin,l=new Date(s),d=l.toString(),c=d.split(" "),m=c[1]+c[3];m==a&&(o++,n+=h.tracks[i].length,r+=new Date(h.tracks[i].begin).getTime()-new Date(h.tracks[i].end).getTime())}var g=new Date(null);g.setSeconds(r/1e3);var v=g.toISOString().substr(11,8);e.total_tracks=o,e.total_time=v,e.total_distance=n.toFixed(2),e.nostatistics=0==o?!0:!1},e.nextMonth=function(t){e.msg="You clicked (next) month "+t.month+", "+t.year,p(h);for(var a=u[t.month]+t.year.toString(),o=0,n=0,r=0,i=0;i<h.tracks.length;i++){var s=h.tracks[i].begin,l=new Date(s),d=l.toString(),c=d.split(" "),m=c[1]+c[3];m==a&&(o++,n+=h.tracks[i].length,r+=new Date(h.tracks[i].begin).getTime()-new Date(h.tracks[i].end).getTime())}var g=new Date(null);g.setSeconds(r/1e3);var v=g.toISOString().substr(11,8);e.total_tracks=o,e.total_time=v,e.total_distance=n.toFixed(2),e.nostatistics=0==o?!0:!1};url=d.urlUsers+g+"/tracks?limit=10000";var v=[],f=[],y={};l.get(url).then(function(t){var a=new Date,o=a.toString().split(" ")[1]+a.toString().split(" ")[3];h=t.data;for(var n=0;n<h.tracks.length;n++){var r=h.tracks[n].begin,i=new Date(r),s=i.toString(),l=s.split(" "),d=l[0]+l[1]+l[2];void 0!=y[d]?y[d]++:y[d]=1,f.push(d),v.push(i.toString())}p(h);for(var c=0,m=0,g=0,n=0;n<h.tracks.length;n++){var r=h.tracks[n].begin,i=new Date(r),s=i.toString(),l=s.split(" "),d=l[1]+l[3];d==o&&(m++,g+=h.tracks[n].length,c+=new Date(h.tracks[n].begin).getTime()-new Date(h.tracks[n].end).getTime())}var u=new Date(null);u.setSeconds(c/1e3);var b=u.toISOString().substr(11,8);e.total_tracks=m,e.total_time=b,e.total_distance=g.toFixed(2),e.nostatistics=0==m?!0:!1,e.onload=!1}),e.tooltips=!0,e.setDayContent=function(){return"<p></p>"},e.goToActivity=function(e){i.go("home.chart",{trackid:e})}}]),angular.module("app").factory("tracks_calendar",["$http",function(e){var t=function(t){return e.get(t).success(function(e){return e})};return{get:t}}]),angular.module("angularMaterialAdmin",["ngAnimate","ngCookies","ngSanitize","ui.router","ngMaterial","nvd3","pascalprecht.translate","angular-timeline","infinite-scroll","angularUtils.directives.dirPagination","angular-loading-bar","ui-leaflet","materialCalendar","app","rzModule","ui.calendar","md.chips.select","ngGeolocation","angular-tour"]).config(["$stateProvider","$urlRouterProvider","$mdThemingProvider","$mdIconProvider",function(e,t,a,o){e.state("login",{url:"/login",templateUrl:"app/views/login.html",controller:"LoginController",data:{title:"Login"},authenticate:!1}).state("home",{url:"/dashboard",templateUrl:"app/views/main.html",controller:"MainController",controllerAs:"vm","abstract":!0,authenticate:!0}).state("home.dashboard",{url:"/home/:user",templateUrl:"app/views/dashboard.html",data:{title:"Dashboard"},authenticate:!0}).state("home.tracks",{url:"/tracks/:user",templateUrl:"app/views/tracks.html",data:{title:"Tracks"},authenticate:!0}).state("home.table",{url:"/table",templateUrl:"app/views/profile.html",data:{title:"Table"},authenticate:!0}).state("home.chart",{url:"/chart/:trackid",templateUrl:function(e){return"app/views/chart.html?path="+e.trackid},authenticate:!1,data:{title:"Chart"}}).state("home.error",{templateUrl:function(e){return"app/views/error.html?path="+e.path+"&status="+e.status},url:"/errorpage/:path/:status",authenticate:!0}).state("home.segment",{url:"/segment",templateUrl:"app/views/segment.html",data:{title:"Segment"},authenticate:!0}),t.otherwise("/dashboard/home/"),a.theme("default").primaryPalette("blue",{"default":"800"}).accentPalette("green",{"default":"500"}).warnPalette("defaultPrimary"),a.theme("dark","default").primaryPalette("defaultPrimary").dark(),a.theme("blue","default").primaryPalette("blue"),a.theme("custom","default").primaryPalette("defaultPrimary",{"hue-1":"900"}).backgroundPalette("blue",{"default":"900"}).accentPalette("blue",{"default":"900"}),a.definePalette("blue",{50:"#FFFFFF",100:"rgb(255, 198, 197)",200:"#E75753",300:"#E75753",400:"#E75753",500:"#B9D989",600:"#E75753",700:"#E75753",800:"#0065A0",900:"#B9D989",A100:"#B9D989",A200:"#E75753",A400:"#E75753",A700:"#E75753"}),a.definePalette("defaultPrimary",{50:"#FFFFFF",100:"rgb(255, 198, 197)",200:"#E75753",300:"#E75753",400:"#E75753",500:"#E75753",600:"#E75753",700:"#E75753",800:"#0065A0",900:"#B9D989",A100:"#B9D989",A200:"#E75753",A400:"#E75753",A700:"#E75753"}),a.definePalette("custom",{50:"#FFFFFF",100:"rgb(255, 198, 197)",200:"#E75753",300:"#E75753",400:"#E75753",500:"#B9D989",600:"#E75753",700:"#E75753",800:"#0065A0",900:"#8CBf3F",A100:"#B9D989",A200:"#E75753",A400:"#E75753",A700:"#E75753"}),o.icon("user","assets/images/user.svg",64)}]).run(["$rootScope","$location","$state","$cookieStore","$http",function(e,t,a,o,n){console.log("came in"),e.popoverIsVisible=!1,e.previewurl="",e.globals=o.get("globals")||{},e.globals.currentUser&&(n.defaults.headers.common={"X-User":e.globals.currentUser.username,"X-Token":e.globals.currentUser.authdata}),e.$on("$stateChangeStart",function(t,o){console.log("Came to scopechange"),o.authenticate&&!e.globals.currentUser&&(console.log("checking here"),a.transitionTo("login"),t.preventDefault())})}]),angular.module("angularMaterialAdmin").run(["$templateCache",function(e){e.put("app/views/DateDialogPage.html",'<md-dialog style="width:420px" aria-label="Mango (Fruit)" ng-cloak=""><form><md-toolbar><div class="md-toolbar-tools"><h2 style="color:rgba(255,255,255,0.8)">{{\'DATE_FILTERS_HEADING\' | translate}}</h2><span flex=""></span><md-button class="md-icon-button" ng-click="cancel()"><img style="height:30px;width:30px" src="assets/images/ic_close_white_48dp.png"></md-button></div></md-toolbar><md-dialog-content style="padding-top:5%"><div layout-padding="" ng-cloak=""><md-datepicker ng-change="startDateChange()" ng-model="dateStartCustom" md-placeholder="Start date"></md-datepicker><md-datepicker ng-change="endDateChange()" ng-model="dateEndCustom" md-placeholder="End date"></md-datepicker><p ng-if="errorOverlap">{{\'DATE_OVERLAP_ERROR\' | translate}}</p></div></md-dialog-content><md-dialog-actions><md-button ng-click="hide()" class="md-primary">{{\'CONTINUE\' | translate}}</md-button></md-dialog-actions></form></md-dialog>'),e.put("app/views/DistanceDialogPage.html",'<md-dialog md-is-locked-open="valid" style="width:420px" aria-label="Mango (Fruit)" ng-cloak=""><form><md-toolbar><div class="md-toolbar-tools"><h2 style="color:rgba(255,255,255,0.8)">{{\'DISTANCE_FILTERS_HEADING\' | translate}}</h2><span flex=""></span><md-button class="md-icon-button" ng-click="cancel()"><img style="height:30px;width:30px" src="assets/images/ic_close_white_48dp.png"></md-button></div></md-toolbar><md-dialog-content style="padding-top:5%;width:100%"><div layout="column" layout-padding="" ng-cloak=""><md-input-container><input type="number" min="0" ng-model="minDistanceFilter" placeholder="Longer than(Km)" style="width:100%"></md-input-container><md-input-container><input type="number" min="0" ng-model="maxDistanceFilter" placeholder="Shorter than(Km)" style="width:100%"></md-input-container><p ng-if="errorNegative">{{\'ERROR_NEGATIVE\' | translate}}</p><p ng-if="errorOverlap">{{\'DISTANCE_OVERLAP_ERROR\' | translate}}</p><p ng-if="errorLimit">{{\'DISTANCE_ERROR_LIMIT\' | translate}}</p></div></md-dialog-content><md-dialog-actions><md-button ng-click="hide()" class="md-primary">{{\'CONTINUE\' | translate}}</md-button></md-dialog-actions></form></md-dialog>'),e.put("app/views/DurationDialogPage.html",'<md-dialog style="width:420px" aria-label="Mango (Fruit)" ng-cloak=""><form><md-toolbar><div class="md-toolbar-tools"><h2 style="color:rgba(255,255,255,0.8)">Set Duration Filters</h2><span flex=""></span><md-button class="md-icon-button" ng-click="cancel()"><img style="height:30px;width:30px" src="assets/images/ic_close_white_48dp.png"></md-button></div></md-toolbar><md-dialog-content style="padding-top:5%;width:100%"><div layout="column" layout-padding="" ng-cloak=""><md-input-container><input type="number" min="0" ng-model="minDurationFilter" placeholder="Longer than(in minutes)" style="width:100%"></md-input-container><md-input-container><input type="number" min="0" ng-model="maxDurationFilter" placeholder="Shorter than(in minutes)" style="width:100%"></md-input-container><p ng-if="errorNegative">{{\'ERROR_NEGATIVE\' | translate}}</p><p ng-if="errorOverlap">{{\'DURATION_OVERLAP_ERROR\' | translate}}</p><p ng-if="errorLimit">{{\'DURATION_ERROR_LIMIT\' | translate}}</p></div></md-dialog-content><md-dialog-actions><md-button ng-click="hide()" class="md-primary">{{\'CONTINUE\' | translate}}</md-button></md-dialog-actions></form></md-dialog>'),e.put("app/views/TracksNotReturned.html",'<md-dialog style="width:320px" aria-label="Mango (Fruit)" ng-cloak=""><form><md-dialog-content><div style="text-align:center"><p>{{\'NO_SEGMENT_TRACKS\' | translate}}</p></div></md-dialog-content><md-dialog-actions style="padding-top:2%"><md-button ng-click="hide()" class="md-primary">{{\'CONTINUE\' | translate}}</md-button></md-dialog-actions></form></md-dialog>'),e.put("app/views/VehicleDialogPage.html",'<md-dialog style="width:420px" aria-label="Mango (Fruit)" ng-cloak=""><form><md-toolbar><div class="md-toolbar-tools"><h2 style="color:rgba(255,255,255,0.8)">{{\'VEHICLE_FILTERS_HEADING\' | translate}}</h2><span flex=""></span><md-button class="md-icon-button" ng-click="cancel()"><img style="height:30px;width:30px" src="assets/images/ic_close_white_48dp.png"></md-button></div></md-toolbar><md-dialog-content style="padding-top:5%"><div layout="column" layout-padding="" ng-cloak=""><md-input-container><md-select style="width:50%;padding-left:25%" multiple="" ng-model="vehicles" data-placeholder="{{\'SELECT_VEHICLES\' | translate }}"><md-option ng-repeat="v in vehicleList" value="{{v}}">{{v}}</md-option></md-select></md-input-container></div></md-dialog-content><md-dialog-actions style="padding-top:10%"><md-button ng-click="hide()" class="md-primary">{{\'CONTINUE\' | translate }}</md-button></md-dialog-actions></form></md-dialog>'),e.put("app/views/chart.html",'<div ng-app="app" ng-controller="ChartController"><div class="profiletab2" ng-style="{\'background-color\':\'#0065A0\'}" style="width:100%;height:130px"><div class="cover"><div class="container_header"><p class="title"><b>{{\'TRACK_ID\' | translate}}</b> - {{trackid}}</p><p class="title"><b>{{\'NAME\' | translate}}</b> - {{name}}</p><p class="title"><b>{{\'CREATED\' | translate}}</b> - {{created | date:\'medium\'}}</p></div></div></div><md-tabs md-dynamic-height="" md-border-bottom="" flex=""><md-tab label="SINGLE"><md-content style="background-color:#EEEEEE" md-theme="default"><div><div><div class="middle"><div layout-gt-md="row"><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="max-height:530px;min-height:530px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2"><div class="md-toolbar-tools"><h3><span>{{\'TRACK_MAP\' | translate}}</span></h3><span flex=""></span><md-select md-theme="blue" ng-model="widgetType1"><md-option ng-model="d" ng-value="d" ng-click="changePhenomenon(d)" data-ng-repeat="d in piechartoptions">{{d}}</md-option></md-select></div></md-toolbar><md-card-content style="max-height:465px" class="nopadding"><md-progress-circular class="loader_dashboard2" ng-if="!onload_leaflet" md-diameter="156"></md-progress-circular><md-content ng-if="onload_leaflet"><leaflet bounds="bounds" controls="controls" paths="paths" watch-paths="true" markers="markers" legend="legend" defaults="defaults" height="465"></leaflet></md-content></md-card-content></md-card><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="max-height:530px;min-height:530px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2"><div class="md-toolbar-tools"><h3><span>{{\'TIME_SERIES\' | translate}}</span></h3><span flex=""></span><md-menu md-offset="-120 20"><md-button class="capitalize md-primary" ng-click="$mdOpenMenu()" aria-label="Open menu"><i class="material-icons">more_vert</i></md-button><md-menu-content width="3"><md-menu-item flex="" ng-repeat="d in piechartoptions"><md-checkbox ng-checked="exists(d, selected)" ng-click="toggle(d, selected)">{{ d }}</md-checkbox></md-menu-item></md-menu-content></md-menu></div></md-toolbar><md-card-content><md-progress-circular class="loader_dashboard2" ng-if="!onload_nvd3line" md-diameter="156"></md-progress-circular><div ng-if="onload_nvd3line" class="containernvd3" style="width:100%;height:100%"><md-content ng-show="$showOptionsnvd3" class="optionsnvd3"><div class="demo-select-all-checkboxes" flex="" ng-repeat="d in piechartoptions"><md-checkbox ng-checked="exists(d, selected)" ng-click="toggle(d, selected)">{{ d }}</md-checkbox></div></md-content><nvd3 options="options" data="data"></nvd3></div></md-card-content></md-card></div><div layout-gt-md="row"><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="height:450px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2" md-scroll-shrink="" ng-if="true"><div class="md-toolbar-tools"><h3><span>{{\'TRACK_SUMMARY\' | translate}}</span></h3></div></md-toolbar><md-card-content class="text-color"><md-progress-circular class="loader_dashboard2" ng-if="!onload_summary" md-diameter="156"></md-progress-circular><div ng-if="onload_summary"><div layout-gt-xs="row"><div style="width:50%;text-align:center"><h3 style="color:#0065A0">{{tracksummary[\'timeoftravel\']}}</h3><p style="font-size:13px;">{{\'DURATION\' | translate}}</p></div><div style="width:50%;text-align:center"><h3 style="color:#0065A0">{{travel_distance}} Km</h3><p style="font-size:13px;">{{\'DISTANCE\' | translate}}</p></div></div><md-divider></md-divider><md-list-item layout="row"><i class="material-icons md-avatar grey md-36">directions_car</i><div class="md-list-item-text"><p>{{\'CAR:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{tracksummary[\'vehiclemanufacturer\']}}, {{tracksummary.vehiclemodel}}</p></div></md-list-item><md-list-item layout="row"><i class="material-icons md-avatar grey md-36">timer</i><div class="md-list-item-text"><p>{{\'START:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{tracksummary[\'starttime\']}}</p></div></md-list-item><md-list-item layout="row"><i class="material-icons md-avatar grey md-36">timer_off</i><div class="md-list-item-text"><p>{{\'END:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{tracksummary[\'endtime\']}}</p></div></md-list-item><md-list-item layout="row"><i class="material-icons md-avatar grey md-36">local_gas_station</i><div class="md-list-item-text"><p>{{\'CONSUMPTION:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{consumption100Km}}</p></div></md-list-item><md-list-item layout="row"><i class="material-icons md-avatar grey md-36">cloud_circle</i><div class="md-list-item-text"><p>{{\'CO2_EMISSION:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{co2gKm}}</p></div></md-list-item></div></md-card-content></md-card><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="height:450px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2"><div class="md-toolbar-tools"><h3><span>{{\'STATISTICS\' | translate}}</span></h3><span flex=""></span><md-select md-theme="blue" ng-model="widgetType2"><md-option ng-model="d" ng-value="d" ng-click="selecteditemchanged(d)" data-ng-repeat="d in piechartoptions">{{d}}</md-option></md-select></div></md-toolbar><md-card-content><md-progress-circular class="loader_dashboard2" ng-if="!onload_nvd3pie" md-diameter="156"></md-progress-circular><div ng-if="onload_nvd3pie" class="containernvd3" style="width:100%;height:100%"><nvd3 options="options_pie" data="data_pie"></nvd3></div></md-card-content></md-card><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="height:450px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2"><div class="md-toolbar-tools"><h3><span>{{\'TRACK_VS_PUBLIC\' | translate}}</span></h3><span flex=""></span><md-select md-theme="blue" ng-model="widgetType3"><md-option ng-model="d" ng-value="d" ng-click="changePhenomenonbar(d,1)" data-ng-repeat="d in barchartoptions">{{d}}</md-option></md-select></div></md-toolbar><md-card-content><md-progress-circular class="loader_dashboard2" ng-if="!onload_nvd3_user_vs_public" md-diameter="156"></md-progress-circular><div ng-if="onload_nvd3_user_vs_public" class="containernvd3" style="width:100%;height:100%"><nvd3 options="optionsSpeed" data="dataoverall"></nvd3></div></md-card-content></md-card></div></div></div></div></md-content></md-tab><md-tab label="Segment Track"><md-content ng-controller="SegmentController" style="background-color:#EEEEEE" md-theme="default"><div><div><div class="middle"><div layout-gt-md="row"><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="max-height:590px;min-height:590px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2"><div class="md-toolbar-tools"><h3><span>{{\'TRACK_MAP\' | translate}}</span></h3><span flex=""></span><md-select md-theme="blue" ng-model="widgetType1"><md-option ng-model="d" ng-value="d" ng-click="changePhenomenon(d)" data-ng-repeat="d in piechartoptions">{{d}}</md-option></md-select></div></md-toolbar><md-card-content style="max-height:495px" class="nopadding"><md-progress-circular class="loader_dashboard2" ng-if="!onload_leaflet" md-diameter="156"></md-progress-circular><rzslider rz-slider-model="slider.minValue" rz-slider-high="slider.maxValue" rz-slider-options="slider.options"></rzslider><md-content ng-if="onload_leaflet"><leaflet event-broadcast="events" bounds="bounds" controls="controls" paths="paths" watch-paths="true" markers="markers" legend="legend" defaults="defaults" height="465"></leaflet></md-content></md-card-content></md-card><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="max-height:590px;min-height:590px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2"><div class="md-toolbar-tools"><h3><span>{{\'TIME_SERIES\' | translate}}</span></h3><span flex=""></span><md-menu md-offset="-120 20"><md-button class="capitalize md-primary" ng-click="$mdOpenMenu()" aria-label="Open menu"><i class="material-icons">more_vert</i></md-button><md-menu-content width="3"><md-menu-item flex="" ng-repeat="d in piechartoptions"><md-checkbox ng-checked="exists(d, selected)" ng-click="toggle(d, selected)">{{ d }}</md-checkbox></md-menu-item></md-menu-content></md-menu></div></md-toolbar><md-card-content><md-progress-circular class="loader_dashboard2" ng-if="!onload_nvd3line" md-diameter="156"></md-progress-circular><div ng-if="onload_nvd3line" class="containernvd3" style="width:100%;height:100%"><md-content ng-show="$showOptionsnvd3" class="optionsnvd3"><div class="demo-select-all-checkboxes" flex="" ng-repeat="d in piechartoptions"><md-checkbox ng-checked="exists(d, selected)" ng-click="toggle(d, selected)">{{ d }}</md-checkbox></div></md-content><nvd3 options="options" data="data"></nvd3></div></md-card-content></md-card></div><div layout-gt-md="row"><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="height:450px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2" md-scroll-shrink="" ng-if="true"><div class="md-toolbar-tools"><h3><span>{{\'TRACK_SUMMARY\' | translate}}</span></h3></div></md-toolbar><md-card-content class="text-color"><md-progress-circular class="loader_dashboard2" ng-if="!onload_summary" md-diameter="156"></md-progress-circular><div ng-if="onload_summary"><div layout-gt-xs="row"><div style="width:50%;text-align:center"><h3 style="color:#0065A0">{{tracksummary[\'timeoftravel\']}}</h3><p style="font-size:13px;">{{\'DURATION\' | translate}}</p></div><div style="width:50%;text-align:center"><h3 style="color:#0065A0">{{travel_distance}} Km</h3><p style="font-size:13px;">{{\'DISTANCE\' | translate}}</p></div></div><md-divider></md-divider><md-list-item layout="row"><img ng-src="assets/images/ic_directions_car_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><p>{{\'CAR:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{tracksummary[\'vehiclemanufacturer\']}}, {{tracksummary.vehiclemodel}}</p></div></md-list-item><md-list-item layout="row"><img ng-src="assets/images/ic_timer_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><p>{{\'START:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{tracksummary[\'starttime\']}}</p></div></md-list-item><md-list-item layout="row"><img ng-src="assets/images/ic_timer_off_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><p>{{\'END:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{tracksummary[\'endtime\']}}</p></div></md-list-item><md-list-item layout="row"><img ng-src="assets/images/ic_local_gas_station_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><p>{{\'CONSUMPTION:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{consumption100Km}}</p></div></md-list-item><md-list-item layout="row"><img ng-src="assets/images/Gas-96.png" class="md-avatar"><div class="md-list-item-text"><p>{{\'CO2_EMISSION:\' | translate}}</p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{co2gKm}}</p></div></md-list-item></div></md-card-content></md-card><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="height:450px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2"><div class="md-toolbar-tools"><h3><span>{{\'STATISTICS\' | translate}}</span></h3><span flex=""></span><md-select md-theme="blue" ng-model="widgetType2"><md-option ng-model="d" ng-value="d" ng-click="selecteditemchanged(d)" data-ng-repeat="d in piechartoptions">{{d}}</md-option></md-select></div></md-toolbar><md-card-content><md-progress-circular class="loader_dashboard2" ng-if="!onload_nvd3pie" md-diameter="156"></md-progress-circular><div ng-if="onload_nvd3pie" class="containernvd3" style="width:100%;height:100%"><md-content ng-show="$showOptionsnvd3" class="optionsnvd3"></md-content><nvd3 options="options_pie" data="data_pie"></nvd3></div></md-card-content></md-card><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="height:450px" md-theme-watch=""><md-toolbar md-theme="custom" class="md-hue-1 md-whiteframe-z2"><div class="md-toolbar-tools"><h3><span>{{\'TRACK_VS_PUBLIC\' | translate}}</span></h3><span flex=""></span><md-select md-theme="blue" ng-model="widgetType3"><md-option ng-model="d" ng-value="d" ng-click="changePhenomenonbar(d)" data-ng-repeat="d in barchartoptions">{{d}}</md-option></md-select></div></md-toolbar><md-card-content><md-progress-circular class="loader_dashboard2" ng-if="!onload_nvd3_user_vs_public" md-diameter="156"></md-progress-circular><div ng-if="onload_nvd3_user_vs_public" class="containernvd3" style="width:100%;height:100%"><nvd3 options="optionsSpeed" data="dataoverall"></nvd3></div></md-card-content></md-card></div></div></div></div></md-content></md-tab></md-tabs></div>'),e.put("app/views/dashboard.html",'<div class="profiletab" ng-controller="ProfileViewController" ng-style="{\'background-color\':\'#0065A0\'}" style="width:100%;height:250px"><div class="cover"><div class="profile-pic absolute" style="height:40%;display:inline-block"><div layout="row"><div style="width:30%;text-align:center"><img class="img-circle" src="https://secure.gravatar.com/avatar/cf17f9ff1e0a237ab76046d5aca84e0e?size=240" style="height:100px;width:100px"></div><div style="width:70%;padding-left:25px;padding-top:10px" layout="column"><span class="usernameNew" ng-bind="name_of_user"></span> <span class="emailIdUserNew" ng-bind="emailId"></span> <span class="tracksusernameNew"><md-button class="md-raised md-primary" style="color:white" ng-show="originalUser" href="{{trackurl}}">Open {{name_of_user}}\'s Tracks</md-button></span></div></div></div><div class="statistics"><div class="detail2"><p ng-bind="track_number"><br><div class="descp">{{\'TRACKS\' | translate}}</div></p></div><div class="detail2"><p ng-bind="friends_number"><br><div class="descp">{{\'FRIENDS\' | translate}}</div></p></div><div class="detail2"><p ng-bind="distance_driven"><br><div class="descp">{{\'DISTANCE\' | translate}}</div></p></div><div class="detail2"><p ng-bind="groups_number"><br><div class="descp">{{\'GROUPS\' | translate}}</div></p></div></div></div></div><md-tabs md-selected="$root.tabNumber" md-dynamic-height="" md-border-bottom=""><md-tab label="{{\'TIMELINE_TAB\' | translate}}"><md-content ng-controller="DashboardController" class="md-padding" style="background-color:#EEEEEE" md-theme="default"><div class="middle"><div layout-gt-md="row" layout="column"><div layout-gt-md="column" style="width:100%" layout="column"><div layout-gt-xs="row" style="width:100%" layout="column"><md-card style="height:330px;width:100%" md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" md-theme-watch=""><md-toolbar style="color:black;background-color:white"><div class="md-toolbar-tools"><h3 style="color:rgba(0,101,160,0.9)"><span>{{\'User_VS_PUBLIC\' | translate}}</span></h3><span flex=""></span><md-select style="color:rgba(0,101,160,0.9)" md-theme="blue" ng-model="barchartshowing"><md-option ng-model="d" ng-value="d" ng-click="changePhenomenonbar(d)" data-ng-repeat="d in barchartoptions">{{d}}</md-option></md-select></div></md-toolbar><md-card-content><md-progress-circular class="loader_dashboard" ng-if="!onload_user_vs_public" md-diameter="156"></md-progress-circular><nvd3 options="optionsSpeed" data="dataoverall" ng-if="onload_user_vs_public"></nvd3></md-card-content></md-card><md-card style="height:330px;width:100%" md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" md-theme-watch=""><md-toolbar style="color:black;background-color:white"><div class="md-toolbar-tools"><h3 style="color:rgba(0,101,160,0.9)"><span>{{\'SPEED_STATS\' | translate}}</span></h3><span flex=""></span><md-select style="color:rgba(0,101,160,0.9)" ng-model="pieSpeedRanges"><md-option ng-model="d" ng-value="d" ng-click="changePhenomenonPieSpeed(d)" data-ng-repeat="d in speedPieOptions">{{d}}</md-option></md-select></div></md-toolbar><md-card-content><md-progress-circular class="loader_dashboard" ng-if="!onloadSpeedPie" md-diameter="156"></md-progress-circular><nvd3 ng-if="onloadSpeedPie" options="options_pie" data="dataSpeedPie"></nvd3></md-card-content></md-card></div><div layout-gt-md="row" style="width:100%" layout="column"><md-card ng-controller="LeafletHeatMap" style="height:560px;width:100%" class="nopadding" md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" md-theme-watch=""><md-card-content style="height:auto" class="nopadding"><md-progress-circular class="loader_dashboard" ng-if="!onload_heat_map" md-diameter="156"></md-progress-circular><div ng-if="onload_heat_map"><leaflet lf-center="center" layers="layers" width="100%" height="560px"></leaflet></div></md-card-content></md-card></div></div><div layout-gt-md="column" style="min-width:32%" layout="column"><md-card style="min-width:30%;height:730px" md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" md-theme-watch=""><md-toolbar style="color:black;background-color:white"><div class="md-toolbar-tools"><h3 style="color:rgba(0,101,160,0.9)"><span>{{\'TITLE_TRACKS\' | translate}}</span></h3><span flex=""></span></div></md-toolbar><md-card-content class="text-color nopadding"><md-progress-circular class="loader_dashboard" ng-if="!onload_tracks_timeline" md-diameter="156"></md-progress-circular><div class="card-body"><div class="streamline b-l b-accent m-b"><div class="sl-item" ng-show="onload_tracks_timeline" ng-repeat="event in events" ng-click="goToActivity(event.id)"><div class="sl-content"><span><span style="color:rgba(0,101,160,0.9);line-height:100%;padding-bottom:30px;margin-left:-10px"><b>{{event.begin | date:\'medium\'}}</b></span> <span style="color:rgba(255,255,255,0.8);background-color:rgba(0,101,160,0.9);border-radius: 8px;float:right">&nbsp;{{event.distance}} Km&nbsp;</span></span><div style="height:40px;padding-top:15px;padding-bottom:15px"><span style="line-height:70%"><i class="material-icons md-24" style="height:28px;width:28px">directions_car</i> {{event.manufacturer}} - {{event.car}}</span><p><span><i class="material-icons md-24" style="height:28px;width:28px">timer</i> {{event.travelTime}}</span></p></div><p></p></div><md-tooltip class="trackpreview" md-direction="left"><md-content><img src="{{event.url}}" style="width:480px;height:380px"></md-content></md-tooltip></div></div></div></md-card-content></md-card><md-card style="height:160px" ng-controller="FriendListController"><md-toolbar style="color:black;background-color:white;min-height:20px"><div class="md-toolbar-tools"><h3 style="color:rgba(0,101,160,0.9)"><span>{{\'FRIENDS\' | translate}}</span></h3><span flex=""></span></div></md-toolbar><md-card-content><md-grid-list md-cols="4" md-row-height="80px"><md-grid-tile ng-repeat="item in data_friends_4"><button class="md-no-style md-button md-no-ink md-no-focus-style transparent" ng-click="goToFriend(item.username)"><img class="img-circle2" style="height:80px;width:80px" src="{{item.profile_url}}"><img></button><md-tooltip>{{item.username}}</md-tooltip></md-grid-tile><md-grid-tile><md-button class="md-fab md-primary" ng-show="showMoreFriends" style="width:70px;height:70px" ng-click="tabChangeToFriends()"><span style="font-size:22px;color:white">{{remainingFriends}}</span></md-button></md-grid-tile></md-grid-list></md-card-content></md-card></div></div></div></md-content></md-tab><md-tab label="{{\'ACTIVITY_TAB\' | translate}}"><md-content style="background-color:#EEEEEE" class="md-padding"><div class="middle"><div layout-gt-md="row" layout="column"><md-card ng-show="originaluser" ng-controller="FriendActivityController" md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="min-width:37.5%" md-theme-watch=""><md-toolbar style="color:black;background-color:white"><div class="md-toolbar-tools"><h3 style="color:rgba(0,101,160,0.9)"><span>{{ \'FRIENDS_ACTIVITY\' | translate}}</span></h3></div></md-toolbar><md-card-content><md-progress-circular ng-if="totalLoading" class="loader_dashboard" md-diameter="156"></md-progress-circular><md-content ng-if="!totalLoading" flex="" layout-padding="" style="max-height:560px"><md-list-item class="md-3-line" ng-repeat="item in events" ng-click="goToActivity(item.type,item.trackidlink)"><i class="material-icons grey md-avatar md-48">{{item.icon}}</i><div style="padding-left:5%" class="md-list-item-text" layout="column"><h3 style="color:{{item.color}}"><b>{{item.topic}}</b></h3><p>{{item.name}}</p><p>{{item.time | date:\'medium\'}}</p></div></md-list-item><div ng-show="busy">{{\'LOADING_DATA\' | translate}}</div></md-content><div layout="row" ng-show="show_no_my_activity" layout-align="center center"><p>{{\'NO_FRIENDS_ACTIVITY\' | translate}}</p></div></md-card-content><md-card-actions layout-align="center center" layout="column"><md-button ng-if="!show_no_my_activity && !fetchingResults" class="white-bg" ng-click="nextpage()">{{\'LOAD_MORE\' | translate}}</md-button><md-progress-circular ng-if="fetchingResults" class="loader_dashboard" md-diameter="40"></md-progress-circular></md-card-actions></md-card><md-card ng-controller="MyActivityController" md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="min-width:37.5%" md-theme-watch=""><md-toolbar style="color:black;background-color:white"><div class="md-toolbar-tools"><h3 style="color:rgba(0,101,160,0.9)"><span>{{\'MY_ACTIVITY\' | translate}}</span></h3></div></md-toolbar><md-card-content><md-progress-circular ng-if="totalLoading" class="loader_dashboard" md-diameter="156"></md-progress-circular><md-content ng-if="!totalLoading" flex="" layout-padding="" style="max-height:560px"><md-list-item ng-show="!show_no_my_activity" class="md-3-line" ng-repeat="item in events" ng-click="goToActivity(item.type,item.trackidlink)"><i class="material-icons grey md-avatar md-48">{{item.icon}}</i><div style="padding-left:5%" class="md-list-item-text" layout="column"><h3 style="color:{{item.color}}"><b>{{item.topic}}</b></h3><p>{{item.name}}</p><p>{{item.time | date:\'medium\'}}</p></div></md-list-item><div ng-show="busy">{{\'LOADING_DATA\' | translate}}</div></md-content><div layout="row" ng-show="show_no_my_activity" layout-align="center center"><p>{{\'NO_ACTIVITY\' | translate}}</p></div></md-card-content><md-card-actions layout-align="center center" layout="column"><md-button ng-if="!show_no_my_activity && !fetchingResults" class="white-bg" ng-click="nextpage()">{{\'LOAD_MORE\' | translate}}</md-button><md-progress-circular ng-if="fetchingResults" class="loader_dashboard" md-diameter="40"></md-progress-circular></md-card-actions></md-card><md-card ng-controller="FriendListController" md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" style="min-width:25%" md-theme-watch=""><md-toolbar style="color:black;background-color:white"><div class="md-toolbar-tools"><h3 style="color:rgba(0,101,160,0.9)"><span>{{\'FRIENDS\' | translate}}</span></h3></div></md-toolbar><md-card-content><md-progress-circular ng-if="totalLoading" class="loader_dashboard" md-diameter="156"></md-progress-circular><div ng-if="!totalLoading" flex=""><md-content ng-show="!show_no_friends" flex="" layout-padding="" style="max-height:560px"><md-list-item ng-repeat="item in data_friends" ng-click="goToFriend(item.username)"><img class="md-avatar" src="{{item.profile_url}}"><div class="md-list-item-text" layout="column"><p>{{item.username}}</p></div></md-list-item></md-content><div layout="row" ng-show="show_no_friends" layout-align="center center"><p>{{\'NO_FRIENDS\' | translate}}</p></div></div></md-card-content></md-card></div></div></md-content></md-tab></md-tabs>'),e.put("app/views/error.html",'<div layout-gt-md="row"><panel-widget flex="" title="Timeline" template="app/views/partials/errorcontents.html"></panel-widget></div>'),e.put("app/views/login.html",'<div layout="column" flex="" id="content" role="main"><md-content layout="vertical" flex="" id="content"><div layout="row" layout-align="center center" layout-fill=""><md-whiteframe class="md-whiteframe-z1" layout="column" flex="30" layout-padding=""><md-content md-theme="default"><div ng-show="error">{{error}}</div><md-input-container md-theme="default"><label>{{\'USERNAME\' | translate}}</label> <input ng-keyup="$event.keyCode == 13 && login()" ng-model="username"></md-input-container><md-input-container md-theme="default"><label>{{\'PASSWORD\' | translate}}</label> <input ng-keyup="$event.keyCode == 13 && login()" ng-model="password" type="password"></md-input-container><md-input-container layout-align="center center"><div layout="row" layout-sm="column" layout-margin=""><md-button md-theme="defaultPrimary" class="md-raised" flex="50" flex-sm="100" ng-click="login()">{{\'LOGIN\' | translate}}</md-button><md-button class="md-raised md-success" flex="50" flex-sm="100">{{\'REGISTER\' | translate}}</md-button></div></md-input-container></md-content></md-whiteframe></div></md-content></div>'),e.put("app/views/main.html",'<md-sidenav md-component-id="left" style="z-index:100000" class="md-whiteframe-z2 md-sidenav-left" md-is-locked-open="vm.lockLeft && $mdMedia(\'gt-xs\')"><md-toolbar layout="column" style="min-height:10%"><div class="md-toolbar-tools"><span flex=""></span><md-button hide-gt-xs="" class="bg-white" aria-label="Close Side Panel" ng-click="closeSideNavPanel()"><md-tooltip>Close Side Panel</md-tooltip><i class="material-icons white09">&#xE314;</i></md-button></div><div style="padding-top:20%;padding-left:7%"><p style="color:rgba(255,255,255,1);font-size:24px"><b>{{vm.profilename}}</b></p><p style="color:rgba(255,255,255,0.7);font-size:14px;margin-top:-5%">{{vm.email}}</p></div></md-toolbar><div><md-list><md-list-item ng-repeat="item in vm.menuItems" ng-click="vm.selectItem(item)" href="{{item.sref}}" ui-sref-active="md-primary"><md-item-content layout="row" layout-align="start center"><i class="material-icons md-avatar md-36 blue">{{item.icon}}</i><div class="md-list-item-text"><p>{{item.name}}</p></div></md-item-content></md-list-item><md-divider></md-divider><md-subheader>Settings</md-subheader><md-item ng-repeat="item in admin"><a><md-item-content md-ink-ripple="" layout="row" layout-align="start center"><div class="inset"><ng-xs-icon icon="{{item.icon}}"></ng-xs-icon></div><div class="inset">{{item.title}}</div></md-item-content></a></md-item></md-list></div></md-sidenav><div layout="column" flex=""><md-toolbar layout="row" layout-align="start center" class="customtoolbar"><md-button hide="" show-gt-xs="" ng-click="vm.lockLeft=!vm.lockLeft" aria-label="Menu"><i ng-if="!vm.lockLeft" class="material-icons white09">menu</i> <i ng-if="vm.lockLeft" class="material-icons white09">&#xE314;</i></md-button><md-button hide-gt-xs="" ng-click="vm.toggleItemsList()" aria-label="Menu"><i class="material-icons white09">menu</i></md-button><span flex=""></span><md-button class="white-bg" ng-cloak="" ng-show="$root.showlogout" aria-label="Notifications" ui-sref="login"><img style="height:20px;width:20px" ng-src="assets/images/ic_power_settings_new_white_48dp.png"> <span style="color:white">{{\'LOGOUT\' | translate}}</span></md-button><md-button class="white-bg" ng-cloak="" ng-show="!$root.showlogout" aria-label="Notifications" ui-sref="login"><img style="height:20px;width:20px" ng-src="assets/images/ic_power_settings_new_white_48dp.png"> <span style="color:white">{{\'LOGIN\' | translate}}</span></md-button></md-toolbar><md-content flex="" class="page-content"><div ui-view="" style="height:100%"></div></md-content></div>'),e.put("app/views/profile.html",'<div ng-controller="ProfileController" class="middle"><div layout-gt-sm="row"><md-card class="card card-4-50" style="min-height:900px"><img src="assets/images/profiledup.png" hide="" show-gt-sm="" class="md-card-image"><md-card-content class="text-color"><img src="assets/images/profiledup.png" hide-gt-sm="" style="width:30%"><h2>Bio</h2><md-list-item layout-gt-xs="row"><div class="md-list-item-text"><p><b>{{\'NAME\' | translate}}</b></p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{name}}</p></div></md-list-item><md-list-item layout="row"><div class="md-list-item-text"><p><b>{{\'EMAIL_ID\' | translate}}</b></p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{emailId}}</p></div></md-list-item><md-list-item layout="row"><div class="md-list-item-text"><p><b>{{\'COUNTRY\' | translate}}</b></p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{countrytext}}</p></div></md-list-item><md-list-item layout="row"><div class="md-list-item-text"><p><b>{{\'LANGUAGE\' | translate}}</b></p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{langtext}}</p></div></md-list-item><md-list-item layout="row"><div class="md-list-item-text"><p><b>{{\'GENDER\' | translate}}</b></p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{gendertext}}</p></div></md-list-item><md-divider></md-divider><md-list-item layout="row"><div class="md-list-item-text"><p><b>{{\'CREATED\' | translate}}</b></p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{created}}</p></div></md-list-item><md-list-item layout="row"><div class="md-list-item-text"><p><b>{{\'MODIFIED\' | translate}}</b></p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{modified}}</p></div></md-list-item><md-list-item layout="row"><div class="md-list-item-text"><p><b>{{\'TERMS_OF_USE_VERSION\' | translate}}</b></p></div><span flex=""></span><div style="right:0px" class="md-list-item-text"><p>{{termsOfUseVersion}}</p></div></md-list-item><md-divider></md-divider><h2>{{\'BADGES\' | translate}}</h2><md-list-item ng-if="badgesTrue" ng-repeat="item in badges"><img class="md-avatar" src="{{item.url}}"><div class="md-list-item-text" layout="column"><p>{{item.title}}</p></div></md-list-item><p ng-if="!badgesTrue">{{\'NO_BADGES\' | translate}}</p></md-card-content></md-card><md-card class="card card-4-50" style="min-width:70%"><md-toolbar style="color:black;background-color:white"><div class="md-toolbar-tools"><h3 style="color:rgba(0,0,0,0.5)"><span>{{\'EDIT_INFO\' | translate}}</span></h3></div></md-toolbar><md-card-content><div layout="column" layout-padding="" ng-cloak=""><md-input-container class="md-icon-float md-block"><input ng-model="emailId" type="text" ng-required="true" placeholder="Email"></md-input-container><md-input-container class="md-icon-float md-block"><input ng-model="firstName" type="text" data-placeholder="{{\'FIRST_NAME\' | translate}}"></md-input-container><md-input-container class="md-icon-float md-block"><input ng-model="lastName" type="text" data-placeholder="{{\'LAST_NAME\' | translate}}"></md-input-container><md-input-container class="md-icon-float md-block"><input ng-model="country" type="text" data-placeholder="{{\'COUNTRY\' | translate}}"></md-input-container><span>{{\'DOB\' | translate}}<md-datepicker ng-model="dateBirthdayPicker" md-placeholder="{{\'ENTER_DATE\' | translate}}"></md-datepicker></span><md-select md-theme="blue" ng-model="gender" data-placeholder="{{\'GENDER\' | translate}}"><md-option value="m">Male</md-option><md-option value="f">Female</md-option></md-select><md-select md-theme="blue" ng-model="lang" data-placeholder="{{\'LANGUAGE\' | translate}}"><md-option value="en">English</md-option><md-option value="de">German</md-option></md-select><h3 style="color:rgba(0,0,0,0.5)"><span>{{\'PASSWORD_TIP\' | translate}}</span></h3><md-input-container class="md-icon-float md-block"><input ng-model="oldpassword" type="password" ng-change="passwordentered(0)" ng-required="ifpassword" data-placeholder="{{\'OLD_PASSWORD\' | translate}}"></md-input-container><md-input-container class="md-icon-float md-block"><input ng-model="newpassword" type="password" ng-change="passwordentered(1)" ng-required="ifpassword" data-placeholder="{{\'NEW_PASSWORD\' | translate}}"></md-input-container><md-input-container class="md-icon-float md-block"><input ng-model="newpasswordrepeat" type="password" ng-change="passwordentered(2)" ng-required="ifpassword" data-placeholder="{{\'NEW_PASSWORD_R\' | translate}}"></md-input-container><div ng-if="submissionSuccess" style="background-color:rgba(185,217,137,0.9);"><p>{{\'SUBMISSION_SUCCESS\' | translate}}</p></div><div ng-if="submissionFailure" style="background-color:rgba(255, 59, 41, 0.4)"><p>{{submissionErrorMessage}}</p></div><md-button class="green-bg" ng-click="updateUserDetails()" style="width:150px">{{\'UPDATE_PROFILE\' | translate}}</md-button></div></md-card-content></md-card></div></div>'),e.put("app/views/segment.html",'<div ng-controller="SegmentIndependentController" class="mapcontainer" style="height:100%"><tour step="currentStep"><div style="box-shadow: 0px 0px 5px 1px rgba(0,0,0,0.2); position:absolute;z-index:1;width:22%;right:0;height:100%;background-color:rgba(255,255,255,0.85)"><div style="text-align:center"><h3>{{\'CONTROL_PANEL\' | translate}}</h3></div><div style="text-align:center;padding-left:2%;padding-right:2%"><p style="font-size:16px">{{\'SEGMENT_INFO\' | translate}}</p></div><div layout-gt-xs="column" layout="center center"><div style="width:100%;text-align:center"></div><div style="width:100%;text-align:center"><md-progress-circular ng-if="!notSearching" class="loader_dashboard" md-diameter="50"></md-progress-circular><md-button tourtip="{{\'TOURTIP2\' | translate}}" tourtip-placement="left" tourtip-step="1" ng-if="notSearching" class="white-bg" ng-click="searchForPoints()">{{\'SEARCH_TRACKS\' | translate}}</md-button></div></div><div style="padding-left:2%;padding-right:2%" tourtip="{{\'TOURTIP5\' | translate}}" tourtip-placement="left" tourtip-step="4" tourtip-next-label="Get Started!"><rzslider rz-slider-model="$root.slider.value" rz-slider-options="$root.slider.options"></rzslider></div><div ng-if="statisticsPresent"><div layout="center" layout-padding="" ng-cloak=""><md-select layout-align="center center" style="width:90%" ng-model="selectModel"><md-option ng-model="s.ind" ng-repeat="(i,s) in segments" ng-selected="i == 0 ? true:false" ng-click="segmentChanged(s.ind)" ng-value="s.ind">{{s.value}}</md-option></md-select><md-select layout-align="center center" style="width:90%" ng-model="selectedPhenom"><md-option ng-model="s" ng-repeat="(i,s) in keys" ng-click="phenomChanged(s)" ng-selected="s == \'Speed\' ? true:false" ng-value="s">{{s}}</md-option></md-select></div><nvd3 options="options" data="data"></nvd3><div style="text-align:center;padding-left:2%;padding-right:2%"><span>{{\'COUNT_POINTS\' | translate}} - {{pointsCount}}</span></div></div></div><div tourtip="{{\'TOURTIP1\' | translate}}" tourtip-placement="right" tourtip-margin="0" tourtip-step="0" tourtip-element=".leaflet-draw-draw-polyline" style="height:100%;width:100%"><span tourtip="{{\'TOURTIP3\' | translate}}" tourtip-placement="right" tourtip-step="2" tourtip-element=".leaflet-draw-edit-edit"></span> <span tourtip="{{\'TOURTIP4\' | translate}}" tourtip-placement="right" tourtip-step="3" tourtip-element=".leaflet-draw-edit-edit"></span><leaflet lf-center="map.center" paths="paths" lf-draw="map.drawOptions" height="100%" width="100%"></leaflet></div></tour>--></div>'),e.put("app/views/segmentTrial.html",'<div ng-controller="SegmentDrawController"><leaflet lf-center="map.center" paths="paths" lf-draw="map.drawOptions" height="100vw" width="100%"></leaflet></div>'),e.put("app/views/table.html",""),e.put("app/views/tracks.html",'<md-tabs md-dynamic-height="" md-dynamic-width="" md-border-bottom=""><md-tab label="{{\'CALENDAR_OF_TRACKS_TAB\' | translate}}"><div class="middle"><div ng-controller="CalendarController" layout-gt-xs="row"><md-card style="height:700px;min-width:60%" flex="" md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" class="card card-4-50" md-theme-watch=""><md-card-content class="nopadding"><md-progress-circular style="top:100px" class="loader_dashboard2" ng-if="onload" md-diameter="156"></md-progress-circular><md-content ng-show="!onload"><div><calendar-md md-theme="blue" flex="" layout="" layout-fill="" calendar-direction="direction" on-prev-month="prevMonth" on-next-month="nextMonth" on-day-click="dayClick" title-format="\'MMMM y\'" ng-model="selectedDate" day-format="\'d\'" tooltips="tooltips" day-label-format="\'EEE\'" day-label-tooltip-format="\'EEEE\'" day-tooltip-format="\'fullDate\'" week-starts-on="firstDayOfWeek" disable-future-selection="true" data-start-month="{{start_month}}" data-start-year="{{start_year}}" day-content="setDayContent"></calendar-md></div><div style="width:100%"><md-button ng-click="buttonClickCurrentDate()">Go to current date</md-button><div style="width:100%;text-align:center"><h3 style="color:rgba(0,0,0,0.7)">{{\'MONTHLY_OVERVIEW\' | translate}}</h3></div></div><div layout-gt-xs="row" ng-if="!nostatistics"><div style="width:33.33%;text-align:center"><h3 style="color:#0065A0">{{total_time}}</h3><p style="font-size:13px;">{{\'DURATION\' | translate}}</p></div><div style="width:33.33%;text-align:center"><h3 style="color:#0065A0">{{total_distance}} Km</h3><p style="font-size:13px;">{{\'DISTANCE\' | translate}}</p></div><div style="width:33.33%;text-align:center"><h3 style="color:#0065A0">{{total_tracks}}</h3><p style="font-size:13px;">{{\'TRACKS\' | translate}}</p></div></div><div layout-gt-xs="row" ng-if="nostatistics"><div style="width:100%;text-align:center"><p>{{\'NO_MONTHLY_STATISTICS\' | translate}}</p></div></div></md-content></md-card-content></md-card><md-card md-theme="default" class="card card-4-50" flex="" md-theme-watch=""><md-card-content style="padding-left:7%;padding-top:20px"><div class="streamline b-l b-accent m-b"><div class="sl-item" ng-repeat="event in tracks" ng-click="goToActivity(event.id)"><div class="sl-content"><span><span style="color:rgba(0,101,160,0.9);line-height:100%;padding-bottom:30px;margin-left:-10px"><b>{{event.begin | date:\'medium\'}}</b></span> <span style="color:rgba(255,255,255,0.8);background-color:rgba(0,101,160,0.9);border-radius: 8px;float:right">&nbsp;&nbsp;{{event.length}} Km&nbsp;&nbsp;</span></span><div style="height:40px;padding-top:15px;padding-bottom:15px"><span style="line-height:70%"><i class="material-icons md-24" style="height:28px;width:28px">directions_car</i> {{event.manufacturer}} - {{event.car}}</span><p><span><i class="material-icons md-24" style="height:28px;width:28px">timer</i> {{event.travelTime}}</span></p></div><p></p></div><md-tooltip class="trackpreview" md-direction="left"><md-content><img src="{{event.url}}" style="width:480px;height:380px"></md-content></md-tooltip></div></div></md-card-content></md-card></div></div></md-tab><md-tab label="{{\'ALL_TRACKS_TAB\' | translate}}"><div class="middle"><div layout-gt-md="row"><md-card ng-controller="filterTracksController" style="max-height:600px;width:60%;display: table;margin-right: auto;margin-left: auto;" md-theme-watch=""><md-toolbar style="color:black;background-color:rgba(185,217,137,1)" md-theme="default"><div class="md-toolbar-tools"><p>{{\'ORDER_BY\' | translate}} -</p><p>&nbsp</p><md-select ng-model="filterSelected"><md-option ng-model="filterSelected" ng-value="d" ng-click="changeFilter(d)" ng-selected="Modified" data-ng-repeat="d in filterOptions">{{d}}</md-option></md-select><div style="padding-top:15px;padding-left:2%"><md-checkbox ng-click="reverseClicked()" ng-model="reverseEnabled">{{\'REVERSE\' | translate}}</md-checkbox></div><span flex=""></span><md-input-container ng-show="showSearch" md-theme="input" style="padding-top:30px" flex=""><label>black</label> <input ng-model="search" placeholder="enter search"></md-input-container><md-button aria-label="Search" ng-show="!showSearch" ng-click="toggleShow()"><i class="material-icons md-36">search</i></md-button><md-button aria-label="Search" ng-show="showSearch" ng-click="toggleShow()"><i class="material-icons md-36">close</i></md-button></div></md-toolbar><md-card-content><div layout-gt-md="row" layout="column"><div style="text-align:center"><md-menu><md-button class="md-primary md-raised" ng-click="openMenu($mdOpenMenu, $event)"><i class="material-icons white099">add_box</i> <span style="color:rgba(255,255,255,0.9)">Filter</span></md-button><md-menu-content width="4"><md-menu-item ng-repeat="item in $root.filters" ng-hide="item[2]"><md-button ng-click="addFilter(item[1])">{{item[0]}}</md-button></md-menu-item></md-menu-content></md-menu></div><md-chips style="min-width:80%" md-on-add="add($chip)" ng-model="$root.selectedVegetables" md-autocomplete-snap="" md-transform-chip="transformChip($chip)" md-require-match="autocompleteDemoRequireMatch" md-on-select="getChipInfo($chip)" md-on-remove="removeChip($chip)"><md-autocomplete style="width:100%" md-selected-item="selectedItem" md-search-text="searchText" md-items="item in querySearch(searchText)" md-item-text="item.name" placeholder="Type filters or Click above"><span md-highlight-text="searchText">{{item.name}}</span></md-autocomplete><md-chip-template style="width:100%"><span><strong>{{$chip.name}}</strong></span></md-chip-template></md-chips></div><div style="width:100%;text-align:center"><p style="font-size:17px">Showing {{(tracks|filter:search | filter:distanceFilter | filter:dateFilter | filter:durationFilter | filter:vehicleFilter).length}} of {{tracks.length}} tracks</p></div><md-progress-circular class="loader_dashboard2" ng-if="onload" md-diameter="156"></md-progress-circular><md-content ng-show="!onload" style="max-height:570px; padding-left:6%;padding-right:10px;padding-top:20px"><div class="streamline b-l b-accent m-b"><div class="sl-item" ng-repeat="event in tracks | filter:search | orderBy:filterOrig:!reverse | filter:dateFilter | filter:distanceFilter | filter:durationFilter | filter:vehicleFilter" ng-click="goToActivity(event.TrackId)"><div class="sl-content"><span><span style="color:rgba(0,101,160,0.9);line-height:100%;padding-bottom:30px;margin-left:-10px"><b>{{event.Start | date:\'medium\'}}</b></span> <span style="color:rgba(255,255,255,0.8);background-color:rgba(0,101,160,0.9);border-radius: 8px;float:right">&nbsp;&nbsp;{{event.Distance}} Km&nbsp;&nbsp;</span></span><div style="height:40px;padding-top:15px;padding-bottom:15px"><span style="line-height:70%"><i class="material-icons md-24" style="height:28px;width:28px">directions_car</i> {{event.manufacturer}} - {{event.Vehicle}}</span><p><span><i class="material-icons md-24" style="height:28px;width:28px">timer</i> {{event.DurationString}}</span></p></div><p></p></div><md-tooltip class="trackpreview" md-direction="left"><md-content><img src="{{event.url}}" style="width:480px;height:380px"></md-content></md-tooltip></div></div></md-content></md-card-content></md-card></div></div></md-tab></md-tabs>'),e.put("app/views/trackstrial.html",'<div ng-controller="CalendarTrial"><div ui-calendar="uiConfig.calendar" class="span8 calendar" ng-model="eventSources"></div></div>'),e.put("app/views/partials/bottomSheet.html",'<md-bottom-sheet class="md-list md-has-header"><md-subheader>Select action</md-subheader><md-list><md-list-item ng-repeat="action in vm.actions"><md-button class="md-list-item-content" ng-click="vm.performAction(action)" ng-href="{{action.url}}" target="_blank"><i class="material-icons">{{action.icon}}</i> <span class="share-label">{{action.name}}</span></md-button></md-list-item></md-list></md-bottom-sheet>'),e.put("app/views/partials/chartmain.html",'<div ng-controller="ChartController"><nvd3 options="options" data="data"></nvd3></div>'),e.put("app/views/partials/comparison.html",'<md-content ng-controller="DashboardController" layout="row" widget-height="700px" layout-align="center center"><nvd3 options="options" data="data"></nvd3></md-content>'),e.put("app/views/partials/errorcontents.html",'<div class="container" ng-controller="ErrorController"><h1>Not found <span>:(</span></h1><p>Sorry, but the page you were trying to view does not exist.</p><p ng-bind="errorcodeparams"></p><ul><li ng-bind="params"></li></ul></div>'),e.put("app/views/partials/leaflettrack.html",'<div ng-controller="ChartController"><md-content ng-show="$showOptions" class="options"><md-radio-group ng-model="phenomenonleaflet" ng-change="changePhenomenon()"><md-radio-button ng-repeat="d in piechartoptions" ng-value="d">{{d}}</md-radio-button></md-radio-group></md-content><md-content class="md-padding"><leaflet lf-center="center" controls="controls" paths="paths" markers="markers" defaults="defaults" height="470"></leaflet></md-content></div>'),e.put("app/views/partials/piechart.html",'<div ng-controller="ChartController"><md-content ng-show="$showOptions" class="options"><md-radio-group ng-model="piechartselected" ng-change="selecteditemchanged()"><md-radio-button ng-repeat="d in piechartoptions" ng-value="d">{{d}}</md-radio-button></md-radio-group></md-content><md-content class="md-padding"><nvd3 options="options_pie" data="data_pie"></nvd3></md-content></div>'),e.put("app/views/partials/timeline.html",""),e.put("app/views/partials/timelinecontents.html",'<div ng-controller="DashboardController"><timeline><timeline-event ng-repeat="event in events" side="{{event.side}}"><timeline-badge class="{{event.badgeClass}}"><i class="glyphicon {{event.badgeIconClass}}"></i></timeline-badge><timeline-panel class="{{event.badgeClass}}"><timeline-heading><h4><a href="{{event.urlredirect}}">{{event.title}}</a></h4></timeline-heading><p>Track ID - {{event.id}}</p><p>Modified - {{event.modified}}</p><img class="previewimage" src="{{event.url}}" height="72" width="72"></timeline-panel></timeline-event></timeline></div>'),e.put("app/views/partials/tracklistcontents.html",'<div role="main" class="container theme-showcase"><div><div class="table-responsive-vertical"><div class="bs-component" ng-controller="ProfileController"><table ng-show="show == true" class="table table-striped table-hover"><thead><tr><th>Track Id</th><th>Last Modified</th><th>Track Name</th></tr></thead><tbody ng-show="show == true"><tr ng-show="trackslist.length <= 0"><td colspan="5" style="text-align:center;">Loading new data!!</td></tr><tr ng-hide="trackslist.length <= 0" dir-paginate="user in trackslist|itemsPerPage:itemsPerPage" total-items="total_count"><td><a href="{{user.urlredirect}}">{{user.id}}</a></td><td>{{user.modified}}</td><td>{{user.name}}</td></tr></tbody></table><dir-pagination-controls max-size="8" direction-links="true" boundary-links="true" on-page-change="getData(newPageNumber)"></dir-pagination-controls></div></div></div></div>'),e.put("app/views/partials/tracksummary.html",'<div ng-controller="ChartController"><md-list-item class="md-2-line"><img ng-src="assets/images/ic_directions_car_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><h3>Distance</h3><p>{{tracksummary[\'distance\']}} {{tracksummary[\'unitsofdistance\']}}</p></div><img ng-src="assets/images/ic_directions_car_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><h3>Vehicle Type</h3><p>{{tracksummary[\'vehicletype\']}} - {{tracksummary[\'vehiclemodel\']}}</p></div></md-list-item><md-divider></md-divider><md-list-item class="md-2-line"><img ng-src="assets/images/ic_timer_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><h3>Total Time</h3><p>{{tracksummary[\'timeoftravel\']}} {{tracksummary[\'unitsoftime\']}}</p></div><img ng-src="assets/images/ic_access_time_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><h3>Start-Finish Time</h3><p>{{tracksummary[\'starttime\']}} - {{tracksummary[\'endtime\']}}</p></div></md-list-item><md-divider></md-divider><md-list-item class="md-2-line"><img ng-src="assets/images/Gas-Pump-96.png" class="md-avatar"><div class="md-list-item-text"><h3>Consumption</h3><p>{{tracksummary[\'fuel\']}} {{tracksummary[\'unitsoffuel\']}}</p></div><img ng-src="assets/images/ic_local_gas_station_black_48dp.png" class="md-avatar"><div class="md-list-item-text"><h3>Consumption/Hour</h3><p>{{tracksummary[\'fuelperhour\']}} l/h</p></div></md-list-item><md-divider></md-divider><md-list-item class="md-2-line"><img ng-src="assets/images/Gas-96.png" class="md-avatar"><div class="md-list-item-text"><h3>CO2 Emission</h3><p>{{tracksummary[\'co2emission\']}} {{tracksummary[\'unitsofco2emission\']}}</p></div><img ng-src="assets/images/Gas-96.png" class="md-avatar"><div class="md-list-item-text"><h3>CO2 Emission/Hour</h3><p>{{tracksummary[\'co2emissionperhour\']}} kg/h</p></div></md-list-item></div>')
}]);